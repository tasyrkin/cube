<!DOCTYPE html>  <html>  <head>      <title>app.coffee</title>      <meta http-equiv="content-type" content="text/html; charset=UTF-8">      <link rel="stylesheet" media="all" href="zocco.css" />  </head>  <body>      <div id="container">          <div id="background"></div>                        <div id="jumpWrapper">                  <div id="jumpPage">                      <label>Files...</label>                                                                  <a class="source" href="app.html">                          app.coffee                      </a>                                                                  <a class="source" href="collection.html">                          collection.coffee                      </a>                                                                  <a class="source" href="facets.html">                          facets.coffee                      </a>                                                                  <a class="source" href="index.html">                          index.coffee                      </a>                                                                  <a class="source" href="facetArray.html">                          facetArray.coffee                      </a>                                                                  <a class="source" href="schema.html">                          schema.coffee                      </a>                                                                  <a class="source" href="facet.html">                          facet.coffee                      </a>                                                                  <a class="source" href="item.html">                          item.coffee                      </a>                                                                  <a class="source" href="print.html">                          print.coffee                      </a>                                                                  <a class="source" href="routes.html">                          routes.coffee                      </a>                                                                  <a class="source" href="facet.html">                          facet.coffee                      </a>                                                                  <a class="source" href="item.html">                          item.coffee                      </a>                                                                  <a class="source" href="profile.html">                          profile.coffee                      </a>                                                                  <a class="source" href="cube.html">                          cube.coffee                      </a>                                                                  <a class="source" href="code.html">                          code.coffee                      </a>                                                                  <a class="source" href="code.html">                          code.coffee                      </a>                                                                  <a class="source" href="code.html">                          code.coffee                      </a>                                                                  <a class="source" href="code.html">                          code.coffee                      </a>                                                                  <a class="source" href="code.html">                          code.coffee                      </a>                                                                  <a class="source" href="server.config.html">                          server.config.coffee                      </a>                                                                  <a class="source" href="server.routes.html">                          server.routes.coffee                      </a>                                                                  <a class="source" href="server.settings.html">                          server.settings.coffee                      </a>                                                                  <a class="source" href="entityController.html">                          entityController.coffee                      </a>                                                                  <a class="source" href="extensionController.html">                          extensionController.coffee                      </a>                                                                  <a class="source" href="facetManager.html">                          facetManager.coffee                      </a>                                                                  <a class="source" href="itemController.html">                          itemController.coffee                      </a>                                                                  <a class="source" href="printController.html">                          printController.coffee                      </a>                                                                  <a class="source" href="schema.html">                          schema.coffee                      </a>                                                                  <a class="source" href="solrManager.html">                          solrManager.coffee                      </a>                                                                  <a class="source" href="genSchema.html">                          genSchema.coffee                      </a>                                                                  <a class="source" href="importer-fortunes.html">                          importer-fortunes.coffee                      </a>                                                                  <a class="source" href="importer-hosts.html">                          importer-hosts.coffee                      </a>                                                                  <a class="source" href="importer-projects.html">                          importer-projects.coffee                      </a>                                        </div>              </div>                    <table cellpadding="0" cellspacing="0">              <thead>                  <tr>                      <th class="docs">                          <h1>                              app.coffee                          </h1>                      </th>                      <th class="code">                      </th>                  </tr>              </thead>              <tbody>                                                      <tr id="section-1">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-1">&#182;</a>                          </div>                          <h3 id="thecube">The Cube</h3>

<p>Zalando's management tool (devcode: Team App)</p>

<p>Please visit our github page to know more about this app!</p>

<p>http://zalando.github.com/cube/</p>

<p>or better, give it a look to the annotated source code at docs/</p>

<p>@date:  Nov/2012</p>

<p>@autor: Emanuel Lauria <a href="&#109;&#x61;&#x69;&#108;&#116;&#x6F;:&#101;&#x6D;&#x61;&#x6E;ue&#x6C;&#x2E;&#x6C;&#x61;&#x75;&#x72;&#105;&#x61;&#64;&#122;&#x61;&#x6C;&#x61;n&#100;&#x6F;&#46;&#x64;&#x65;">&#101;&#x6D;&#x61;&#x6E;ue&#x6C;&#x2E;&#x6C;&#x61;&#x75;&#x72;&#105;&#x61;&#64;&#122;&#x61;&#x6C;&#x61;n&#100;&#x6F;&#46;&#x64;&#x65;</a></p>                      </td>                      <td class="code">                          <div class="highlight"><pre><span class="nx">$</span> <span class="o">=&gt;</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-2">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-2">&#182;</a>                          </div>                          <p>Backbone collection to hold all items from our team.</p>                      </td>                      <td class="code">                          <div class="highlight"><pre>    <span class="vi">@collection = </span><span class="k">new</span> <span class="nx">@Collection</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-3">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-3">&#182;</a>                          </div>                          <p>Facets collection, holding all facet fields.</p>                      </td>                      <td class="code">                          <div class="highlight"><pre>    <span class="vi">@facets = </span><span class="k">new</span> <span class="nx">@Facets</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-4">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-4">&#182;</a>                          </div>                          <p>Extensions</p>                      </td>                      <td class="code">                          <div class="highlight"><pre>    <span class="vi">@extensions = </span><span class="k">if</span> <span class="nx">@Extensions</span> <span class="k">then</span> <span class="k">new</span> <span class="nx">@Extensions</span> <span class="k">else</span> <span class="kc">null</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-5">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-5">&#182;</a>                          </div>                          <h3 id="mainview">Main View</h3>

<p>Holds a new user profile view, handles search and filtering
on the items collection and updates between views and collections.</p>                      </td>                      <td class="code">                          <div class="highlight"><pre>    <span class="k">class</span> <span class="nx">AppView</span> <span class="k">extends</span> <span class="nx">Backbone</span><span class="p">.</span><span class="nx">View</span>

        <span class="nv">el: </span><span class="nx">$</span><span class="p">(</span><span class="s">&#39;#app&#39;</span><span class="p">)</span>

        <span class="nv">events:</span>
            <span class="s">&quot;keyup </span><span class="err">#</span><span class="s">inputSearch&quot;</span>            <span class="o">:</span> <span class="s">&quot;onSearchInput&quot;</span>
            <span class="s">&quot;click a</span><span class="err">#</span><span class="s">add.btn&quot;</span>               <span class="o">:</span> <span class="s">&quot;addNewItem&quot;</span>
            <span class="s">&quot;click ul</span><span class="err">#</span><span class="s">facet ul li .field&quot;</span>   <span class="o">:</span> <span class="s">&quot;handleFacetClick&quot;</span>
            <span class="s">&quot;click span</span><span class="err">#</span><span class="s">reset a&quot;</span>            <span class="o">:</span> <span class="s">&quot;resetAllFilters&quot;</span>
            <span class="s">&quot;click span</span><span class="err">#</span><span class="s">view&quot;</span>               <span class="o">:</span> <span class="s">&quot;toggleViewMode&quot;</span>
            <span class="s">&quot;click ul</span><span class="err">#</span><span class="s">facet li ul span.fold&quot;</span><span class="o">:</span> <span class="s">&quot;toggleFacetSubfields&quot;</span>
            <span class="s">&quot;click ul</span><span class="err">#</span><span class="s">facet&gt;li&gt;span.fold&quot;</span>   <span class="o">:</span> <span class="s">&quot;toggleFacetNode&quot;</span>
            <span class="s">&quot;click ul</span><span class="err">#</span><span class="s">facet&gt;li&gt;h4&quot;</span>          <span class="o">:</span> <span class="s">&quot;toggleFacetNode&quot;</span>
            <span class="s">&quot;click span</span><span class="err">#</span><span class="s">print&quot;</span>              <span class="o">:</span> <span class="s">&quot;print&quot;</span>
            <span class="s">&quot;click span</span><span class="err">#</span><span class="s">json&quot;</span>               <span class="o">:</span> <span class="s">&quot;toJson&quot;</span>
            <span class="s">&quot;click </span><span class="err">#</span><span class="s">entityTitle&quot;</span>            <span class="o">:</span> <span class="s">&quot;toggleEntitiesMenu&quot;</span>
            <span class="s">&quot;click </span><span class="err">#</span><span class="s">columnsMenu&quot;</span>            <span class="o">:</span> <span class="s">&quot;toggleColumnsMenu&quot;</span>
            <span class="s">&quot;click </span><span class="err">#</span><span class="s">columnOptions ul li&quot;</span>    <span class="o">:</span> <span class="s">&quot;toggleColumnVisibility&quot;</span>
            <span class="s">&quot;click </span><span class="err">#</span><span class="s">entities ul li&quot;</span>         <span class="o">:</span> <span class="s">&quot;redirectToEntity&quot;</span>
            <span class="s">&quot;click span</span><span class="err">#</span><span class="s">pageL&quot;</span>              <span class="o">:</span> <span class="s">&quot;previousPage&quot;</span>
            <span class="s">&quot;click span</span><span class="err">#</span><span class="s">pageR&quot;</span>              <span class="o">:</span> <span class="s">&quot;nextPage&quot;</span>
            <span class="s">&quot;click span</span><span class="err">#</span><span class="s">jumpToFirst&quot;</span>        <span class="o">:</span> <span class="s">&quot;jumpToFirst&quot;</span>
            <span class="s">&quot;click span</span><span class="err">#</span><span class="s">jumpToLast&quot;</span>         <span class="o">:</span> <span class="s">&quot;jumpToLast&quot;</span>
            <span class="s">&quot;click </span><span class="err">#</span><span class="s">footer li&quot;</span>              <span class="o">:</span> <span class="s">&quot;jumpToPage&quot;</span>
            <span class="s">&quot;click table .th-inner&quot;</span>         <span class="o">:</span> <span class="s">&quot;sortTable&quot;</span>
            <span class="s">&quot;mouseenter </span><span class="err">#</span><span class="s">columnsMenu&quot;</span>       <span class="o">:</span> <span class="s">&quot;overColumnsMenu&quot;</span>
            <span class="s">&quot;mouseenter .th-inner&quot;</span>          <span class="o">:</span> <span class="s">&quot;showColumnsBtn&quot;</span>
            <span class="s">&quot;mouseleave .th-inner&quot;</span>          <span class="o">:</span> <span class="s">&quot;hideColumnsBtn&quot;</span>
            <span class="s">&quot;click&quot;</span>                         <span class="o">:</span> <span class="s">&quot;documentClick&quot;</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-6">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-6">&#182;</a>                          </div>                          <h3 id="initializeapp">Initialize App</h3>                      </td>                      <td class="code">                          <div class="highlight"><pre>        <span class="nv">initialize: </span><span class="p">()</span> <span class="o">=&gt;</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-7">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-7">&#182;</a>                          </div>                          <p>Create router object</p>                      </td>                      <td class="code">                          <div class="highlight"><pre>            <span class="vi">@router = </span><span class="k">new</span> <span class="nb">window</span><span class="p">.</span><span class="nx">Routes</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-8">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-8">&#182;</a>                          </div>                          <p>Set application settings from settings.json</p>                      </td>                      <td class="code">                          <div class="highlight"><pre>            <span class="nx">@setAppSettings</span><span class="p">()</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-9">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-9">&#182;</a>                          </div>                          <p>Set collection settings like sort criteria or amount of rows</p>                      </td>                      <td class="code">                          <div class="highlight"><pre>            <span class="nx">@setColSettings</span><span class="p">()</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-10">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-10">&#182;</a>                          </div>                          <p>Set the schema ffor the entity</p>                      </td>                      <td class="code">                          <div class="highlight"><pre>            <span class="nx">@createSchema</span><span class="p">()</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-11">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-11">&#182;</a>                          </div>                          <p>Get extension code from server and start app on success.</p>                      </td>                      <td class="code">                          <div class="highlight"><pre>            <span class="nx">@getExtensions</span> <span class="p">()</span> <span class="o">=&gt;</span>

                <span class="nx">@start</span><span class="p">()</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-12">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-12">&#182;</a>                          </div>                          <h3 id="collectionsbindings">Collections bindings</h3>                      </td>                      <td class="code">                          <div class="highlight"><pre></pre></div>                      </td>                  </tr>                                                      <tr id="section-13">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-13">&#182;</a>                          </div>                          <p>Display any new items in the container.</p>                      </td>                      <td class="code">                          <div class="highlight"><pre>            <span class="nb">window</span><span class="p">.</span><span class="nx">collection</span><span class="p">.</span><span class="nx">bind</span>  <span class="s">&#39;add&#39;</span><span class="p">,</span>      <span class="nx">@addOne</span><span class="p">,</span>        <span class="nx">@</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-14">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-14">&#182;</a>                          </div>                          <p>Updte facets whenever an item is added to the collection</p>                      </td>                      <td class="code">                          <div class="highlight"><pre>            <span class="nb">window</span><span class="p">.</span><span class="nx">collection</span><span class="p">.</span><span class="nx">bind</span>  <span class="s">&#39;add&#39;</span><span class="p">,</span>      <span class="nx">@updateFacets</span><span class="p">,</span>  <span class="nx">@</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-15">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-15">&#182;</a>                          </div>                          <p>Redraw items whenever the collection is resetted.</p>                      </td>                      <td class="code">                          <div class="highlight"><pre>            <span class="nb">window</span><span class="p">.</span><span class="nx">collection</span><span class="p">.</span><span class="nx">bind</span>  <span class="s">&#39;reset&#39;</span><span class="p">,</span>    <span class="nx">@reset</span><span class="p">,</span>         <span class="nx">@</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-16">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-16">&#182;</a>                          </div>                          <p>Draw all facets whenever the collection is resetted.</p>                      </td>                      <td class="code">                          <div class="highlight"><pre>            <span class="nb">window</span><span class="p">.</span><span class="nx">facets</span><span class="p">.</span><span class="nx">bind</span>      <span class="s">&#39;reset&#39;</span><span class="p">,</span>    <span class="nx">@addAllFacets</span><span class="p">,</span>  <span class="nx">@</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-17">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-17">&#182;</a>                          </div>                          <p>Start application</p>                      </td>                      <td class="code">                          <div class="highlight"><pre>        <span class="nv">start: </span><span class="o">=&gt;</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-18">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-18">&#182;</a>                          </div>                          <p>Set the application's title (extension name on top left)</p>                      </td>                      <td class="code">                          <div class="highlight"><pre>            <span class="nx">@setAppTitle</span><span class="p">()</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-19">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-19">&#182;</a>                          </div>                          <p>Set view icon's state to show current view mode (top right).
If no pictures on the schema, thumbnail view mode is disabled</p>                      </td>                      <td class="code">                          <div class="highlight"><pre>            <span class="nx">@setViewMode</span><span class="p">()</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-20">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-20">&#182;</a>                          </div>                          <p>Hide the index pane or resize it to appropriate size</p>                      </td>                      <td class="code">                          <div class="highlight"><pre>            <span class="nx">@setAppFacetsState</span><span class="p">()</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-21">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-21">&#182;</a>                          </div>                          <p>Set Schema indexes from localStorage</p>                      </td>                      <td class="code">                          <div class="highlight"><pre>            <span class="nx">@setColumnSelection</span><span class="p">()</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-22">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-22">&#182;</a>                          </div>                          <p>Create the columns menu</p>                      </td>                      <td class="code">                          <div class="highlight"><pre>            <span class="nx">@generateColumnsMenu</span><span class="p">()</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-23">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-23">&#182;</a>                          </div>                          <p>Create the entities menu</p>                      </td>                      <td class="code">                          <div class="highlight"><pre>            <span class="nx">@generateEntitiesMenu</span><span class="p">()</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-24">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-24">&#182;</a>                          </div>                          <p>Start loading animation timer (1second timeout)</p>                      </td>                      <td class="code">                          <div class="highlight"><pre>            <span class="nx">@showLoadingAnimation</span><span class="p">()</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-25">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-25">&#182;</a>                          </div>                          <p>Fetch facets and start backbone history right after. This will
route to window.Settings.Separator which in turn will fetch
items and draw app.</p>                      </td>                      <td class="code">                          <div class="highlight"><pre>            <span class="nx">@initFacets</span><span class="p">()</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-26">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-26">&#182;</a>                          </div>                          <p>Start app with search input text focused</p>                      </td>                      <td class="code">                          <div class="highlight"><pre>            <span class="nx">$</span><span class="p">(</span><span class="s">&#39;#inputSearch&#39;</span><span class="p">).</span><span class="nx">focus</span><span class="p">()</span> <span class="nx">unless</span> <span class="nx">@isTablet</span><span class="p">()</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-27">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-27">&#182;</a>                          </div>                          <p>Hide Add item button unless admin key is present</p>                      </td>                      <td class="code">                          <div class="highlight"><pre>            <span class="nx">@setAdminState</span><span class="p">()</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-28">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-28">&#182;</a>                          </div>                          <p>Profile additional info open/close state. Default is closed.</p>                      </td>                      <td class="code">                          <div class="highlight"><pre>            <span class="nx">@setProfileState</span><span class="p">()</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-29">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-29">&#182;</a>                          </div>                          <p>Listen for arrow keys to move between items</p>                      </td>                      <td class="code">                          <div class="highlight"><pre>            <span class="nx">@setMoveKeybindings</span><span class="p">()</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-30">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-30">&#182;</a>                          </div>                          <p>Initialize facets collection by fetching them. Start history right
after and save the initial open state (expand/fold).</p>                      </td>                      <td class="code">                          <div class="highlight"><pre>        <span class="nv">initFacets: </span><span class="p">()</span> <span class="o">=&gt;</span>
            <span class="nb">window</span><span class="p">.</span><span class="nx">facets</span><span class="p">.</span><span class="nx">fetch</span> <span class="nv">success: </span><span class="p">()</span> <span class="o">=&gt;</span>
                <span class="nx">@hideError</span><span class="p">()</span>
                <span class="nx">Backbone</span><span class="p">.</span><span class="nx">history</span><span class="p">.</span><span class="nx">start</span><span class="p">()</span>
                <span class="nx">@setFacetOpenState</span><span class="p">()</span>
            <span class="p">,</span> <span class="nv">error: </span><span class="p">()</span> <span class="o">=&gt;</span>
                <span class="nx">@showError</span><span class="p">()</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-31">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-31">&#182;</a>                          </div>                          <p>Set the extension settings and other properties like etiquettes and
a list of entities to the window object.</p>                      </td>                      <td class="code">                          <div class="highlight"><pre>        <span class="nv">setAppSettings: </span><span class="nf">() -&gt;</span>
            <span class="nv">settings = </span><span class="nb">window</span><span class="p">.</span><span class="nx">settings</span>
            <span class="nv">settings.etiquettes = </span><span class="nb">window</span><span class="p">.</span><span class="nx">etiquettes</span>
            <span class="nv">settings.entities = </span><span class="nb">window</span><span class="p">.</span><span class="nx">entities</span>
            <span class="nb">window</span><span class="p">.</span><span class="nv">Settings = </span><span class="nx">settings</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-32">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-32">&#182;</a>                          </div>                          <p>Set collection settings like sort and rows.</p>                      </td>                      <td class="code">                          <div class="highlight"><pre>        <span class="nv">setColSettings: </span><span class="nf">() -&gt;</span>
            <span class="nb">window</span><span class="p">.</span><span class="nv">collection.sort = </span><span class="nx">@getSort</span><span class="p">()</span>
            <span class="nb">window</span><span class="p">.</span><span class="nv">collection.rows = </span><span class="nb">window</span><span class="p">.</span><span class="nx">Settings</span><span class="p">.</span><span class="nx">rows</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-33">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-33">&#182;</a>                          </div>                          <p>Set the application's title on top left corner (top entities menu)</p>                      </td>                      <td class="code">                          <div class="highlight"><pre>        <span class="nv">setAppTitle: </span><span class="p">()</span> <span class="o">=&gt;</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-34">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-34">&#182;</a>                          </div>                          <p>Apply application name to title label and window title</p>                      </td>                      <td class="code">                          <div class="highlight"><pre>            <span class="nx">$</span><span class="p">(</span><span class="s">&#39;#header #entityTitle h1&#39;</span><span class="p">).</span><span class="nx">html</span> <span class="nb">window</span><span class="p">.</span><span class="nx">Settings</span><span class="o">?</span><span class="p">.</span><span class="nx">title</span>
            <span class="k">if</span> <span class="nb">window</span><span class="p">.</span><span class="nx">Settings</span><span class="p">.</span><span class="nx">entities</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="mi">1</span>
                <span class="nx">$</span><span class="p">(</span><span class="s">&#39;#header #entityTitle&#39;</span><span class="p">).</span><span class="nx">addClass</span> <span class="s">&#39;selectable&#39;</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-35">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-35">&#182;</a>                          </div>                          <p>Set the view mode to either list or thumbnail</p>                      </td>                      <td class="code">                          <div class="highlight"><pre>        <span class="nv">setViewMode: </span><span class="p">()</span> <span class="o">=&gt;</span>
            <span class="k">if</span> <span class="nb">window</span><span class="p">.</span><span class="nx">Settings</span><span class="o">?</span><span class="p">.</span><span class="nx">Schema</span><span class="p">.</span><span class="nx">getPictures</span><span class="p">().</span><span class="nx">length</span> <span class="o">is</span> <span class="mi">0</span>
                <span class="nx">$</span><span class="p">(</span><span class="s">&#39;span#view&#39;</span><span class="p">).</span><span class="nx">hide</span><span class="p">()</span>
            <span class="nx">$</span><span class="p">(</span><span class="s">&#39;span#view&#39;</span><span class="p">).</span><span class="nx">addClass</span> <span class="s">&#39;list&#39;</span> <span class="k">if</span> <span class="nb">window</span><span class="p">.</span><span class="nx">Settings</span><span class="o">?</span><span class="p">.</span><span class="nx">view</span> <span class="o">is</span> <span class="s">&#39;list&#39;</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-36">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-36">&#182;</a>                          </div>                          <p>Set the facet state: hide if no facets or resize to appropriate value
if facets are present. Facet size is stored in localStorage.</p>                      </td>                      <td class="code">                          <div class="highlight"><pre>        <span class="nv">setAppFacetsState: </span><span class="p">()</span> <span class="o">=&gt;</span>
            <span class="nv">facets = </span><span class="nb">window</span><span class="p">.</span><span class="nx">Settings</span><span class="p">.</span><span class="nx">Schema</span><span class="p">.</span><span class="nx">getFacets</span><span class="p">()</span>
            <span class="k">return</span> <span class="nx">@disableFacets</span><span class="p">()</span> <span class="nx">unless</span> <span class="nx">facets</span><span class="p">.</span><span class="nx">length</span>
            <span class="nx">@setIndexResizable</span><span class="p">()</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-37">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-37">&#182;</a>                          </div>                          <p>Set the application administrator state if the admin key is present.</p>                      </td>                      <td class="code">                          <div class="highlight"><pre>        <span class="nv">setAdminState: </span><span class="p">()</span> <span class="o">=&gt;</span>
            <span class="k">if</span> <span class="nx">@isEditable</span><span class="p">()</span> <span class="o">and</span> <span class="nx">@isAdmin</span><span class="p">()</span>
                <span class="nx">$</span><span class="p">(</span><span class="s">&#39;a#add.btn&#39;</span><span class="p">).</span><span class="nx">css</span> <span class="s">&#39;display&#39;</span><span class="p">,</span> <span class="s">&#39;block&#39;</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-38">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-38">&#182;</a>                          </div>                          <p>Set the profile state, basically just keeps track of the state of
the additional info section (open/closed).</p>                      </td>                      <td class="code">                          <div class="highlight"><pre>        <span class="nv">setProfileState: </span><span class="p">()</span> <span class="o">=&gt;</span>
            <span class="nb">window</span><span class="p">.</span><span class="nv">additionalOpen = </span><span class="kc">no</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-39">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-39">&#182;</a>                          </div>                          <p>Append html on #controls (icons top right corner) and initialize
the extended javascript code.
TODO Avoid this async call</p>                      </td>                      <td class="code">                          <div class="highlight"><pre>        <span class="nv">getExtensions: </span><span class="p">(</span><span class="nx">cb</span><span class="p">)</span> <span class="o">=&gt;</span>
            <span class="nx">$</span><span class="p">.</span><span class="nx">get</span> <span class="s">&#39;extensions&#39;</span><span class="p">,</span> <span class="nf">(exthtml) -&gt;</span>
                <span class="nx">$</span><span class="p">(</span><span class="s">&#39;#app &gt; #extensions&#39;</span><span class="p">).</span><span class="nx">html</span> <span class="nx">exthtml</span>
                <span class="k">return</span> <span class="nx">cb</span><span class="p">()</span> <span class="nx">unless</span> <span class="nx">$</span><span class="p">(</span><span class="s">&quot;</span><span class="err">#</span><span class="s">app &gt; </span><span class="err">#</span><span class="s">extensions </span><span class="err">#</span><span class="s">controls&quot;</span><span class="p">).</span><span class="nx">length</span>
                <span class="nv">t = </span><span class="nx">_</span><span class="p">.</span><span class="nx">template</span> <span class="nx">$</span><span class="p">(</span><span class="s">&quot;</span><span class="err">#</span><span class="s">app &gt; </span><span class="err">#</span><span class="s">extensions </span><span class="err">#</span><span class="s">controls&quot;</span><span class="p">).</span><span class="nx">html</span><span class="p">()</span>
                <span class="nx">$</span><span class="p">(</span><span class="s">&#39;#controls #extensions&#39;</span><span class="p">).</span><span class="nx">append</span> <span class="nx">t</span><span class="p">({})</span>
                <span class="nb">window</span><span class="p">.</span><span class="nx">extensions</span><span class="o">?</span><span class="p">.</span><span class="nx">init</span><span class="o">?</span><span class="p">()</span>
                <span class="nx">cb</span><span class="p">()</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-40">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-40">&#182;</a>                          </div>                          <p>Add extension code for a profile view</p>                      </td>                      <td class="code">                          <div class="highlight"><pre>        <span class="nv">addProfileExtensions: </span><span class="p">(</span><span class="nx">item</span><span class="p">)</span> <span class="o">=&gt;</span>
            <span class="k">return</span> <span class="nx">unless</span> <span class="nx">$</span><span class="p">(</span><span class="s">&#39;#app &gt; #extensions #details-template&#39;</span><span class="p">).</span><span class="nx">length</span>
            <span class="nv">template = </span><span class="nx">_</span><span class="p">.</span><span class="nx">template</span> <span class="nx">$</span><span class="p">(</span><span class="s">&#39;#app &gt; #extensions #details-template&#39;</span><span class="p">)</span>
                <span class="p">.</span><span class="nx">html</span><span class="p">()</span>
            <span class="nx">$</span><span class="p">(</span><span class="s">&#39;#pane #extensions&#39;</span><span class="p">).</span><span class="nx">append</span> <span class="nx">template</span> <span class="nx">t</span><span class="o">:</span><span class="nx">item</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-41">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-41">&#182;</a>                          </div>                          <p>Get schema and attach it to our Settings object</p>                      </td>                      <td class="code">                          <div class="highlight"><pre>        <span class="nv">createSchema: </span><span class="o">-&gt;</span>
            <span class="nb">window</span><span class="p">.</span><span class="nx">Settings</span><span class="o">?</span><span class="p">.</span><span class="nv">Schema = </span><span class="k">new</span> <span class="nb">window</span><span class="p">.</span><span class="nx">Schema</span> <span class="nb">window</span><span class="p">.</span><span class="nx">schema</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-42">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-42">&#182;</a>                          </div>                          <p>Keep an array of the selected facet fields
TODO Implement backbone collection</p>                      </td>                      <td class="code">                          <div class="highlight"><pre>        <span class="nv">filterSelection: </span><span class="k">new</span> <span class="nb">window</span><span class="p">.</span><span class="nx">FacetArray</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-43">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-43">&#182;</a>                          </div>                          <p>Keep an array of the facets expanded/folded state
TODO Implement backbone collection</p>                      </td>                      <td class="code">                          <div class="highlight"><pre>        <span class="nv">facetOpenState: </span><span class="k">new</span> <span class="nb">window</span><span class="p">.</span><span class="nx">FacetArray</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-44">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-44">&#182;</a>                          </div>                          <p>Array to store the selected item ids</p>                      </td>                      <td class="code">                          <div class="highlight"><pre>        <span class="nv">itemSelection: </span><span class="k">new</span> <span class="nb">window</span><span class="p">.</span><span class="nx">Collection</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-45">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-45">&#182;</a>                          </div>                          <p>Switches between list view mode and thumbnail view mode</p>                      </td>                      <td class="code">                          <div class="highlight"><pre>        <span class="nv">toggleViewMode: </span><span class="p">()</span> <span class="o">=&gt;</span>
            <span class="nv">v = </span><span class="k">if</span> <span class="nb">window</span><span class="p">.</span><span class="nx">Settings</span><span class="p">.</span><span class="nx">view</span> <span class="o">is</span> <span class="s">&#39;list&#39;</span> <span class="k">then</span> <span class="s">&#39;thumbnail&#39;</span> <span class="k">else</span> <span class="s">&#39;list&#39;</span>
            <span class="nb">window</span><span class="p">.</span><span class="nv">Settings.view = </span><span class="nx">v</span>

            <span class="nx">$</span><span class="p">(</span><span class="s">&#39;span#view&#39;</span><span class="p">).</span><span class="nx">removeClass</span> <span class="s">&#39;list&#39;</span>
            <span class="nx">$</span><span class="p">(</span><span class="s">&#39;span#view&#39;</span><span class="p">).</span><span class="nx">addClass</span> <span class="s">&#39;list&#39;</span> <span class="k">if</span> <span class="nx">v</span> <span class="o">is</span> <span class="s">&#39;list&#39;</span>

            <span class="nx">@filterByPage</span> <span class="p">()</span> <span class="o">=&gt;</span>
                <span class="nx">@scrollToSelection</span> <span class="nx">$</span><span class="p">(</span><span class="s">&#39;#items .active&#39;</span><span class="p">),</span> <span class="kc">yes</span>
                <span class="nx">@navigate</span><span class="p">()</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-46">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-46">&#182;</a>                          </div>                          <p>Redraw collection after a reset event</p>                      </td>                      <td class="code">                          <div class="highlight"><pre>        <span class="nv">reset: </span><span class="p">(</span><span class="nx">attr</span><span class="p">)</span> <span class="o">=&gt;</span>
            <span class="nv">letters = </span><span class="nx">$</span><span class="p">(</span><span class="s">&quot;</span><span class="err">#</span><span class="s">inputSearch&quot;</span><span class="p">).</span><span class="nx">val</span><span class="p">().</span><span class="nx">toLowerCase</span><span class="p">()</span>
            <span class="nx">$</span><span class="p">(</span><span class="s">&#39;#search span#reset&#39;</span><span class="p">).</span><span class="nx">show</span><span class="p">()</span>
            <span class="nx">$</span><span class="p">(</span><span class="s">&#39;#search span#reset&#39;</span><span class="p">).</span><span class="nx">hide</span><span class="p">()</span> <span class="nx">unless</span> <span class="nx">letters</span> <span class="o">or</span> <span class="nx">@filterSelection</span>
                <span class="p">.</span><span class="nx">get</span><span class="p">().</span><span class="nx">length</span>
            <span class="k">return</span> <span class="nx">@addAll</span> <span class="nb">window</span><span class="p">.</span><span class="nx">collection</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-47">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-47">&#182;</a>                          </div>                          <p>Add one item to the items container. Either in thumnail mode
(picture and name) or in list mode (pic, full name, teams, etc.)</p>                      </td>                      <td class="code">                          <div class="highlight"><pre>        <span class="nv">addOne: </span><span class="p">(</span><span class="nx">m</span><span class="p">)</span> <span class="o">=&gt;</span>
            <span class="k">if</span> <span class="nb">window</span><span class="p">.</span><span class="nx">Settings</span><span class="p">.</span><span class="nx">view</span> <span class="o">is</span> <span class="s">&#39;thumbnail&#39;</span>
                <span class="k">return</span> <span class="nb">window</span><span class="p">.</span><span class="nx">App</span><span class="p">.</span><span class="nx">addOneThumbnail</span><span class="p">(</span><span class="nx">m</span><span class="p">)</span>
            <span class="nb">window</span><span class="p">.</span><span class="nx">App</span><span class="p">.</span><span class="nx">addOneList</span> <span class="nx">m</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-48">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-48">&#182;</a>                          </div>                          <p>Add one item to the table of items (list view mode)</p>                      </td>                      <td class="code">                          <div class="highlight"><pre>        <span class="nv">addOneList: </span><span class="p">(</span><span class="nx">item</span><span class="p">)</span> <span class="o">=&gt;</span>
            <span class="nv">view = </span><span class="k">new</span> <span class="nx">ItemListView</span> <span class="nv">model: </span><span class="nx">item</span>
            <span class="nx">@$</span><span class="p">(</span><span class="s">&quot;table tbody&quot;</span><span class="p">,</span> <span class="s">&quot;</span><span class="err">#</span><span class="s">items&quot;</span><span class="p">).</span><span class="nx">append</span> <span class="nx">view</span><span class="p">.</span><span class="nx">render</span><span class="p">().</span><span class="nx">el</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-49">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-49">&#182;</a>                          </div>                          <p>Add one item with a thumbnail view</p>                      </td>                      <td class="code">                          <div class="highlight"><pre>        <span class="nv">addOneThumbnail: </span><span class="p">(</span><span class="nx">item</span><span class="p">)</span> <span class="o">=&gt;</span>
            <span class="nv">view = </span><span class="k">new</span> <span class="nx">ItemThumbnailView</span> <span class="nv">model: </span><span class="nx">item</span>
            <span class="nv">cat = </span><span class="nx">item</span><span class="p">.</span><span class="nx">get</span> <span class="nb">window</span><span class="p">.</span><span class="nx">Settings</span><span class="p">.</span><span class="nx">Schema</span><span class="p">.</span><span class="nx">getClassifier</span><span class="p">().</span><span class="nx">id</span>
            <span class="nv">cat = </span><span class="nx">cat</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="k">typeof</span> <span class="nx">cat</span> <span class="o">is</span> <span class="k">typeof</span> <span class="p">[]</span>
            <span class="nv">cat = </span><span class="s">&#39;null&#39;</span> <span class="k">if</span> <span class="nx">cat</span> <span class="o">is</span> <span class="kc">undefined</span>
            <span class="nv">cat = </span><span class="nb">window</span><span class="p">.</span><span class="nx">categories</span><span class="p">.</span><span class="nx">indexOf</span> <span class="nx">cat</span>
            <span class="k">return</span> <span class="nx">@$</span><span class="p">(</span><span class="s">&quot;li\#category-</span><span class="si">#{</span><span class="nx">cat</span><span class="si">}</span><span class="s"> ul&quot;</span><span class="p">,</span> <span class="s">&#39;#items&#39;</span><span class="p">)</span>
                <span class="p">.</span><span class="nx">append</span> <span class="nx">view</span><span class="p">.</span><span class="nx">render</span><span class="p">().</span><span class="nx">el</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-50">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-50">&#182;</a>                          </div>                          <p>Render all items in the given collection</p>                      </td>                      <td class="code">                          <div class="highlight"><pre>        <span class="nv">addAll: </span><span class="p">(</span><span class="nx">col</span><span class="p">,</span> <span class="nx">cb</span><span class="p">)</span> <span class="o">=&gt;</span>
            <span class="nv">columnsMenuIsOpen = </span><span class="nx">$</span><span class="p">(</span><span class="s">&#39;#columnsMenu&#39;</span><span class="p">).</span><span class="nx">hasClass</span> <span class="s">&#39;active&#39;</span>
            <span class="nv">view = </span><span class="nb">window</span><span class="p">.</span><span class="nx">Settings</span><span class="p">.</span><span class="nx">view</span>
            <span class="nv">render = </span><span class="nx">@renderTableView</span>
            <span class="nv">render = </span><span class="nx">@renderCategoryView</span> <span class="k">if</span> <span class="nx">view</span> <span class="o">is</span> <span class="s">&#39;thumbnail&#39;</span>
            <span class="nx">render</span> <span class="p">()</span> <span class="o">=&gt;</span>
                <span class="nx">col</span><span class="p">.</span><span class="nx">each</span> <span class="nx">@addOne</span>
                <span class="nx">@hideEmptyCategories</span><span class="p">()</span> <span class="k">if</span> <span class="nx">view</span> <span class="o">is</span> <span class="s">&#39;thumbnail&#39;</span>
                <span class="nx">@setTotals</span><span class="p">()</span>
                <span class="nx">@updateSelection</span><span class="p">()</span>
                <span class="nx">@scrollToSelection</span> <span class="nx">$</span><span class="p">(</span><span class="nx">$</span><span class="p">(</span><span class="s">&#39;#items .active&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]),</span> <span class="kc">yes</span>
                <span class="nx">$</span><span class="p">(</span><span class="s">&#39;#columnOptions&#39;</span><span class="p">).</span><span class="nx">show</span><span class="p">()</span> <span class="k">if</span> <span class="nx">columnsMenuIsOpen</span>
                <span class="nx">$</span><span class="p">(</span><span class="s">&#39;#columnsMenu&#39;</span><span class="p">).</span><span class="nx">addClass</span> <span class="s">&#39;active&#39;</span> <span class="k">if</span> <span class="nx">columnsMenuIsOpen</span>
                <span class="nx">cb</span><span class="p">()</span> <span class="k">if</span> <span class="nx">cb</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-51">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-51">&#182;</a>                          </div>                          <p>Create an empty profileView to add an item</p>                      </td>                      <td class="code">                          <div class="highlight"><pre>        <span class="nv">addNewItem: </span><span class="p">()</span> <span class="o">=&gt;</span>
            <span class="nx">@clearSelection</span><span class="p">()</span>
            <span class="nx">@showProfile</span> <span class="k">new</span> <span class="nb">window</span><span class="p">.</span><span class="nx">Item</span>
            <span class="nb">window</span><span class="p">.</span><span class="nx">profileView</span><span class="p">.</span><span class="nx">form</span><span class="p">()</span>
            <span class="nx">@navigate</span><span class="p">()</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-52">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-52">&#182;</a>                          </div>                          <p>Select one item with a normal click. Delete previous selection if
present and save selected item as the firstActiveItem</p>                      </td>                      <td class="code">                          <div class="highlight"><pre>        <span class="nv">selectOne: </span><span class="p">(</span><span class="nx">$e</span><span class="p">,</span> <span class="nx">attr</span><span class="p">)</span> <span class="o">=&gt;</span>
            <span class="nx">@clearSelection</span><span class="p">()</span>
            <span class="nx">@addToSelection</span> <span class="nx">$e</span>
            <span class="nx">@scrollToSelection</span> <span class="nx">$e</span>
            <span class="nx">@showProfile</span> <span class="nb">window</span><span class="p">.</span><span class="nx">collection</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">$e</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s">&#39;id&#39;</span><span class="p">)),</span> <span class="nx">attr</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-53">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-53">&#182;</a>                          </div>                          <p>Add a item to the selection array</p>                      </td>                      <td class="code">                          <div class="highlight"><pre>        <span class="nv">addToSelection: </span><span class="p">(</span><span class="nx">$e</span><span class="p">)</span> <span class="o">=&gt;</span>
            <span class="nv">id = </span><span class="nx">$e</span><span class="p">.</span><span class="nx">attr</span> <span class="s">&#39;id&#39;</span>
            <span class="nx">$e</span><span class="p">.</span><span class="nx">addClass</span> <span class="s">&#39;active&#39;</span>
            <span class="nb">window</span><span class="p">.</span><span class="nv">firstActiveItem = </span><span class="nx">id</span> <span class="k">if</span> <span class="nx">@itemSelection</span><span class="p">.</span><span class="nx">length</span> <span class="o">is</span> <span class="mi">0</span>
            <span class="nx">@itemSelection</span><span class="p">.</span><span class="nx">add</span> <span class="nb">window</span><span class="p">.</span><span class="nx">collection</span><span class="p">.</span><span class="nx">get</span> <span class="nx">id</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-54">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-54">&#182;</a>                          </div>                          <p>On list mode, when selection is too close to top or bottom border,
do a page up/down respectively.</p>                      </td>                      <td class="code">                          <div class="highlight"><pre>        <span class="nv">scrollToSelection: </span><span class="p">(</span><span class="nx">$e</span><span class="p">,</span> <span class="nx">center</span><span class="p">)</span> <span class="o">=&gt;</span>
            <span class="k">return</span> <span class="nx">unless</span> <span class="nx">$e</span><span class="p">.</span><span class="nx">length</span>
            <span class="nv">posY = </span><span class="nx">$e</span><span class="p">.</span><span class="nx">offset</span><span class="p">().</span><span class="nx">top</span> <span class="o">-</span> <span class="mi">90</span>
            <span class="nv">$container = </span><span class="nx">$</span><span class="p">(</span><span class="s">&#39;.fixed-table-container-inner, .thumbnailContainer&#39;</span><span class="p">)</span>
            <span class="nv">scrollTop = </span><span class="nx">$container</span><span class="p">.</span><span class="nx">scrollTop</span><span class="p">()</span>
            <span class="nv">height    = </span><span class="nx">$container</span><span class="p">.</span><span class="nx">height</span><span class="p">()</span>
            <span class="nv">eHeight   = </span><span class="k">if</span> <span class="nb">window</span><span class="p">.</span><span class="nx">Settings</span><span class="p">.</span><span class="nx">view</span> <span class="o">is</span> <span class="s">&#39;list&#39;</span> <span class="k">then</span> <span class="mi">39</span> <span class="k">else</span> <span class="mi">196</span>
            <span class="k">if</span> <span class="nx">posY</span> <span class="o">+</span> <span class="nx">eHeight</span> <span class="o">&gt;</span> <span class="nx">height</span>
                <span class="nv">top = </span><span class="nx">scrollTop</span> <span class="o">+</span> <span class="nx">eHeight</span> <span class="o">-</span> <span class="p">(</span><span class="nx">height</span> <span class="o">-</span> <span class="nx">posY</span><span class="p">)</span>
                <span class="nx">top</span> <span class="o">+=</span> <span class="nx">height</span><span class="o">/</span><span class="mi">2</span> <span class="k">if</span> <span class="nx">center</span>
                <span class="k">return</span> <span class="nx">$container</span><span class="p">.</span><span class="nx">scrollTop</span> <span class="nx">top</span>
            <span class="k">if</span> <span class="nx">posY</span> <span class="o">&lt;</span> <span class="mi">0</span>
                <span class="nv">top = </span><span class="nx">scrollTop</span> <span class="o">+</span> <span class="nx">posY</span> <span class="o">+</span> <span class="mi">1</span>
                <span class="k">return</span> <span class="nx">$container</span><span class="p">.</span><span class="nx">scrollTop</span> <span class="nx">top</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-55">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-55">&#182;</a>                          </div>                          <p>Add one facet field with a title name and a list of values</p>                      </td>                      <td class="code">                          <div class="highlight"><pre>        <span class="nv">addOneFacet: </span><span class="nf">(facet) -&gt;</span>
            <span class="nv">view = </span><span class="k">new</span> <span class="nx">FacetView</span> <span class="nv">model: </span><span class="nx">facet</span>
            <span class="nx">@$</span><span class="p">(</span><span class="s">&#39;ul#facet&#39;</span><span class="p">).</span><span class="nx">append</span> <span class="nx">view</span><span class="p">.</span><span class="nx">render</span><span class="p">().</span><span class="nx">el</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-56">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-56">&#182;</a>                          </div>                          <p>Add all facets from the facet collection</p>                      </td>                      <td class="code">                          <div class="highlight"><pre>        <span class="nv">addAllFacets: </span><span class="p">()</span> <span class="o">=&gt;</span>
            <span class="nx">$</span><span class="p">(</span><span class="s">&#39;ul#facet&#39;</span><span class="p">).</span><span class="nx">html</span> <span class="s">&#39;&#39;</span>
            <span class="nb">window</span><span class="p">.</span><span class="nx">facets</span><span class="p">.</span><span class="nx">each</span> <span class="nx">@addOneFacet</span>
            <span class="nx">@resizeIndex</span><span class="p">()</span>
            <span class="nx">@setFacetWidth</span><span class="p">()</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-57">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-57">&#182;</a>                          </div>                          <p>Propperly removes older item views, re-renders category
containers, fetches a new item collection with filters applied
and renders it.</p>                      </td>                      <td class="code">                          <div class="highlight"><pre>        <span class="nv">fetchItems: </span><span class="p">(</span><span class="nx">attr</span><span class="p">)</span> <span class="o">=&gt;</span>
            <span class="nx">@showLoadingAnimation</span><span class="p">()</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-58">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-58">&#182;</a>                          </div>                          <p>@removeItemViews()</p>                      </td>                      <td class="code">                          <div class="highlight"><pre>            <span class="nx">@unbindItemViews</span><span class="p">()</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-59">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-59">&#182;</a>                          </div>                          <p>$('#items').html ''</p>                      </td>                      <td class="code">                          <div class="highlight"><pre>            <span class="nb">window</span><span class="p">.</span><span class="nx">collection</span><span class="p">.</span><span class="nx">fetch</span> <span class="nx">attr</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-60">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-60">&#182;</a>                          </div>                          <p>Save states of the current facet field selections, fetches the
facets based on the selected fields and re-applies the selections</p>                      </td>                      <td class="code">                          <div class="highlight"><pre>        <span class="nv">fetchFacet: </span><span class="p">(</span><span class="nx">cb</span><span class="p">)</span> <span class="o">=&gt;</span>
            <span class="nx">@showLoadingAnimation</span><span class="p">()</span>
            <span class="nb">window</span><span class="p">.</span><span class="nx">facets</span><span class="p">.</span><span class="nx">fetch</span>
                <span class="nv">data: </span><span class="nx">@getFilterQS</span><span class="p">()</span>
                <span class="nv">success: </span><span class="p">()</span> <span class="o">=&gt;</span>
                    <span class="nx">@updateFacetState</span><span class="p">()</span>
                    <span class="nx">@hideError</span><span class="p">()</span>
                    <span class="nx">@setFacetState</span> <span class="nx">@filterSelection</span><span class="p">.</span><span class="nx">get</span><span class="p">()</span>
                    <span class="nx">cb</span><span class="p">()</span>
                <span class="nv">error: </span><span class="p">()</span> <span class="o">=&gt;</span>
                    <span class="nx">@showError</span><span class="p">()</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-61">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-61">&#182;</a>                          </div>                          <p>Fetch a collection by page number</p>                      </td>                      <td class="code">                          <div class="highlight"><pre>        <span class="nv">filterByPage: </span><span class="p">(</span><span class="nx">cb</span><span class="p">)</span> <span class="o">=&gt;</span>
            <span class="nx">@fetchFacet</span> <span class="p">()</span> <span class="o">=&gt;</span>
                <span class="nx">@fetchItems</span>
                    <span class="nv">data: </span><span class="nx">@getFilterQS</span><span class="p">()</span>
                    <span class="nv">success: </span><span class="p">(</span><span class="nx">col</span><span class="p">)</span> <span class="o">=&gt;</span>
                        <span class="nx">@trigger</span> <span class="s">&#39;filterByFacet&#39;</span>
                        <span class="nx">@genPageIndex</span><span class="p">()</span>
                        <span class="nx">@hideError</span><span class="p">()</span>
                        <span class="nx">@showPaneView</span><span class="p">()</span>
                        <span class="nx">@navigate</span><span class="p">()</span>
                        <span class="nx">cb</span><span class="p">(</span><span class="nx">col</span><span class="p">)</span> <span class="k">if</span> <span class="nx">cb</span>
                    <span class="nv">error: </span><span class="p">()</span> <span class="o">=&gt;</span>
                        <span class="nx">@showError</span><span class="p">()</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-62">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-62">&#182;</a>                          </div>                          <p>Fetch a collection by facet filter. Sets page back to 0.</p>                      </td>                      <td class="code">                          <div class="highlight"><pre>        <span class="nv">filterByFacet: </span><span class="p">(</span><span class="nx">cb</span><span class="p">)</span> <span class="o">=&gt;</span>
            <span class="nb">window</span><span class="p">.</span><span class="nv">collection.page = </span><span class="mi">0</span>
            <span class="nx">@filterByPage</span> <span class="nx">cb</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-63">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-63">&#182;</a>                          </div>                          <p>When a model or a collection changes, some facets will change too.
This function re-fetches the facet fields and redraws the facet view
then applies the selection to the facet and filters the items.</p>                      </td>                      <td class="code">                          <div class="highlight"><pre>        <span class="nv">updateFacets: </span><span class="p">(</span><span class="nx">m</span><span class="p">)</span> <span class="o">=&gt;</span>
            <span class="nx">@fetchFacet</span> <span class="p">()</span> <span class="o">=&gt;</span>
                <span class="nx">@fetchItems</span>
                    <span class="nv">data: </span><span class="nx">@getFilterQS</span><span class="p">()</span>
                    <span class="nv">success: </span><span class="p">(</span><span class="nx">col</span><span class="p">)</span> <span class="o">=&gt;</span>
                        <span class="nx">@genPageIndex</span><span class="p">()</span>
                        <span class="nx">@hideError</span><span class="p">()</span>
                        <span class="nx">@showPaneView</span><span class="p">()</span>
                        <span class="k">return</span> <span class="k">if</span> <span class="nx">col</span><span class="p">.</span><span class="nx">length</span>
                        <span class="nx">$</span><span class="p">(</span><span class="s">&#39;#inputSearch&#39;</span><span class="p">).</span><span class="nx">val</span> <span class="s">&#39;&#39;</span>
                        <span class="nx">@resetAllFilters</span><span class="p">()</span>
                    <span class="nv">error: </span><span class="p">()</span> <span class="o">=&gt;</span>
                        <span class="nx">@showError</span><span class="p">()</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-64">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-64">&#182;</a>                          </div>                          <p>Reset the facet state and update items after. It is important to
update the item collection to make sure it matches the empty
selection of the facet.</p>                      </td>                      <td class="code">                          <div class="highlight"><pre>        <span class="nv">resetAllFilters: </span><span class="p">()</span> <span class="o">=&gt;</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-65">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-65">&#182;</a>                          </div>                          <p>Trigger a 'resetFilters' event that can be catched by extension
code in order to reset its state too.</p>                      </td>                      <td class="code">                          <div class="highlight"><pre>            <span class="nx">@trigger</span> <span class="s">&#39;resetFilters&#39;</span>
            <span class="nx">@setFacetState</span> <span class="p">[]</span>
            <span class="nx">$</span><span class="p">(</span><span class="s">&#39;#inputSearch&#39;</span><span class="p">).</span><span class="nx">val</span> <span class="s">&#39;&#39;</span>
            <span class="nb">window</span><span class="p">.</span><span class="nv">collection.search = </span><span class="s">&#39;&#39;</span>
            <span class="nx">@fetchFacet</span> <span class="p">()</span> <span class="o">=&gt;</span>
                <span class="nx">@fetchItems</span>
                    <span class="nv">data: </span><span class="nx">@getFilterQS</span><span class="p">()</span>
                    <span class="nv">success: </span><span class="p">()</span> <span class="o">=&gt;</span>
                        <span class="nx">@genPageIndex</span><span class="p">()</span>
                        <span class="nx">@hideError</span><span class="p">()</span>
                        <span class="nx">@navigate</span><span class="p">()</span>
                    <span class="nv">error: </span><span class="p">()</span> <span class="o">=&gt;</span>
                        <span class="nx">@showError</span><span class="p">()</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-66">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-66">&#182;</a>                          </div>                          <p>Reset only the facet fields and not any other filter</p>                      </td>                      <td class="code">                          <div class="highlight"><pre>        <span class="nv">resetFacets: </span><span class="p">(</span><span class="nx">cb</span><span class="p">)</span> <span class="o">=&gt;</span>
            <span class="nx">@trigger</span> <span class="s">&#39;resetFacets&#39;</span>
            <span class="nx">@setFacetState</span> <span class="p">[]</span>
            <span class="nx">@fetchFacet</span> <span class="p">()</span> <span class="o">=&gt;</span>
                <span class="nx">@fetchItems</span>
                    <span class="nv">data: </span><span class="nx">@getFilterQS</span><span class="p">()</span>
                    <span class="nv">success: </span><span class="p">()</span> <span class="o">=&gt;</span>
                        <span class="nx">@genPageIndex</span><span class="p">()</span>
                        <span class="nx">@hideError</span><span class="p">()</span>
                        <span class="nx">cb</span><span class="p">()</span> <span class="k">if</span> <span class="nx">cb</span>
                    <span class="nv">error: </span><span class="p">()</span> <span class="o">=&gt;</span>
                        <span class="nx">@showError</span><span class="p">()</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-67">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-67">&#182;</a>                          </div>                          <p>Jump to previous page</p>                      </td>                      <td class="code">                          <div class="highlight"><pre>        <span class="nv">previousPage: </span><span class="p">()</span> <span class="o">=&gt;</span>
            <span class="k">return</span> <span class="k">if</span> <span class="nb">window</span><span class="p">.</span><span class="nx">collection</span><span class="p">.</span><span class="nx">page</span> <span class="o">&lt;=</span> <span class="mi">0</span>
            <span class="nb">window</span><span class="p">.</span><span class="nx">collection</span><span class="p">.</span><span class="nx">page</span><span class="o">--</span>
            <span class="nx">@filterByPage</span> <span class="p">()</span> <span class="o">=&gt;</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-68">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-68">&#182;</a>                          </div>                          <p>Jump to next page</p>                      </td>                      <td class="code">                          <div class="highlight"><pre>        <span class="nv">nextPage: </span><span class="p">()</span> <span class="o">=&gt;</span>
            <span class="nv">total = </span><span class="nb">window</span><span class="p">.</span><span class="nx">collection</span><span class="p">.</span><span class="nx">total</span>
            <span class="nv">rows = </span><span class="nb">window</span><span class="p">.</span><span class="nx">collection</span><span class="p">.</span><span class="nx">rows</span>
            <span class="nv">lastPage = </span><span class="nb">Math</span><span class="p">.</span><span class="nx">ceil</span><span class="p">(</span><span class="nx">total</span><span class="o">/</span><span class="nx">rows</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
            <span class="k">return</span> <span class="k">if</span> <span class="nb">window</span><span class="p">.</span><span class="nx">collection</span><span class="p">.</span><span class="nx">page</span> <span class="o">&gt;=</span> <span class="nx">lastPage</span>
            <span class="nb">window</span><span class="p">.</span><span class="nx">collection</span><span class="p">.</span><span class="nx">page</span><span class="o">++</span>
            <span class="nx">@filterByPage</span> <span class="p">()</span> <span class="o">=&gt;</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-69">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-69">&#182;</a>                          </div>                          <p>Jump to a specific page</p>                      </td>                      <td class="code">                          <div class="highlight"><pre>        <span class="nv">jumpToPage: </span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="o">=&gt;</span>
            <span class="nv">$e = </span><span class="nx">$</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">currentTarget</span><span class="p">)</span>
            <span class="nb">window</span><span class="p">.</span><span class="nv">collection.page = </span><span class="nx">$e</span><span class="p">.</span><span class="nx">attr</span> <span class="s">&#39;id&#39;</span>
            <span class="nx">@filterByPage</span> <span class="p">()</span> <span class="o">=&gt;</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-70">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-70">&#182;</a>                          </div>                          <p>Jump to first page</p>                      </td>                      <td class="code">                          <div class="highlight"><pre>        <span class="nv">jumpToFirst: </span><span class="p">()</span> <span class="o">=&gt;</span>
            <span class="nb">window</span><span class="p">.</span><span class="nv">collection.page = </span><span class="mi">0</span>
            <span class="nx">@filterByPage</span> <span class="p">()</span> <span class="o">=&gt;</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-71">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-71">&#182;</a>                          </div>                          <p>Jump to last page</p>                      </td>                      <td class="code">                          <div class="highlight"><pre>        <span class="nv">jumpToLast: </span><span class="p">()</span> <span class="o">=&gt;</span>
            <span class="nv">total = </span><span class="nb">window</span><span class="p">.</span><span class="nx">collection</span><span class="p">.</span><span class="nx">total</span>
            <span class="nv">rows = </span><span class="nb">window</span><span class="p">.</span><span class="nx">collection</span><span class="p">.</span><span class="nx">rows</span>
            <span class="nv">lastPage = </span><span class="nb">Math</span><span class="p">.</span><span class="nx">ceil</span><span class="p">(</span><span class="nx">total</span><span class="o">/</span><span class="nx">rows</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
            <span class="nb">window</span><span class="p">.</span><span class="nv">collection.page = </span><span class="nx">lastPage</span>
            <span class="nx">@filterByPage</span> <span class="p">()</span> <span class="o">=&gt;</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-72">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-72">&#182;</a>                          </div>                          <p>Generate the page index on the bottom</p>                      </td>                      <td class="code">                          <div class="highlight"><pre>        <span class="nv">genPageIndex: </span><span class="p">()</span> <span class="o">=&gt;</span>
            <span class="nv">template = </span><span class="nx">_</span><span class="p">.</span><span class="nx">template</span> <span class="nx">$</span><span class="p">(</span><span class="s">&#39;#pagination-index-template&#39;</span><span class="p">).</span><span class="nx">html</span><span class="p">()</span>
            <span class="nv">total = </span><span class="nb">parseFloat</span> <span class="nb">window</span><span class="p">.</span><span class="nx">collection</span><span class="p">.</span><span class="nx">total</span>
            <span class="nv">rows = </span><span class="nb">parseFloat</span> <span class="nb">window</span><span class="p">.</span><span class="nx">collection</span><span class="p">.</span><span class="nx">rows</span>
            <span class="nv">page = </span><span class="nb">parseFloat</span> <span class="nb">window</span><span class="p">.</span><span class="nx">collection</span><span class="p">.</span><span class="nx">page</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="nv">first = </span><span class="nb">parseFloat</span> <span class="nx">page</span> <span class="o">*</span> <span class="nx">rows</span> <span class="o">-</span> <span class="nx">rows</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="nv">last = </span><span class="k">if</span> <span class="nx">page</span> <span class="o">*</span> <span class="nx">rows</span> <span class="o">&gt;</span> <span class="nx">total</span> <span class="k">then</span> <span class="nx">total</span> <span class="k">else</span> <span class="nx">page</span> <span class="o">*</span> <span class="nx">rows</span>
            <span class="k">if</span> <span class="nx">total</span> <span class="o">&gt;</span> <span class="nx">rows</span>
                <span class="nx">$</span><span class="p">(</span><span class="s">&#39;#content&#39;</span><span class="p">).</span><span class="nx">removeClass</span> <span class="s">&#39;noPages&#39;</span>
                <span class="nx">$</span><span class="p">(</span><span class="s">&#39;#footer&#39;</span><span class="p">).</span><span class="nx">html</span> <span class="nx">template</span><span class="p">()</span>
                <span class="k">return</span> <span class="nx">$</span><span class="p">(</span><span class="s">&#39;#footer&#39;</span><span class="p">).</span><span class="nx">show</span><span class="p">()</span>
            <span class="nx">$</span><span class="p">(</span><span class="s">&#39;#content&#39;</span><span class="p">).</span><span class="nx">addClass</span> <span class="s">&#39;noPages&#39;</span>
            <span class="nx">$</span><span class="p">(</span><span class="s">&#39;#footer&#39;</span><span class="p">).</span><span class="nx">hide</span><span class="p">()</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-73">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-73">&#182;</a>                          </div>                          <p>Handle a click on a facet field. Add facet to selection, filter
with new selection and activate field</p>                      </td>                      <td class="code">                          <div class="highlight"><pre>        <span class="nv">handleFacetClick: </span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="o">=&gt;</span>
            <span class="nv">$e    = </span><span class="nx">$</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">currentTarget</span><span class="p">)</span>
            <span class="nv">cat   = </span><span class="nx">$e</span><span class="p">.</span><span class="nx">attr</span> <span class="s">&#39;data-name&#39;</span>
            <span class="nv">name  = </span><span class="nx">$e</span><span class="p">.</span><span class="nx">attr</span> <span class="s">&#39;data-title&#39;</span>

            <span class="k">if</span> <span class="nx">e</span><span class="p">.</span><span class="nx">ctrlKey</span> <span class="o">or</span> <span class="nx">e</span><span class="p">.</span><span class="nx">altKey</span>
                <span class="nx">@filterSelection</span><span class="p">.</span><span class="nx">toggleMult</span> <span class="nv">cat: </span><span class="nx">cat</span><span class="p">,</span> <span class="nx">field</span><span class="o">:</span><span class="nx">name</span>
            <span class="k">else</span>
                <span class="nx">@filterSelection</span><span class="p">.</span><span class="nx">toggle</span> <span class="nx">cat</span><span class="o">:</span><span class="nx">cat</span><span class="p">,</span> <span class="nx">field</span><span class="o">:</span><span class="nx">name</span>

            <span class="nx">@showLoadingAnimation</span><span class="p">()</span>

            <span class="nx">@filterByFacet</span> <span class="p">()</span> <span class="o">=&gt;</span>
                <span class="nb">window</span><span class="p">.</span><span class="nx">paneView</span><span class="o">?</span><span class="p">.</span><span class="nx">close</span><span class="p">()</span> <span class="k">if</span> <span class="nx">@filterSelection</span><span class="p">.</span><span class="nx">get</span><span class="p">().</span><span class="nx">length</span> <span class="o">!=</span> <span class="mi">1</span>
                <span class="nx">$e</span><span class="p">.</span><span class="nx">toggleClass</span> <span class="s">&#39;active&#39;</span>
                <span class="nx">$</span><span class="p">(</span><span class="s">&#39;span.amount&#39;</span><span class="p">,</span> <span class="nx">$e</span><span class="p">).</span><span class="nx">toggleClass</span> <span class="s">&#39;active&#39;</span>
                <span class="nx">$</span><span class="p">(</span><span class="s">&#39;span#reset&#39;</span><span class="p">)</span>
                    <span class="p">.</span><span class="nx">show</span><span class="p">()</span> <span class="nx">unless</span> <span class="nx">@filterSelection</span><span class="p">.</span><span class="nx">get</span><span class="p">().</span><span class="nx">length</span> <span class="o">is</span> <span class="mi">0</span>
                <span class="nx">@showPaneView</span><span class="p">()</span>

            <span class="nx">$</span><span class="p">(</span><span class="s">&#39;#inputSearch&#39;</span><span class="p">).</span><span class="nx">focus</span><span class="p">()</span> <span class="nx">unless</span> <span class="nx">@isTablet</span><span class="p">()</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-74">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-74">&#182;</a>                          </div>                          <p>Reset filters and navigate(). Useful when a user clicked on
the 'reset filters' link next to the search input field.</p>                      </td>                      <td class="code">                          <div class="highlight"><pre>        <span class="nv">onResetFilter: </span><span class="p">()</span> <span class="o">=&gt;</span>
            <span class="nx">@resetFilter</span> <span class="p">()</span> <span class="o">=&gt;</span>
                <span class="nx">@navigate</span><span class="p">()</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-75">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-75">&#182;</a>                          </div>                          <p>Activate facet fields from the facet selection array and show any
facet in a hidden subcategory by expanding the parent node</p>                      </td>                      <td class="code">                          <div class="highlight"><pre>        <span class="nv">setFacetState: </span><span class="p">(</span><span class="nx">s</span><span class="p">)</span> <span class="o">=&gt;</span>
            <span class="nx">@filterSelection</span><span class="p">.</span><span class="nx">set</span> <span class="nx">s</span>
            <span class="nx">_</span><span class="p">.</span><span class="nx">each</span> <span class="nx">s</span><span class="p">,</span> <span class="p">(</span><span class="nx">c</span><span class="p">)</span> <span class="o">=&gt;</span>
                <span class="nv">$f = </span><span class="nx">$</span><span class="p">(</span><span class="s">&quot;.field[data-title=&#39;</span><span class="si">#{</span><span class="nx">c</span><span class="p">.</span><span class="nx">field</span><span class="si">}</span><span class="s">&#39;]&quot;</span><span class="p">,</span>
                  <span class="s">&quot;ul</span><span class="err">#</span><span class="s">facet li ul\#</span><span class="si">#{</span><span class="nx">c</span><span class="p">.</span><span class="nx">cat</span><span class="si">}</span><span class="s">&quot;</span><span class="p">)</span>
                <span class="nx">$f</span><span class="p">.</span><span class="nx">addClass</span> <span class="s">&#39;active&#39;</span>
                <span class="nx">$</span><span class="p">(</span><span class="s">&#39;span.amount&#39;</span><span class="p">,</span> <span class="nx">$f</span><span class="p">).</span><span class="nx">addClass</span> <span class="s">&#39;active&#39;</span>

                <span class="nv">$p = </span><span class="nx">$f</span><span class="p">.</span><span class="nx">parent</span><span class="p">()</span>
                <span class="nx">$</span><span class="p">(</span><span class="s">&#39;&gt;span.fold&#39;</span><span class="p">,</span> <span class="nx">$p</span><span class="p">.</span><span class="nx">parents</span><span class="p">()).</span><span class="nx">addClass</span><span class="p">(</span><span class="s">&#39;open&#39;</span><span class="p">).</span><span class="nx">html</span> <span class="s">&#39;&#39;</span>
                <span class="nx">$</span><span class="p">(</span><span class="s">&#39;&gt;ul&#39;</span><span class="p">,</span> <span class="nx">$p</span><span class="p">.</span><span class="nx">parents</span><span class="p">()).</span><span class="nx">css</span><span class="p">(</span><span class="s">&#39;display&#39;</span><span class="p">,</span> <span class="s">&#39;block&#39;</span><span class="p">)</span>

            <span class="nx">_</span><span class="p">.</span><span class="nx">each</span> <span class="nx">@facetOpenState</span><span class="p">.</span><span class="nx">get</span><span class="p">(),</span> <span class="p">(</span><span class="nx">c</span><span class="p">)</span> <span class="o">=&gt;</span>
                <span class="nv">$f = </span><span class="nx">$</span><span class="p">(</span><span class="s">&quot;li[data-name=&#39;</span><span class="si">#{</span><span class="nx">c</span><span class="p">.</span><span class="nx">cat</span><span class="si">}</span><span class="s">&#39;][data-title=&#39;</span><span class="si">#{</span><span class="nx">c</span><span class="p">.</span><span class="nx">field</span><span class="si">}</span><span class="s">&#39;]&quot;</span><span class="p">)</span>
                <span class="nx">$</span><span class="p">(</span><span class="s">&#39;&gt;span.fold&#39;</span><span class="p">,</span> <span class="nx">$f</span><span class="p">).</span><span class="nx">addClass</span><span class="p">(</span><span class="s">&#39;open&#39;</span><span class="p">).</span><span class="nx">html</span> <span class="s">&#39;&#39;</span>
                <span class="nx">$</span><span class="p">(</span><span class="s">&#39;&gt;ul&#39;</span><span class="p">,</span> <span class="nx">$f</span><span class="p">).</span><span class="nx">css</span><span class="p">(</span><span class="s">&#39;display&#39;</span><span class="p">,</span> <span class="s">&#39;block&#39;</span><span class="p">)</span>

            <span class="nx">@showPaneView</span><span class="p">()</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-76">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-76">&#182;</a>                          </div>                          <p>Check if field in filterSelection array still exists on html facet. If
its not, removes it.</p>                      </td>                      <td class="code">                          <div class="highlight"><pre>        <span class="nv">updateFacetState: </span><span class="p">()</span> <span class="o">=&gt;</span>
            <span class="nx">$</span><span class="p">(</span><span class="s">&#39;#pane&#39;</span><span class="p">).</span><span class="nx">hide</span><span class="p">()</span> <span class="nx">unless</span> <span class="nb">window</span><span class="p">.</span><span class="nx">groupView</span> <span class="o">or</span> <span class="nb">window</span><span class="p">.</span><span class="nx">paneView</span>
            <span class="nx">@trigger</span> <span class="s">&#39;updateFacetState&#39;</span>

            <span class="nv">nf = </span><span class="p">[]</span>
            <span class="nx">_</span><span class="p">.</span><span class="nx">each</span> <span class="nx">@filterSelection</span><span class="p">.</span><span class="nx">get</span><span class="p">(),</span> <span class="p">(</span><span class="nx">c</span><span class="p">)</span> <span class="o">=&gt;</span>
                <span class="nv">$e = </span><span class="nx">$</span><span class="p">(</span><span class="s">&quot;span[data-type=&#39;</span><span class="si">#{</span><span class="nx">c</span><span class="p">.</span><span class="nx">cat</span><span class="si">}</span><span class="s">&#39;][data-title=&#39;</span><span class="si">#{</span><span class="nx">c</span><span class="p">.</span><span class="nx">field</span><span class="si">}</span><span class="s">&#39;]&quot;</span><span class="p">)</span>
                <span class="nv">$f = </span><span class="nx">$</span><span class="p">(</span><span class="s">&quot;.field[data-title=&#39;</span><span class="si">#{</span><span class="nx">c</span><span class="p">.</span><span class="nx">field</span><span class="si">}</span><span class="s">&#39;]&quot;</span><span class="p">,</span>
                      <span class="s">&quot;ul</span><span class="err">#</span><span class="s">facet li ul\#</span><span class="si">#{</span><span class="nx">c</span><span class="p">.</span><span class="nx">cat</span><span class="si">}</span><span class="s">&quot;</span><span class="p">)</span>
                <span class="nx">nf</span><span class="p">.</span><span class="nx">push</span> <span class="nv">cat: </span><span class="nx">c</span><span class="p">.</span><span class="nx">cat</span><span class="p">,</span> <span class="nv">field: </span><span class="nx">c</span><span class="p">.</span><span class="nx">field</span> <span class="k">if</span> <span class="nx">$f</span><span class="p">.</span><span class="nx">length</span> <span class="o">or</span> <span class="nx">$e</span><span class="p">.</span><span class="nx">length</span>
            <span class="nx">@filterSelection</span><span class="p">.</span><span class="nx">set</span> <span class="nx">nf</span>
            <span class="nx">$</span><span class="p">(</span><span class="s">&#39;span#reset&#39;</span><span class="p">).</span><span class="nx">hide</span><span class="p">()</span> <span class="nx">unless</span> <span class="nx">nf</span><span class="p">.</span><span class="nx">length</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-77">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-77">&#182;</a>                          </div>                          <p>Forms an array of facet field parameters to put in the querystring</p>                      </td>                      <td class="code">                          <div class="highlight"><pre>        <span class="nv">getFilterQS: </span><span class="p">(</span><span class="nx">state</span><span class="p">)</span> <span class="o">=&gt;</span>
            <span class="nv">s = </span><span class="nx">state</span> <span class="o">||</span> <span class="nx">@filterSelection</span><span class="p">.</span><span class="nx">get</span><span class="p">()</span>
            <span class="nv">data = </span><span class="p">{</span><span class="nv">fs: </span><span class="p">[]</span> <span class="p">}</span>
            <span class="nx">_</span><span class="p">.</span><span class="nx">each</span> <span class="nx">s</span><span class="p">,</span> <span class="nf">(f) -&gt;</span>
                <span class="nx">data</span><span class="p">.</span><span class="nx">fs</span><span class="p">.</span><span class="nx">push</span> <span class="s">&quot;</span><span class="si">#{</span><span class="nx">f</span><span class="p">.</span><span class="nx">cat</span><span class="si">}</span><span class="s">:</span><span class="si">#{</span><span class="nx">f</span><span class="p">.</span><span class="nx">field</span><span class="si">}</span><span class="s">&quot;</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-78">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-78">&#182;</a>                          </div>                          <p>@updateFacetState()</p>                      </td>                      <td class="code">                          <div class="highlight"><pre>            <span class="nx">data</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-79">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-79">&#182;</a>                          </div>                          <p>Form a URL with the basic prefix (i.e. /collection) and appends all
filter parameters on the querystring.</p>                      </td>                      <td class="code">                          <div class="highlight"><pre>        <span class="nv">commonURL: </span><span class="p">(</span><span class="nx">page</span><span class="p">,</span> <span class="nx">rows</span><span class="p">)</span> <span class="o">=&gt;</span>
            <span class="nv">url = </span><span class="s">&quot;collection/&quot;</span>
            <span class="nv">fs = </span><span class="p">[]</span>
            <span class="nx">fs</span><span class="p">.</span><span class="nx">push</span> <span class="s">&quot;page=</span><span class="si">#{</span><span class="nx">page</span><span class="si">}</span><span class="s">&quot;</span> <span class="k">if</span> <span class="nx">page</span> <span class="o">isnt</span> <span class="kc">undefined</span>
            <span class="nx">fs</span><span class="p">.</span><span class="nx">push</span> <span class="s">&quot;rows=</span><span class="si">#{</span><span class="nx">rows</span><span class="si">}</span><span class="s">&quot;</span> <span class="k">if</span> <span class="nx">rows</span> <span class="o">isnt</span> <span class="kc">undefined</span>
            <span class="nx">fs</span><span class="p">.</span><span class="nx">push</span> <span class="s">&quot;sort=</span><span class="si">#{</span><span class="nb">window</span><span class="p">.</span><span class="nx">collection</span><span class="p">.</span><span class="nx">sort</span><span class="si">}</span><span class="s">&quot;</span>
            <span class="nx">_</span><span class="p">.</span><span class="nx">each</span> <span class="nb">window</span><span class="p">.</span><span class="nx">Settings</span><span class="p">.</span><span class="nx">Schema</span><span class="p">.</span><span class="nx">getFacets</span><span class="p">(),</span> <span class="nf">(field) -&gt;</span>
                <span class="nx">fs</span><span class="p">.</span><span class="nx">push</span> <span class="s">&#39;facet.field=&#39;</span> <span class="o">+</span> <span class="nx">field</span><span class="p">.</span><span class="nx">id</span>
            <span class="nx">url</span> <span class="o">+=</span> <span class="s">&#39;?&#39;</span> <span class="o">+</span> <span class="nx">fs</span><span class="p">.</span><span class="nx">join</span> <span class="s">&#39;&amp;&#39;</span> <span class="k">if</span> <span class="nx">fs</span><span class="p">.</span><span class="nx">length</span>
            <span class="nx">url</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-80">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-80">&#182;</a>                          </div>                          <p>A user keyup'ed on the search input field. Disable some keys like
ctrl, alt, up/down arrow keys to avoid refetching the same</p>                      </td>                      <td class="code">                          <div class="highlight"><pre>        <span class="nv">onSearchInput: </span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="o">=&gt;</span>
            <span class="nv">disabledKeys =</span>
                <span class="p">[</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">27</span><span class="p">,</span> <span class="mi">33</span><span class="p">,</span> <span class="mi">34</span><span class="p">,</span> <span class="mi">35</span><span class="p">,</span> <span class="mi">36</span><span class="p">,</span> <span class="mi">37</span><span class="p">,</span> <span class="mi">38</span><span class="p">,</span> <span class="mi">39</span><span class="p">,</span> <span class="mi">40</span> <span class="p">]</span>

            <span class="k">if</span> <span class="nx">e</span><span class="p">.</span><span class="nx">keyCode</span>
                <span class="k">return</span> <span class="nx">unless</span> <span class="nx">disabledKeys</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">keyCode</span><span class="p">)</span> <span class="o">is</span> <span class="o">-</span><span class="mi">1</span>
            <span class="nx">@search</span><span class="p">()</span>
            <span class="nx">@navigate</span><span class="p">()</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-81">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-81">&#182;</a>                          </div>                          <h3 id="search">Search</h3>

<ul>
<li>Filter the items collection given the 'letters' from search input</li>
<li>Renders entire collection in case there are no 'letters'</li>
</ul>                      </td>                      <td class="code">                          <div class="highlight"><pre>        <span class="nv">search: </span><span class="p">(</span><span class="nx">attr</span><span class="p">)</span> <span class="o">=&gt;</span>

            <span class="nv">letters = </span><span class="nx">$</span><span class="p">(</span><span class="s">&quot;</span><span class="err">#</span><span class="s">inputSearch&quot;</span><span class="p">).</span><span class="nx">val</span><span class="p">().</span><span class="nx">toLowerCase</span><span class="p">()</span>

            <span class="k">return</span> <span class="k">if</span> <span class="nb">window</span><span class="p">.</span><span class="nx">collection</span><span class="p">.</span><span class="nx">search</span> <span class="o">is</span> <span class="nx">letters</span>

            <span class="nx">$</span><span class="p">(</span><span class="s">&#39;#search span#reset&#39;</span><span class="p">).</span><span class="nx">show</span><span class="p">()</span>
            <span class="nx">$</span><span class="p">(</span><span class="s">&#39;#search span#reset&#39;</span><span class="p">).</span><span class="nx">hide</span><span class="p">()</span> <span class="nx">unless</span> <span class="nx">letters</span> <span class="o">or</span> <span class="nx">@filterSelection</span>
                <span class="p">.</span><span class="nx">get</span><span class="p">().</span><span class="nx">length</span>

            <span class="nx">@unbindItemViews</span><span class="p">()</span>
            <span class="nb">window</span><span class="p">.</span><span class="nv">collection.search = </span><span class="nx">letters</span>
            <span class="nb">window</span><span class="p">.</span><span class="nv">collection.page = </span><span class="mi">0</span>
            <span class="nx">@filterByFacet</span> <span class="p">()</span> <span class="o">=&gt;</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-82">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-82">&#182;</a>                          </div>                          <p>Sort table when clicking on header. Toggle asc/desc modes.</p>                      </td>                      <td class="code">                          <div class="highlight"><pre>        <span class="nv">sortTable: </span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="o">=&gt;</span>
            <span class="nv">$e = </span><span class="nx">$</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">currentTarget</span><span class="p">)</span>
            <span class="nv">$h = </span><span class="nx">$e</span><span class="p">.</span><span class="nx">parent</span><span class="p">()</span>

            <span class="nx">_</span><span class="p">.</span><span class="nx">each</span> <span class="nx">$h</span><span class="p">.</span><span class="nx">siblings</span><span class="p">(),</span> <span class="nf">(s) -&gt;</span>
                <span class="nx">$</span><span class="p">(</span><span class="s">&#39;.th-inner&#39;</span><span class="p">,</span> <span class="nx">s</span><span class="p">).</span><span class="nx">removeClass</span><span class="p">(</span><span class="s">&#39;asc desc&#39;</span><span class="p">)</span>

            <span class="k">if</span> <span class="nx">$e</span><span class="p">.</span><span class="nx">hasClass</span> <span class="s">&#39;asc&#39;</span>
                <span class="nx">$e</span><span class="p">.</span><span class="nx">removeClass</span><span class="p">(</span><span class="s">&#39;asc&#39;</span><span class="p">).</span><span class="nx">addClass</span><span class="p">(</span><span class="s">&#39;desc&#39;</span><span class="p">)</span>
            <span class="k">else</span>
                <span class="nx">$e</span><span class="p">.</span><span class="nx">removeClass</span><span class="p">(</span><span class="s">&#39;desc&#39;</span><span class="p">).</span><span class="nx">addClass</span><span class="p">(</span><span class="s">&#39;asc&#39;</span><span class="p">)</span>

            <span class="nv">id = </span><span class="nx">$h</span><span class="p">.</span><span class="nx">attr</span> <span class="s">&#39;id&#39;</span>

            <span class="nv">order = </span><span class="s">&#39;asc&#39;</span>
            <span class="nv">order = </span><span class="s">&#39;desc&#39;</span> <span class="k">if</span> <span class="nx">$e</span><span class="p">.</span><span class="nx">hasClass</span> <span class="s">&#39;desc&#39;</span>
            <span class="nb">window</span><span class="p">.</span><span class="nv">collection.sort = </span><span class="s">&quot;</span><span class="si">#{</span><span class="nx">id</span><span class="si">}</span><span class="s">:</span><span class="si">#{</span><span class="nx">order</span><span class="si">}</span><span class="s">&quot;</span>
            <span class="nb">window</span><span class="p">.</span><span class="nv">collection.page = </span><span class="mi">0</span>
            <span class="nx">@saveSort</span><span class="p">()</span>
            <span class="nx">@filterByFacet</span> <span class="p">()</span> <span class="o">=&gt;</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-83">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-83">&#182;</a>                          </div>                          <p>Save sort criteria on localStorage</p>                      </td>                      <td class="code">                          <div class="highlight"><pre>        <span class="nv">saveSort: </span><span class="nf">() -&gt;</span>
            <span class="nv">entity = </span><span class="nb">window</span><span class="p">.</span><span class="nx">Settings</span><span class="p">.</span><span class="nx">entity</span>
            <span class="nv">ls = </span><span class="nb">window</span><span class="p">.</span><span class="nx">localStorage</span><span class="p">[</span><span class="nx">entity</span><span class="p">]</span>
            <span class="nv">ls = </span><span class="k">if</span> <span class="nx">ls</span> <span class="k">then</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">parse</span> <span class="nx">ls</span> <span class="k">else</span> <span class="p">{}</span>
            <span class="nv">ls.sort = </span><span class="p">{}</span> <span class="nx">unless</span> <span class="nx">ls</span><span class="p">.</span><span class="nx">sort</span>
            <span class="nv">ls.sort = </span><span class="nb">window</span><span class="p">.</span><span class="nx">collection</span><span class="p">.</span><span class="nx">sort</span>
            <span class="nb">window</span><span class="p">.</span><span class="nx">localStorage</span><span class="p">[</span><span class="nx">entity</span><span class="p">]</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span> <span class="nx">ls</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-84">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-84">&#182;</a>                          </div>                          <p>Get sort criteria from localStorage or default configuration.</p>                      </td>                      <td class="code">                          <div class="highlight"><pre>        <span class="nv">getSort: </span><span class="p">()</span> <span class="o">=&gt;</span>
            <span class="nv">entity = </span><span class="nb">window</span><span class="p">.</span><span class="nx">Settings</span><span class="p">.</span><span class="nx">entity</span>
            <span class="k">return</span> <span class="nb">window</span><span class="p">.</span><span class="nx">Settings</span><span class="p">.</span><span class="nx">sort</span> <span class="nx">unless</span> <span class="nb">window</span><span class="p">.</span><span class="nx">localStorage</span><span class="p">[</span><span class="nx">entity</span><span class="p">]</span>
            <span class="nv">ls = </span><span class="nx">JSON</span><span class="p">.</span><span class="nx">parse</span> <span class="nb">window</span><span class="p">.</span><span class="nx">localStorage</span><span class="p">[</span><span class="nx">entity</span><span class="p">]</span>
            <span class="k">return</span> <span class="nb">window</span><span class="p">.</span><span class="nx">Settings</span><span class="p">.</span><span class="nx">sort</span> <span class="nx">unless</span> <span class="nx">ls</span><span class="p">.</span><span class="nx">sort</span>
            <span class="k">return</span> <span class="nx">ls</span><span class="p">.</span><span class="nx">sort</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-85">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-85">&#182;</a>                          </div>                          <p>Open/Close a facet section</p>                      </td>                      <td class="code">                          <div class="highlight"><pre>        <span class="nv">toggleFacetNode: </span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="o">=&gt;</span>
            <span class="nv">$e = </span><span class="nx">$</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">currentTarget</span><span class="p">)</span>
            <span class="nv">$e = </span><span class="nx">$e</span><span class="p">.</span><span class="nx">siblings</span><span class="p">(</span><span class="s">&#39;span&#39;</span><span class="p">)</span> <span class="nx">unless</span> <span class="nx">$e</span><span class="p">.</span><span class="nx">hasClass</span> <span class="s">&#39;fold&#39;</span>
            <span class="nv">$ul = </span><span class="nx">$e</span><span class="p">.</span><span class="nx">siblings</span><span class="p">(</span><span class="s">&#39;ul&#39;</span><span class="p">)</span>
            <span class="nv">cat = </span><span class="nx">$ul</span><span class="p">.</span><span class="nx">attr</span> <span class="s">&#39;id&#39;</span>
            <span class="k">if</span> <span class="nx">$e</span><span class="p">.</span><span class="nx">hasClass</span> <span class="s">&#39;open&#39;</span>
                <span class="nx">$ul</span><span class="p">.</span><span class="nx">hide</span><span class="p">()</span>
                <span class="nx">@facetOpenState</span><span class="p">.</span><span class="nx">toggle</span> <span class="nv">cat: </span><span class="nx">cat</span><span class="p">,</span> <span class="nv">field: </span><span class="s">&#39;facet&#39;</span>
                <span class="nx">@saveFacetOpenState</span><span class="p">()</span>
                <span class="k">return</span> <span class="nx">$e</span><span class="p">.</span><span class="nx">removeClass</span><span class="p">(</span><span class="s">&#39;open&#39;</span><span class="p">).</span><span class="nx">html</span> <span class="s">&#39;+&#39;</span>
            <span class="nx">$ul</span><span class="p">.</span><span class="nx">css</span><span class="p">(</span><span class="s">&#39;display&#39;</span><span class="p">,</span> <span class="s">&#39;block&#39;</span><span class="p">)</span>
            <span class="nx">@facetOpenState</span><span class="p">.</span><span class="nx">push</span> <span class="nv">cat: </span><span class="nx">cat</span><span class="p">,</span> <span class="nv">field: </span><span class="s">&#39;facet&#39;</span>
            <span class="nx">$e</span><span class="p">.</span><span class="nx">addClass</span><span class="p">(</span><span class="s">&#39;open&#39;</span><span class="p">).</span><span class="nx">html</span> <span class="s">&#39;&#39;</span>
            <span class="nx">@saveFacetOpenState</span><span class="p">()</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-86">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-86">&#182;</a>                          </div>                          <p>Handles expansion and collapse of facet fields when clicking on '+'
or '-' symbols next to the facet field label.</p>                      </td>                      <td class="code">                          <div class="highlight"><pre>        <span class="nv">toggleFacetSubfields: </span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="o">=&gt;</span>
            <span class="nv">$e  = </span><span class="nx">$</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">currentTarget</span><span class="p">)</span>
            <span class="nv">$p = </span><span class="nx">$e</span><span class="p">.</span><span class="nx">parent</span><span class="p">()</span>
            <span class="nv">cat = </span><span class="nx">$p</span><span class="p">.</span><span class="nx">attr</span> <span class="s">&#39;data-name&#39;</span>
            <span class="nv">field = </span><span class="nx">$p</span><span class="p">.</span><span class="nx">attr</span> <span class="s">&#39;data-title&#39;</span>

            <span class="k">if</span> <span class="nx">$e</span><span class="p">.</span><span class="nx">hasClass</span> <span class="s">&#39;open&#39;</span>
                <span class="nx">$</span><span class="p">(</span><span class="s">&quot;ul[data-name=&#39;</span><span class="si">#{</span><span class="nx">cat</span><span class="si">}</span><span class="s">&#39;][data-title=&#39;</span><span class="si">#{</span><span class="nx">field</span><span class="si">}</span><span class="s">&#39;]&quot;</span><span class="p">,</span> <span class="nx">$p</span><span class="p">).</span><span class="nx">hide</span><span class="p">()</span>
                <span class="nx">$e</span><span class="p">.</span><span class="nx">removeClass</span> <span class="s">&#39;open&#39;</span>
                <span class="nx">@facetOpenState</span><span class="p">.</span><span class="nx">toggle</span> <span class="nx">cat</span><span class="o">:</span><span class="nx">cat</span><span class="p">,</span> <span class="nx">field</span><span class="o">:</span><span class="nx">field</span>
                <span class="k">return</span> <span class="nx">$e</span><span class="p">.</span><span class="nx">removeClass</span><span class="p">(</span><span class="s">&#39;open&#39;</span><span class="p">).</span><span class="nx">html</span> <span class="s">&#39;+&#39;</span>

            <span class="nx">@facetOpenState</span><span class="p">.</span><span class="nx">push</span> <span class="nv">cat: </span><span class="nx">cat</span><span class="p">,</span> <span class="nv">field: </span><span class="nx">field</span>
            <span class="nx">$</span><span class="p">(</span><span class="s">&quot;ul[data-name=&#39;</span><span class="si">#{</span><span class="nx">cat</span><span class="si">}</span><span class="s">&#39;][data-title=&#39;</span><span class="si">#{</span><span class="nx">field</span><span class="si">}</span><span class="s">&#39;]&quot;</span><span class="p">,</span> <span class="nx">$p</span><span class="p">).</span><span class="nx">show</span><span class="p">()</span>
            <span class="nx">$e</span><span class="p">.</span><span class="nx">addClass</span><span class="p">(</span><span class="s">&#39;open&#39;</span><span class="p">).</span><span class="nx">html</span> <span class="s">&#39;&#39;</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-87">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-87">&#182;</a>                          </div>                          <p>Show a detailed view of an item in the rightmost pane</p>                      </td>                      <td class="code">                          <div class="highlight"><pre>        <span class="nv">showProfile: </span><span class="p">(</span><span class="nx">item</span><span class="p">)</span> <span class="o">=&gt;</span>
            <span class="nb">window</span><span class="p">.</span><span class="nx">groupView</span><span class="o">?</span><span class="p">.</span><span class="nx">destroy</span><span class="p">()</span>
            <span class="nb">window</span><span class="p">.</span><span class="nv">profileView = </span><span class="k">new</span> <span class="nx">ProfileView</span> <span class="nv">model: </span><span class="nx">item</span>
            <span class="nx">$</span><span class="p">(</span><span class="s">&#39;#pane&#39;</span><span class="p">).</span><span class="nx">html</span> <span class="nb">window</span><span class="p">.</span><span class="nx">profileView</span><span class="p">.</span><span class="nx">render</span><span class="p">().</span><span class="nx">el</span>
            <span class="nx">$</span><span class="p">(</span><span class="s">&#39;#tableContainer, #thumbnailContainer&#39;</span><span class="p">).</span><span class="nx">addClass</span> <span class="s">&#39;onProfile&#39;</span>
            <span class="nx">$</span><span class="p">(</span><span class="s">&#39;#footer, #columnsSelectWrapper&#39;</span><span class="p">).</span><span class="nx">addClass</span> <span class="s">&#39;onProfile&#39;</span>
            <span class="nx">@addProfileExtensions</span> <span class="nx">item</span>
            <span class="nv">t = </span><span class="p">[]</span>
            <span class="nx">_</span><span class="p">.</span><span class="nx">each</span> <span class="nb">window</span><span class="p">.</span><span class="nx">Settings</span><span class="p">.</span><span class="nx">Schema</span><span class="p">.</span><span class="nx">getThumbnails</span><span class="p">(),</span> <span class="nf">(l) -&gt;</span>
                <span class="nx">t</span><span class="p">.</span><span class="nx">push</span> <span class="nx">item</span><span class="p">.</span><span class="nx">get</span> <span class="nx">l</span><span class="p">.</span><span class="nx">id</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-88">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-88">&#182;</a>                          </div>                          <p>Show a group view when many items have been selected</p>                      </td>                      <td class="code">                          <div class="highlight"><pre>        <span class="nv">showGroupView: </span><span class="p">()</span> <span class="o">=&gt;</span>
            <span class="nb">window</span><span class="p">.</span><span class="nx">profileView</span><span class="o">?</span><span class="p">.</span><span class="nx">destroy</span><span class="p">()</span>
            <span class="nb">window</span><span class="p">.</span><span class="nx">groupView</span><span class="o">?</span><span class="p">.</span><span class="nx">destroy</span><span class="p">()</span>

            <span class="nb">window</span><span class="p">.</span><span class="nv">groupView = </span><span class="k">new</span> <span class="nx">GroupView</span> <span class="nx">unless</span> <span class="nb">window</span><span class="p">.</span><span class="nx">groupView</span>
            <span class="nx">$</span><span class="p">(</span><span class="s">&#39;#pane&#39;</span><span class="p">).</span><span class="nx">css</span><span class="p">(</span><span class="s">&#39;display&#39;</span><span class="p">,</span> <span class="s">&#39;block&#39;</span><span class="p">).</span><span class="nx">html</span> <span class="nb">window</span><span class="p">.</span><span class="nx">groupView</span><span class="p">.</span><span class="nx">render</span><span class="p">().</span><span class="nx">el</span>

            <span class="nx">@navigate</span><span class="p">()</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-89">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-89">&#182;</a>                          </div>                          <p>Show a customazible view on the right pane. Triggered when
clicking on facet fields. Template defined in extension templates.</p>                      </td>                      <td class="code">                          <div class="highlight"><pre>        <span class="nv">showPaneView: </span><span class="p">()</span> <span class="o">=&gt;</span>
            <span class="k">return</span> <span class="k">if</span> <span class="nb">window</span><span class="p">.</span><span class="nx">profileView</span> <span class="o">or</span> <span class="nb">window</span><span class="p">.</span><span class="nx">groupView</span>
            <span class="k">return</span> <span class="k">if</span> <span class="nx">@filterSelection</span><span class="p">.</span><span class="nx">get</span><span class="p">().</span><span class="nx">length</span> <span class="o">isnt</span> <span class="mi">1</span>

            <span class="p">{</span> <span class="nx">field</span><span class="p">,</span> <span class="nx">cat</span> <span class="p">}</span> <span class="o">=</span> <span class="nx">@filterSelection</span><span class="p">.</span><span class="nx">get</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">return</span> <span class="nb">window</span><span class="p">.</span><span class="nx">paneView</span><span class="o">?</span><span class="p">.</span><span class="nx">close</span><span class="p">()</span> <span class="nx">unless</span> <span class="nb">window</span><span class="p">.</span><span class="nx">pdata</span><span class="p">[</span><span class="nx">cat</span><span class="p">]</span><span class="o">?</span><span class="p">[</span><span class="nx">field</span><span class="p">]</span>

            <span class="nv">template = </span><span class="nx">_</span><span class="p">.</span><span class="nx">template</span> <span class="nx">$</span><span class="p">(</span><span class="s">&quot;</span><span class="err">#</span><span class="s">app &gt; </span><span class="err">#</span><span class="s">extensions </span><span class="err">#</span><span class="s">pane-template&quot;</span><span class="p">).</span><span class="nx">html</span><span class="p">()</span>

            <span class="nb">window</span><span class="p">.</span><span class="nv">paneView = </span><span class="k">new</span> <span class="nx">PaneView</span> <span class="nx">template</span><span class="p">,</span> <span class="nv">t: </span><span class="nb">window</span><span class="p">.</span><span class="nx">pdata</span><span class="p">[</span><span class="nx">cat</span><span class="p">][</span><span class="nx">field</span><span class="p">]</span>
            <span class="nx">$</span><span class="p">(</span><span class="s">&#39;#pane&#39;</span><span class="p">).</span><span class="nx">css</span><span class="p">(</span><span class="s">&#39;display&#39;</span><span class="p">,</span> <span class="s">&#39;block&#39;</span><span class="p">).</span><span class="nx">html</span> <span class="nb">window</span><span class="p">.</span><span class="nx">paneView</span><span class="p">.</span><span class="nx">render</span><span class="p">().</span><span class="nx">el</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-90">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-90">&#182;</a>                          </div>                          <p>Close pane only after successfull reset of facets</p>                      </td>                      <td class="code">                          <div class="highlight"><pre>            <span class="nx">$</span><span class="p">(</span><span class="nb">window</span><span class="p">.</span><span class="nx">paneView</span><span class="p">.</span><span class="nx">el</span><span class="p">).</span><span class="nx">bind</span> <span class="s">&#39;close&#39;</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span>
                <span class="nx">$</span><span class="p">(</span><span class="nb">window</span><span class="p">.</span><span class="nx">paneView</span><span class="p">.</span><span class="nx">el</span><span class="p">).</span><span class="nx">unbind</span> <span class="s">&#39;close&#39;</span>
                <span class="nx">@resetFacets</span> <span class="p">()</span> <span class="o">=&gt;</span>
                    <span class="nb">window</span><span class="p">.</span><span class="nx">paneView</span><span class="o">?</span><span class="p">.</span><span class="nx">close</span><span class="p">()</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-91">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-91">&#182;</a>                          </div>                          <p>Trigger a profileClosed event whenever a profile view is closed.
Useful to be listened by extension code.</p>                      </td>                      <td class="code">                          <div class="highlight"><pre>        <span class="nv">profileClosed: </span><span class="p">()</span> <span class="o">=&gt;</span>
            <span class="nx">@trigger</span> <span class="s">&#39;profileClosed&#39;</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-92">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-92">&#182;</a>                          </div>                          <p>Destroy all item views, propperly unbinding
and removing html elements</p>                      </td>                      <td class="code">                          <div class="highlight"><pre>        <span class="nv">removeItemViews: </span><span class="nf">() -&gt;</span>
            <span class="nb">window</span><span class="p">.</span><span class="nx">collection</span><span class="p">.</span><span class="nx">each</span> <span class="nf">(item) -&gt;</span>
                <span class="nx">item</span><span class="p">.</span><span class="nx">view</span><span class="o">?</span><span class="p">.</span><span class="nx">destroy</span><span class="p">()</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-93">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-93">&#182;</a>                          </div>                          <p>Unbind all item views</p>                      </td>                      <td class="code">                          <div class="highlight"><pre>        <span class="nv">unbindItemViews: </span><span class="nf">() -&gt;</span>
            <span class="nb">window</span><span class="p">.</span><span class="nx">collection</span><span class="p">.</span><span class="nx">each</span> <span class="nf">(item) -&gt;</span>
                <span class="nx">item</span><span class="p">.</span><span class="nx">view</span><span class="o">?</span><span class="p">.</span><span class="nx">release</span><span class="p">()</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-94">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-94">&#182;</a>                          </div>                          <p>Renders containers for each category.
Only useful in thumbnail view mode. The items will be rendered
inside each container according to its category. The category is
specified in the schema by using the classifier key.</p>                      </td>                      <td class="code">                          <div class="highlight"><pre>        <span class="nv">renderCategoryView: </span><span class="p">(</span><span class="nx">cb</span><span class="p">)</span> <span class="o">=&gt;</span>
            <span class="nv">c = </span><span class="nb">window</span><span class="p">.</span><span class="nx">Settings</span><span class="p">.</span><span class="nx">Schema</span><span class="p">.</span><span class="nx">getClassifier</span><span class="p">()</span>

            <span class="nv">onProfile = </span><span class="s">&#39;&#39;</span>
            <span class="nv">onProfile = </span><span class="s">&#39;onProfile&#39;</span> <span class="k">if</span> <span class="nb">window</span><span class="p">.</span><span class="nx">paneView</span>
            <span class="nv">onProfile = </span><span class="s">&#39;onProfile&#39;</span> <span class="k">if</span> <span class="nb">window</span><span class="p">.</span><span class="nx">profileView</span>

            <span class="nv">html = </span><span class="s">&quot;&lt;ul class=&#39;thumbnailContainer </span><span class="si">#{</span><span class="nx">onProfile</span><span class="si">}</span><span class="s">&#39;&gt;&lt;/div&gt;&quot;</span>
            <span class="nx">$</span><span class="p">(</span><span class="s">&#39;#items&#39;</span><span class="p">).</span><span class="nx">html</span> <span class="nx">html</span>

            <span class="nb">window</span><span class="p">.</span><span class="nx">facets</span><span class="o">?</span><span class="p">.</span><span class="nx">each</span> <span class="p">(</span><span class="nx">facet</span><span class="p">)</span> <span class="o">=&gt;</span>
                <span class="k">return</span> <span class="nx">unless</span> <span class="nx">facet</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s">&#39;name&#39;</span><span class="p">)</span> <span class="o">is</span> <span class="nx">c</span><span class="p">.</span><span class="nx">id</span>

                <span class="nb">window</span><span class="p">.</span><span class="nv">categories = </span><span class="p">[]</span>
                <span class="nv">template = </span><span class="nx">_</span><span class="p">.</span><span class="nx">template</span> <span class="nx">$</span><span class="p">(</span><span class="s">&#39;#category-template&#39;</span><span class="p">).</span><span class="nx">html</span><span class="p">()</span>
                <span class="nv">presentCategories = </span><span class="nx">_</span><span class="p">.</span><span class="nx">extend</span> <span class="p">{},</span>
                    <span class="nx">facet</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s">&#39;fields&#39;</span><span class="p">).</span><span class="nx">normal</span><span class="p">,</span> <span class="nx">facet</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s">&#39;fields&#39;</span><span class="p">).</span><span class="nx">special</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-95">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-95">&#182;</a>                          </div>                          <p>Add the present categoriesin that have a predefined order</p>                      </td>                      <td class="code">                          <div class="highlight"><pre>                <span class="nx">_</span><span class="p">.</span><span class="nx">each</span> <span class="nx">c</span><span class="p">.</span><span class="nx">classifier</span><span class="p">,</span> <span class="p">(</span><span class="nx">cat</span><span class="p">)</span> <span class="o">=&gt;</span>
                    <span class="k">if</span> <span class="nb">window</span><span class="p">.</span><span class="nx">App</span><span class="p">.</span><span class="nx">isCatInCats</span> <span class="nx">cat</span><span class="p">,</span> <span class="nx">presentCategories</span>
                        <span class="k">if</span> <span class="nb">window</span><span class="p">.</span><span class="nx">categories</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="nx">cat</span><span class="p">)</span> <span class="o">is</span> <span class="o">-</span><span class="mi">1</span>
                            <span class="nb">window</span><span class="p">.</span><span class="nx">categories</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">cat</span><span class="p">)</span>
                        <span class="k">delete</span> <span class="nx">presentCategories</span><span class="p">[</span><span class="nx">cat</span><span class="p">]</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-96">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-96">&#182;</a>                          </div>                          <p>Add all other present categories</p>                      </td>                      <td class="code">                          <div class="highlight"><pre>                <span class="nx">_</span><span class="p">.</span><span class="nx">each</span> <span class="nx">presentCategories</span><span class="p">,</span> <span class="p">(</span><span class="nx">amount</span><span class="p">,</span> <span class="nx">cat</span><span class="p">)</span> <span class="o">=&gt;</span>
                    <span class="k">return</span> <span class="k">if</span> <span class="nx">cat</span> <span class="o">is</span> <span class="s">&#39;null&#39;</span>
                    <span class="nb">window</span><span class="p">.</span><span class="nx">categories</span><span class="p">.</span><span class="nx">push</span> <span class="nx">cat</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-97">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-97">&#182;</a>                          </div>                          <p>Lastly, add 'not set' category</p>                      </td>                      <td class="code">                          <div class="highlight"><pre>                <span class="nb">window</span><span class="p">.</span><span class="nx">categories</span><span class="p">.</span><span class="nx">push</span> <span class="s">&#39;null&#39;</span> <span class="k">if</span> <span class="nx">presentCategories</span><span class="p">[</span><span class="s">&#39;null&#39;</span><span class="p">]</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-98">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-98">&#182;</a>                          </div>                          <p>Generate categories based on calculated order</p>                      </td>                      <td class="code">                          <div class="highlight"><pre>                <span class="nx">_</span><span class="p">.</span><span class="nx">each</span> <span class="nb">window</span><span class="p">.</span><span class="nx">categories</span><span class="p">,</span> <span class="p">(</span><span class="nx">category</span><span class="p">,</span> <span class="nx">index</span><span class="p">)</span> <span class="o">=&gt;</span>
                    <span class="nx">$</span><span class="p">(</span><span class="s">&#39;#items .thumbnailContainer&#39;</span><span class="p">).</span><span class="nx">append</span> <span class="nx">template</span>
                        <span class="nv">cat: </span><span class="nx">category</span>
                        <span class="nv">index: </span><span class="nx">index</span>
                <span class="nx">cb</span><span class="p">()</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-99">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-99">&#182;</a>                          </div>                          <p>Renders a table to show items in 'list' view.</p>                      </td>                      <td class="code">                          <div class="highlight"><pre>        <span class="nv">renderTableView: </span><span class="p">(</span><span class="nx">cb</span><span class="p">)</span> <span class="o">=&gt;</span>
            <span class="nx">$</span><span class="p">(</span><span class="s">&#39;#items&#39;</span><span class="p">).</span><span class="nx">html</span> <span class="s">&#39;&#39;</span>
            <span class="nv">classes = </span><span class="s">&quot;onProfile&quot;</span> <span class="k">if</span> <span class="nb">window</span><span class="p">.</span><span class="nx">paneView</span> <span class="o">or</span> <span class="nb">window</span><span class="p">.</span><span class="nx">groupView</span>
            <span class="nx">$</span><span class="p">(</span><span class="s">&#39;#items&#39;</span><span class="p">).</span><span class="nx">append</span> <span class="nx">_</span><span class="p">.</span><span class="nx">template</span> <span class="nx">$</span><span class="p">(</span><span class="s">&#39;#table-template&#39;</span><span class="p">).</span><span class="nx">html</span><span class="p">(),</span>
              <span class="nv">h: </span><span class="nb">window</span><span class="p">.</span><span class="nx">Settings</span><span class="p">.</span><span class="nx">Columns</span>
              <span class="nv">classes: </span><span class="nx">classes</span>
            <span class="nx">cb</span><span class="p">()</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-100">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-100">&#182;</a>                          </div>                          <p>Runs after all items were added, remove all empty categories.</p>                      </td>                      <td class="code">                          <div class="highlight"><pre>        <span class="nv">hideEmptyCategories: </span><span class="p">()</span> <span class="o">=&gt;</span>
            <span class="nx">$</span><span class="p">(</span><span class="s">&quot;</span><span class="err">#</span><span class="s">items li ul&quot;</span><span class="p">).</span><span class="nx">each</span> <span class="nf">(i, cat) -&gt;</span>
                <span class="nx">$</span><span class="p">(</span><span class="nx">$</span><span class="p">(</span><span class="nx">cat</span><span class="p">).</span><span class="nx">parent</span><span class="p">()).</span><span class="nx">show</span><span class="p">()</span>
                <span class="nx">$</span><span class="p">(</span><span class="nx">$</span><span class="p">(</span><span class="nx">cat</span><span class="p">).</span><span class="nx">parent</span><span class="p">()).</span><span class="nx">hide</span><span class="p">()</span> <span class="k">if</span> <span class="nx">$</span><span class="p">(</span><span class="nx">cat</span><span class="p">).</span><span class="nx">find</span><span class="p">(</span><span class="s">&#39;li&#39;</span><span class="p">).</span><span class="nx">length</span> <span class="o">is</span> <span class="mi">0</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-101">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-101">&#182;</a>                          </div>                          <p>Set the amount of items in the collection on the <em> next to the
inputSearch field and on each category title</p>                      </td>                      <td class="code">                          <div class="highlight"><pre>        <span class="nv">setTotals: </span><span class="p">(</span><span class="nx">total</span><span class="p">)</span> <span class="o">=&gt;</span>
            <span class="nx">_</span><span class="p">.</span><span class="nx">each</span> <span class="nx">$</span><span class="p">(</span><span class="s">&#39;#items ul&#39;</span><span class="p">),</span> <span class="p">(</span><span class="nx">ul</span><span class="p">)</span> <span class="o">=&gt;</span>
                <span class="nv">amount = </span><span class="nx">$</span><span class="p">(</span><span class="nx">ul</span><span class="p">).</span><span class="nx">find</span><span class="p">(</span><span class="s">&#39;li&#39;</span><span class="p">).</span><span class="nx">length</span>
                <span class="nx">$</span><span class="p">(</span><span class="s">&#39;em&#39;</span><span class="p">,</span> <span class="nx">$</span><span class="p">(</span><span class="nx">ul</span><span class="p">).</span><span class="nx">siblings</span><span class="p">(</span><span class="s">&#39;label&#39;</span><span class="p">)).</span><span class="nx">html</span> <span class="nx">amount</span>

            <span class="k">return</span> <span class="nx">$</span><span class="p">(</span><span class="s">&#39;span#total&#39;</span><span class="p">).</span><span class="nx">html</span> <span class="nx">total</span> <span class="nx">unless</span> <span class="nx">total</span> <span class="o">is</span> <span class="kc">undefined</span>
            <span class="nx">$</span><span class="p">(</span><span class="s">&#39;span#total&#39;</span><span class="p">).</span><span class="nx">html</span> <span class="nb">window</span><span class="p">.</span><span class="nx">collection</span><span class="p">.</span><span class="nx">total</span>

            <span class="nx">$</span><span class="p">(</span><span class="s">&#39;#search label&#39;</span><span class="p">).</span><span class="nx">html</span> <span class="nx">@getItemType</span><span class="p">()</span> <span class="o">+</span> <span class="s">&#39; found&#39;</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-102">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-102">&#182;</a>                          </div>                          <p>Returns the tag of the items on the search label. i.e. people, items.</p>                      </td>                      <td class="code">                          <div class="highlight"><pre>        <span class="nv">getItemType: </span><span class="p">()</span> <span class="o">=&gt;</span>
            <span class="nv">itemType = </span><span class="nb">window</span><span class="p">.</span><span class="nx">Settings</span><span class="p">.</span><span class="nx">itemType</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">if</span> <span class="nb">window</span><span class="p">.</span><span class="nx">collection</span><span class="p">.</span><span class="nx">length</span> <span class="o">is</span> <span class="mi">1</span>
                <span class="nv">itemType = </span><span class="nb">window</span><span class="p">.</span><span class="nx">Settings</span><span class="p">.</span><span class="nx">itemType</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">return</span> <span class="nx">itemType</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-103">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-103">&#182;</a>                          </div>                          <p>Utility to determine if the given category for a item is listed in
the predefined categories or not. It is not about felines!</p>                      </td>                      <td class="code">                          <div class="highlight"><pre>        <span class="nv">isCatInCats: </span><span class="p">(</span><span class="nx">cat</span><span class="p">,</span> <span class="nx">cats</span><span class="p">)</span> <span class="o">=&gt;</span>
            <span class="k">return</span> <span class="kc">yes</span> <span class="nx">unless</span> <span class="nx">cats</span><span class="p">[</span><span class="nx">cat</span><span class="p">]</span> <span class="o">is</span> <span class="kc">undefined</span> <span class="o">or</span> <span class="nx">cats</span><span class="p">[</span><span class="nx">cat</span><span class="p">]</span> <span class="o">is</span> <span class="kc">null</span>
            <span class="k">return</span> <span class="kc">no</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-104">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-104">&#182;</a>                          </div>                          <p>After a change in the collection, re-selects items that remained</p>                      </td>                      <td class="code">                          <div class="highlight"><pre>        <span class="nv">updateSelection: </span><span class="p">()</span> <span class="o">=&gt;</span>
            <span class="nx">@hideLoadingAnimation</span><span class="p">()</span>
            <span class="k">return</span> <span class="nx">unless</span> <span class="nx">@itemSelection</span><span class="p">.</span><span class="nx">length</span>
            <span class="k">return</span> <span class="k">if</span> <span class="nb">window</span><span class="p">.</span><span class="nx">profileView</span>
            <span class="k">if</span> <span class="nx">@itemSelection</span><span class="p">.</span><span class="nx">length</span> <span class="o">and</span> <span class="nb">window</span><span class="p">.</span><span class="nx">groupView</span>
                <span class="k">return</span> <span class="nx">@showGroupView</span><span class="p">()</span>
            <span class="nb">window</span><span class="p">.</span><span class="nx">groupView</span><span class="o">?</span><span class="p">.</span><span class="nx">destroy</span><span class="p">()</span>
            <span class="nx">@clearSelection</span><span class="p">()</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-105">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-105">&#182;</a>                          </div>                          <p>Deselect all items and clear selection array</p>                      </td>                      <td class="code">                          <div class="highlight"><pre>        <span class="nv">clearSelection: </span><span class="p">()</span> <span class="o">=&gt;</span>
            <span class="nx">$</span><span class="p">(</span><span class="s">&#39;.active&#39;</span><span class="p">,</span> <span class="s">&#39;#items&#39;</span><span class="p">).</span><span class="nx">removeClass</span> <span class="s">&#39;active&#39;</span>
            <span class="vi">@itemSelection = </span><span class="k">new</span> <span class="nb">window</span><span class="p">.</span><span class="nx">Collection</span>
            <span class="nx">@navigate</span><span class="p">()</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-106">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-106">&#182;</a>                          </div>                          <p>Check if admin key is present in QS</p>                      </td>                      <td class="code">                          <div class="highlight"><pre>        <span class="nv">isAdmin: </span><span class="p">()</span> <span class="o">=&gt;</span>
            <span class="k">return</span> <span class="kc">yes</span> <span class="k">if</span> <span class="nb">window</span><span class="p">.</span><span class="nx">Settings</span><span class="p">.</span><span class="nx">editable</span> <span class="o">is</span> <span class="kc">true</span>
            <span class="nv">qs = </span><span class="nb">window</span><span class="p">.</span><span class="nx">location</span><span class="p">.</span><span class="nx">search</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s">&#39;?&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">new</span> <span class="nb">RegExp</span><span class="p">(</span><span class="s">&#39;admin=&#39;</span><span class="p">).</span><span class="nx">test</span> <span class="nx">qs</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-107">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-107">&#182;</a>                          </div>                          <p>Check if the entity is editable</p>                      </td>                      <td class="code">                          <div class="highlight"><pre>        <span class="nv">isEditable: </span><span class="p">()</span> <span class="o">=&gt;</span>
            <span class="k">return</span> <span class="kc">yes</span> <span class="k">if</span> <span class="nb">window</span><span class="p">.</span><span class="nx">Settings</span><span class="p">.</span><span class="nx">editable</span> <span class="o">isnt</span> <span class="kc">false</span>
            <span class="kc">no</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-108">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-108">&#182;</a>                          </div>                          <p>Set browsers URL to point to the current application state</p>                      </td>                      <td class="code">                          <div class="highlight"><pre>        <span class="nv">navigate: </span><span class="p">(</span><span class="nx">attr</span><span class="p">)</span> <span class="o">=&gt;</span>
            <span class="nv">url = </span> <span class="s">&#39;qs/?&#39;</span> <span class="o">+</span> <span class="nx">@navigateURL</span><span class="p">().</span><span class="nx">join</span><span class="p">(</span><span class="s">&#39;&amp;&#39;</span><span class="p">)</span>
            <span class="nx">@router</span><span class="p">.</span><span class="nx">navigate</span> <span class="nx">url</span><span class="p">,</span> <span class="nx">attr</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-109">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-109">&#182;</a>                          </div>                          <p>Form QS from current application state</p>                      </td>                      <td class="code">                          <div class="highlight"><pre>        <span class="nv">navigateURL: </span><span class="p">()</span> <span class="o">=&gt;</span>
            <span class="nv">page = </span><span class="nb">window</span><span class="p">.</span><span class="nx">collection</span><span class="p">.</span><span class="nx">page</span>
            <span class="nv">rows = </span><span class="nb">window</span><span class="p">.</span><span class="nx">collection</span><span class="p">.</span><span class="nx">rows</span>
            <span class="nv">sort = </span><span class="nb">window</span><span class="p">.</span><span class="nx">collection</span><span class="p">.</span><span class="nx">sort</span>
            <span class="nv">nav = </span><span class="p">[</span><span class="s">&quot;page=</span><span class="si">#{</span><span class="nx">page</span><span class="si">}</span><span class="s">&amp;rows=</span><span class="si">#{</span><span class="nx">rows</span><span class="si">}</span><span class="s">&amp;sort=</span><span class="si">#{</span><span class="nx">sort</span><span class="si">}</span><span class="s">&quot;</span><span class="p">]</span>
            <span class="nv">id = </span><span class="s">&#39;&#39;</span>
            <span class="nv">fs = </span><span class="s">&#39;&#39;</span>
            <span class="nv">search = </span><span class="s">&#39;&#39;</span>

            <span class="nx">@setWindowTitle</span><span class="p">()</span>

            <span class="k">if</span> <span class="nx">@filterSelection</span><span class="p">.</span><span class="nx">get</span><span class="p">().</span><span class="nx">length</span>
                <span class="nv">f = </span><span class="p">[]</span>
                <span class="nx">_</span><span class="p">.</span><span class="nx">each</span> <span class="nx">@filterSelection</span><span class="p">.</span><span class="nx">get</span><span class="p">(),</span> <span class="nf">(facet) -&gt;</span>
                    <span class="nv">cat = </span><span class="nb">encodeURIComponent</span> <span class="nx">facet</span><span class="p">.</span><span class="nx">cat</span>
                    <span class="nv">field = </span><span class="nb">encodeURIComponent</span> <span class="nx">facet</span><span class="p">.</span><span class="nx">field</span>
                    <span class="nx">f</span><span class="p">.</span><span class="nx">push</span> <span class="s">&quot;</span><span class="si">#{</span><span class="nx">cat</span><span class="si">}</span><span class="s">:</span><span class="si">#{</span><span class="nx">field</span><span class="si">}</span><span class="s">&quot;</span>
                <span class="nv">fs = </span><span class="s">&#39;fs=&#39;</span> <span class="o">+</span> <span class="nx">f</span><span class="p">.</span><span class="nx">join</span> <span class="s">&#39;|&#39;</span>

                <span class="nx">@setWindowTitle</span> <span class="s">&quot;</span><span class="si">#{</span><span class="nx">f</span><span class="p">.</span><span class="nx">join</span><span class="p">()</span><span class="si">}</span><span class="s">&quot;</span>

            <span class="k">if</span> <span class="nb">window</span><span class="p">.</span><span class="nx">profileView</span>
                <span class="nv">id = </span><span class="nb">window</span><span class="p">.</span><span class="nx">profileView</span><span class="p">.</span><span class="nx">model</span><span class="p">.</span><span class="nx">id</span> <span class="o">||</span> <span class="s">&#39;new&#39;</span>
                <span class="nx">@setWindowTitle</span> <span class="nb">window</span><span class="p">.</span><span class="nx">profileView</span><span class="p">.</span><span class="nx">model</span><span class="o">?</span><span class="p">.</span><span class="nx">getTitle</span><span class="p">()</span>

            <span class="k">else</span> <span class="k">if</span> <span class="nb">window</span><span class="p">.</span><span class="nx">groupView</span>
                <span class="nv">id = </span><span class="p">[]</span>
                <span class="nx">@itemSelection</span><span class="p">.</span><span class="nx">each</span> <span class="p">(</span><span class="nx">m</span><span class="p">)</span> <span class="o">=&gt;</span>
                    <span class="nx">id</span><span class="p">.</span><span class="nx">push</span> <span class="nx">m</span><span class="p">.</span><span class="nx">get</span> <span class="s">&#39;id&#39;</span>
                <span class="nv">id = </span><span class="nx">id</span><span class="p">.</span><span class="nx">join</span> <span class="s">&#39;|&#39;</span>
                <span class="k">if</span> <span class="nx">@itemSelection</span><span class="p">.</span><span class="nx">length</span> <span class="o">is</span> <span class="mi">1</span>
                    <span class="nv">id = </span><span class="s">&#39;|&#39;</span> <span class="o">+</span> <span class="nx">@itemSelection</span><span class="p">.</span><span class="nx">models</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">id</span>
                <span class="nx">@setWindowTitle</span> <span class="s">&quot;Group&quot;</span>

            <span class="nv">search = </span><span class="nx">$</span><span class="p">(</span><span class="s">&#39;#inputSearch&#39;</span><span class="p">).</span><span class="nx">val</span><span class="p">().</span><span class="nx">toLowerCase</span><span class="p">()</span>

            <span class="nx">nav</span><span class="p">.</span><span class="nx">push</span> <span class="s">&quot;id=</span><span class="si">#{</span><span class="nx">id</span><span class="si">}</span><span class="s">&quot;</span> <span class="k">if</span> <span class="nx">id</span>
            <span class="nx">nav</span><span class="p">.</span><span class="nx">push</span> <span class="nx">fs</span> <span class="k">if</span> <span class="nx">fs</span>
            <span class="k">if</span> <span class="nb">window</span><span class="p">.</span><span class="nx">Settings</span><span class="p">.</span><span class="nx">view</span> <span class="o">isnt</span> <span class="s">&quot;list&quot;</span>
                <span class="nx">nav</span><span class="p">.</span><span class="nx">push</span> <span class="s">&quot;view=</span><span class="si">#{</span><span class="nb">window</span><span class="p">.</span><span class="nx">Settings</span><span class="p">.</span><span class="nx">view</span><span class="si">}</span><span class="s">&quot;</span>
            <span class="nx">nav</span><span class="p">.</span><span class="nx">push</span> <span class="s">&quot;s=</span><span class="si">#{</span><span class="nb">encodeURI</span><span class="p">(</span><span class="nx">search</span><span class="p">)</span><span class="si">}</span><span class="s">&quot;</span> <span class="k">if</span> <span class="nx">search</span>

            <span class="nx">nav</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-110">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-110">&#182;</a>                          </div>                          <p>Item selection by using arrow keys.</p>                      </td>                      <td class="code">                          <div class="highlight"><pre>        <span class="nv">setMoveKeybindings: </span><span class="p">()</span> <span class="o">=&gt;</span>
            <span class="nx">@unsetMoveKeybindings</span><span class="p">()</span>
            <span class="nx">$</span><span class="p">(</span><span class="s">&#39;body&#39;</span><span class="p">).</span><span class="nx">keyup</span> <span class="nx">@arrowUp</span>
            <span class="nx">$</span><span class="p">(</span><span class="s">&#39;body&#39;</span><span class="p">).</span><span class="nx">keydown</span>  <span class="nx">@arrowDown</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-111">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-111">&#182;</a>                          </div>                          <p>Unbind to stop responding to keypress events for movement</p>                      </td>                      <td class="code">                          <div class="highlight"><pre>        <span class="nv">unsetMoveKeybindings: </span><span class="p">()</span> <span class="o">=&gt;</span>
            <span class="nx">$</span><span class="p">(</span><span class="s">&#39;body&#39;</span><span class="p">).</span><span class="nx">unbind</span> <span class="s">&#39;keyup&#39;</span><span class="p">,</span> <span class="nx">@arrowUp</span>
            <span class="nx">$</span><span class="p">(</span><span class="s">&#39;body&#39;</span><span class="p">).</span><span class="nx">unbind</span> <span class="s">&#39;keydown&#39;</span><span class="p">,</span> <span class="nx">@arrowDown</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-112">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-112">&#182;</a>                          </div>                          <p>Select item above currently selected item</p>                      </td>                      <td class="code">                          <div class="highlight"><pre>        <span class="nv">arrowUp: </span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="o">=&gt;</span>
            <span class="vi">@app = </span><span class="nb">window</span><span class="p">.</span><span class="nx">App</span>
            <span class="nv">selectedId = </span><span class="nx">@app</span><span class="p">.</span><span class="nx">itemSelection</span><span class="o">?</span><span class="p">.</span><span class="nx">models</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">?</span><span class="p">.</span><span class="nx">id</span>
            <span class="nv">elem = </span><span class="nx">$</span><span class="p">(</span><span class="s">&quot;</span><span class="err">#</span><span class="si">#{</span><span class="nx">selectedId</span><span class="si">}</span><span class="s">&quot;</span><span class="p">,</span> <span class="s">&#39;#items&#39;</span><span class="p">)</span>
            <span class="k">if</span>  <span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">which</span> <span class="o">is</span> <span class="mi">37</span> <span class="o">or</span> <span class="nx">e</span><span class="p">.</span><span class="nx">which</span> <span class="o">is</span> <span class="mi">38</span><span class="p">)</span> <span class="o">and</span> <span class="nx">elem</span><span class="p">.</span><span class="nx">prev</span><span class="p">().</span><span class="nx">length</span>
                <span class="nx">@app</span><span class="p">.</span><span class="nx">selectOne</span> <span class="nx">$</span><span class="p">(</span><span class="s">&quot;</span><span class="err">#</span><span class="si">#{</span><span class="nx">selectedId</span><span class="si">}</span><span class="s">&quot;</span><span class="p">,</span> <span class="s">&#39;#items&#39;</span><span class="p">)</span>
                    <span class="p">.</span><span class="nx">prev</span><span class="p">()</span>
            <span class="k">if</span>  <span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">which</span> <span class="o">is</span> <span class="mi">39</span> <span class="o">or</span> <span class="nx">e</span><span class="p">.</span><span class="nx">which</span> <span class="o">is</span> <span class="mi">40</span><span class="p">)</span> <span class="o">and</span> <span class="nx">elem</span><span class="p">.</span><span class="nx">next</span><span class="p">().</span><span class="nx">length</span>
                <span class="nx">@app</span><span class="p">.</span><span class="nx">selectOne</span> <span class="nx">$</span><span class="p">(</span><span class="s">&quot;</span><span class="err">#</span><span class="si">#{</span><span class="nx">selectedId</span><span class="si">}</span><span class="s">&quot;</span><span class="p">,</span> <span class="s">&#39;#items&#39;</span><span class="p">)</span>
                    <span class="p">.</span><span class="nx">next</span><span class="p">()</span>
            <span class="nx">@app</span><span class="p">.</span><span class="nx">navigate</span><span class="p">()</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-113">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-113">&#182;</a>                          </div>                          <p>Select item below currently selected item</p>                      </td>                      <td class="code">                          <div class="highlight"><pre>        <span class="nv">arrowDown: </span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="o">=&gt;</span>
            <span class="vi">@app = </span><span class="nb">window</span><span class="p">.</span><span class="nx">App</span>
            <span class="k">return</span> <span class="nx">unless</span> <span class="nx">@app</span><span class="p">.</span><span class="nx">itemSelection</span><span class="p">.</span><span class="nx">length</span>
            <span class="k">return</span> <span class="kc">false</span> <span class="k">if</span> <span class="nx">e</span><span class="p">.</span><span class="nx">which</span> <span class="o">&gt;=</span> <span class="mi">37</span> <span class="o">&amp;&amp;</span> <span class="nx">e</span><span class="p">.</span><span class="nx">which</span> <span class="o">&lt;=</span> <span class="mi">40</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-114">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-114">&#182;</a>                          </div>                          <p>Show a loading wheel in the middle of the items container, if the
items havent been rendered after 1 second</p>                      </td>                      <td class="code">                          <div class="highlight"><pre>        <span class="nv">showLoadingAnimation: </span><span class="p">()</span> <span class="o">=&gt;</span>
            <span class="k">return</span> <span class="k">if</span> <span class="nx">@loadingAnimation</span>
            <span class="vi">@loadingAnimation = </span><span class="nx">setTimeout</span> <span class="p">()</span> <span class="o">=&gt;</span>
                <span class="nx">$</span><span class="p">(</span><span class="s">&#39;span#loading&#39;</span><span class="p">).</span><span class="nx">show</span><span class="p">()</span>
              <span class="p">,</span>
                <span class="mi">1000</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-115">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-115">&#182;</a>                          </div>                          <p>Display error icon on controls section (top right corner)</p>                      </td>                      <td class="code">                          <div class="highlight"><pre>        <span class="nv">showError: </span><span class="p">()</span> <span class="o">=&gt;</span>
            <span class="nx">@hideLoadingAnimation</span><span class="p">()</span>
            <span class="nx">$</span><span class="p">(</span><span class="s">&#39;span#error&#39;</span><span class="p">).</span><span class="nx">show</span><span class="p">()</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-116">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-116">&#182;</a>                          </div>                          <p>Hide error icon</p>                      </td>                      <td class="code">                          <div class="highlight"><pre>        <span class="nv">hideError: </span><span class="p">()</span> <span class="o">=&gt;</span>
            <span class="nx">$</span><span class="p">(</span><span class="s">&#39;span#error&#39;</span><span class="p">).</span><span class="nx">hide</span><span class="p">()</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-117">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-117">&#182;</a>                          </div>                          <p>Hide the loading animation wheel</p>                      </td>                      <td class="code">                          <div class="highlight"><pre>        <span class="nv">hideLoadingAnimation: </span><span class="p">()</span> <span class="o">=&gt;</span>
            <span class="nx">clearTimeout</span> <span class="nx">@loadingAnimation</span>
            <span class="vi">@loadingAnimation = </span><span class="kc">null</span>
            <span class="nx">$</span><span class="p">(</span><span class="s">&#39;span#loading&#39;</span><span class="p">).</span><span class="nx">hide</span><span class="p">()</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-118">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-118">&#182;</a>                          </div>                          <p>Parses a given Date into a readable formatted string (DD MMMM YYYY)</p>                      </td>                      <td class="code">                          <div class="highlight"><pre>        <span class="nv">formatDate: </span><span class="p">(</span><span class="nx">date</span><span class="p">)</span> <span class="o">=&gt;</span>
            <span class="k">if</span> <span class="k">typeof</span> <span class="nx">date</span> <span class="o">is</span> <span class="k">typeof</span> <span class="p">[]</span> <span class="k">then</span> <span class="nv">date = </span><span class="nx">date</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">return</span> <span class="s">&#39;&#39;</span> <span class="nx">unless</span> <span class="nx">date</span>
            <span class="nv">monthNames = </span><span class="p">[</span> <span class="s">&quot;Jan&quot;</span><span class="p">,</span> <span class="s">&quot;Feb&quot;</span><span class="p">,</span> <span class="s">&quot;Mar&quot;</span><span class="p">,</span> <span class="s">&quot;Apr&quot;</span><span class="p">,</span> <span class="s">&quot;May&quot;</span><span class="p">,</span> <span class="s">&quot;Jun&quot;</span><span class="p">,</span> <span class="s">&quot;Jul&quot;</span><span class="p">,</span>
                <span class="s">&quot;Aug&quot;</span><span class="p">,</span> <span class="s">&quot;Sep&quot;</span><span class="p">,</span> <span class="s">&quot;Oct&quot;</span><span class="p">,</span> <span class="s">&quot;Nov&quot;</span><span class="p">,</span> <span class="s">&quot;Dec&quot;</span> <span class="p">]</span>
            <span class="nv">d = </span><span class="k">new</span> <span class="nb">Date</span> <span class="nx">date</span>
            <span class="nv">d = </span><span class="p">[</span>
                <span class="nx">d</span><span class="p">.</span><span class="nx">getDate</span><span class="p">(),</span> <span class="nx">monthNames</span><span class="p">[</span><span class="nx">d</span><span class="p">.</span><span class="nx">getMonth</span><span class="p">()],</span> <span class="nx">d</span><span class="p">.</span><span class="nx">getFullYear</span><span class="p">()</span>
            <span class="p">]</span>
            <span class="nx">d</span><span class="p">.</span><span class="nx">join</span> <span class="s">&#39; &#39;</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-119">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-119">&#182;</a>                          </div>                          <p>Show print view on a new window/ab</p>                      </td>                      <td class="code">                          <div class="highlight"><pre>        <span class="nv">print: </span><span class="p">()</span> <span class="o">=&gt;</span>
            <span class="nv">url = </span><span class="p">[</span> <span class="s">&quot;page=</span><span class="si">#{</span><span class="nb">window</span><span class="p">.</span><span class="nx">collection</span><span class="p">.</span><span class="nx">page</span><span class="si">}</span><span class="s">&quot;</span> <span class="p">]</span>
            <span class="nx">url</span><span class="p">.</span><span class="nx">push</span> <span class="s">&quot;rows=</span><span class="si">#{</span><span class="nb">window</span><span class="p">.</span><span class="nx">collection</span><span class="p">.</span><span class="nx">total</span><span class="si">}</span><span class="s">&quot;</span>
            <span class="k">if</span> <span class="nb">window</span><span class="p">.</span><span class="nx">profileView</span>
                <span class="nx">url</span><span class="p">.</span><span class="nx">push</span> <span class="s">&quot;id=</span><span class="si">#{</span><span class="nb">window</span><span class="p">.</span><span class="nx">profileView</span><span class="p">.</span><span class="nx">model</span><span class="p">.</span><span class="nx">id</span><span class="si">}</span><span class="s">&quot;</span>
            <span class="k">if</span> <span class="nb">window</span><span class="p">.</span><span class="nx">groupView</span>
                <span class="nv">ids = </span><span class="p">[]</span>
                <span class="nb">window</span><span class="p">.</span><span class="nx">App</span><span class="p">.</span><span class="nx">itemSelection</span><span class="p">.</span><span class="nx">each</span> <span class="p">(</span><span class="nx">m</span><span class="p">)</span> <span class="o">=&gt;</span>
                    <span class="nx">ids</span><span class="p">.</span><span class="nx">push</span> <span class="nx">m</span><span class="p">.</span><span class="nx">get</span> <span class="s">&#39;id&#39;</span>
                <span class="nx">url</span><span class="p">.</span><span class="nx">push</span> <span class="s">&quot;id=</span><span class="si">#{</span><span class="nx">ids</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s">&#39;|&#39;</span><span class="p">)</span><span class="si">}</span><span class="s">&quot;</span>
            <span class="nv">url = </span><span class="nx">url</span><span class="p">.</span><span class="nx">join</span> <span class="s">&#39;&amp;&#39;</span>
            <span class="nb">window</span><span class="p">.</span><span class="nx">open</span> <span class="s">&#39;print?&#39;</span> <span class="o">+</span> <span class="nx">url</span><span class="p">,</span> <span class="s">&#39;_blank&#39;</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-120">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-120">&#182;</a>                          </div>                          <p>Export items to json on a new tab</p>                      </td>                      <td class="code">                          <div class="highlight"><pre>        <span class="nv">toJson: </span><span class="p">()</span> <span class="o">=&gt;</span>
            <span class="nv">url = </span><span class="s">&quot;</span><span class="si">#{</span><span class="nx">@commonURL</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">window</span><span class="p">.</span><span class="nx">collection</span><span class="p">.</span><span class="nx">total</span><span class="p">)</span><span class="si">}</span><span class="s">&quot;</span>

            <span class="k">if</span> <span class="nx">@getFilterQS</span><span class="p">().</span><span class="nx">fs</span><span class="p">.</span><span class="nx">length</span>
                <span class="nx">url</span> <span class="o">+=</span> <span class="s">&#39;?&#39;</span>
                <span class="nx">_</span><span class="p">.</span><span class="nx">each</span> <span class="nx">@getFilterQS</span><span class="p">().</span><span class="nx">fs</span><span class="p">,</span> <span class="p">(</span><span class="nx">f</span><span class="p">)</span> <span class="o">=&gt;</span>
                    <span class="nx">url</span> <span class="o">+=</span> <span class="s">&quot;&amp;fs=</span><span class="si">#{</span><span class="nx">f</span><span class="si">}</span><span class="s">&quot;</span>

            <span class="nx">url</span> <span class="o">+=</span> <span class="s">&quot;&amp;json=true&quot;</span>

            <span class="k">if</span> <span class="nb">window</span><span class="p">.</span><span class="nx">profileView</span>
                <span class="nv">url = </span><span class="s">&quot;collection/</span><span class="si">#{</span><span class="nb">window</span><span class="p">.</span><span class="nx">profileView</span><span class="p">.</span><span class="nx">model</span><span class="p">.</span><span class="nx">id</span><span class="si">}</span><span class="s">&quot;</span>
            <span class="k">if</span> <span class="nb">window</span><span class="p">.</span><span class="nx">groupView</span>
                <span class="nv">ids = </span><span class="p">[]</span>
                <span class="nb">window</span><span class="p">.</span><span class="nx">App</span><span class="p">.</span><span class="nx">itemSelection</span><span class="p">.</span><span class="nx">each</span> <span class="p">(</span><span class="nx">m</span><span class="p">)</span> <span class="o">=&gt;</span>
                    <span class="nx">ids</span><span class="p">.</span><span class="nx">push</span> <span class="nx">m</span><span class="p">.</span><span class="nx">get</span> <span class="s">&#39;id&#39;</span>
                <span class="nv">ids = </span><span class="nx">ids</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s">&#39;|&#39;</span><span class="p">)</span>
                <span class="nv">url = </span><span class="s">&quot;collection/</span><span class="si">#{</span><span class="nx">ids</span><span class="si">}</span><span class="s">&quot;</span>

            <span class="nb">window</span><span class="p">.</span><span class="nx">open</span> <span class="nx">url</span><span class="p">,</span> <span class="s">&#39;_blank&#39;</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-121">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-121">&#182;</a>                          </div>                          <p>Hide facets container on the left</p>                      </td>                      <td class="code">                          <div class="highlight"><pre>        <span class="nv">disableFacets: </span><span class="nf">() -&gt;</span>
            <span class="nx">$</span><span class="p">(</span><span class="s">&#39;#index&#39;</span><span class="p">).</span><span class="nx">hide</span><span class="p">()</span>
            <span class="nx">$</span><span class="p">(</span><span class="s">&#39;#content&#39;</span><span class="p">).</span><span class="nx">addClass</span> <span class="s">&#39;noFacets&#39;</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-122">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-122">&#182;</a>                          </div>                          <p>Create the entities menu</p>                      </td>                      <td class="code">                          <div class="highlight"><pre>        <span class="nv">generateEntitiesMenu: </span><span class="nf">() -&gt;</span>
            <span class="nx">_</span><span class="p">.</span><span class="nx">each</span> <span class="nb">window</span><span class="p">.</span><span class="nx">Settings</span><span class="p">.</span><span class="nx">entities</span><span class="p">,</span> <span class="nf">(e) -&gt;</span>
                <span class="k">return</span> <span class="k">if</span> <span class="nx">e</span> <span class="o">is</span> <span class="nb">window</span><span class="p">.</span><span class="nx">Settings</span><span class="p">.</span><span class="nx">entity</span>
                <span class="nv">o = </span><span class="s">&quot;&lt;li id=&#39;</span><span class="si">#{</span><span class="nx">e</span><span class="si">}</span><span class="s">&#39;&gt;&lt;span&gt;</span><span class="si">#{</span><span class="nx">e</span><span class="si">}</span><span class="s">&lt;/span&gt;&lt;/li&gt;&quot;</span>
                <span class="nx">$</span><span class="p">(</span><span class="s">&quot;</span><span class="err">#</span><span class="s">entities ul&quot;</span><span class="p">,</span> <span class="s">&quot;</span><span class="err">#</span><span class="s">header&quot;</span><span class="p">).</span><span class="nx">append</span> <span class="nx">o</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-123">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-123">&#182;</a>                          </div>                          <p>Redirect to an entity (i.e. from entities menu)</p>                      </td>                      <td class="code">                          <div class="highlight"><pre>        <span class="nv">redirectToEntity: </span><span class="nf">(e) -&gt;</span>
            <span class="nv">entity = </span><span class="nx">$</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">currentTarget</span><span class="p">).</span><span class="nx">attr</span> <span class="s">&#39;id&#39;</span>
            <span class="nv">adminKey = </span><span class="k">if</span> <span class="nx">@isAdmin</span><span class="p">()</span> <span class="k">then</span> <span class="s">&quot;?admin=yes&quot;</span> <span class="k">else</span> <span class="s">&#39;&#39;</span>
            <span class="nb">window</span><span class="p">.</span><span class="nv">location = </span><span class="s">&quot;/</span><span class="si">#{</span><span class="nx">entity</span><span class="si">}</span><span class="s">/</span><span class="si">#{</span><span class="nx">adminKey</span><span class="si">}</span><span class="s">&quot;</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-124">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-124">&#182;</a>                          </div>                          <p>Create the columns menu</p>                      </td>                      <td class="code">                          <div class="highlight"><pre>        <span class="nv">generateColumnsMenu: </span><span class="nf">() -&gt;</span>
            <span class="nv">template = </span><span class="nx">_</span><span class="p">.</span><span class="nx">template</span> <span class="nx">$</span><span class="p">(</span><span class="s">&#39;#columns-menu-template&#39;</span><span class="p">).</span><span class="nx">html</span><span class="p">()</span>
            <span class="nx">_</span><span class="p">.</span><span class="nx">each</span> <span class="nb">window</span><span class="p">.</span><span class="nx">Settings</span><span class="p">.</span><span class="nx">Schema</span><span class="p">.</span><span class="nx">get</span><span class="p">(),</span> <span class="p">(</span><span class="nx">field</span><span class="p">)</span> <span class="o">=&gt;</span>
                <span class="nx">$</span><span class="p">(</span><span class="s">&#39;#columnOptions ul&#39;</span><span class="p">).</span><span class="nx">append</span> <span class="nx">template</span> <span class="nv">field: </span><span class="nx">field</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-125">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-125">&#182;</a>                          </div>                          <p>Open/Close entities menu</p>                      </td>                      <td class="code">                          <div class="highlight"><pre>        <span class="nv">toggleEntitiesMenu: </span><span class="nf">(e) -&gt;</span>
            <span class="nx">e</span><span class="p">.</span><span class="nx">stopPropagation</span><span class="p">()</span>
            <span class="k">return</span> <span class="nx">unless</span> <span class="nb">window</span><span class="p">.</span><span class="nx">Settings</span><span class="p">.</span><span class="nx">entities</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="mi">1</span>
            <span class="nx">$</span><span class="p">(</span><span class="s">&#39;#entityTitle&#39;</span><span class="p">,</span> <span class="s">&#39;#header&#39;</span><span class="p">).</span><span class="nx">toggleClass</span> <span class="s">&#39;active&#39;</span>
            <span class="nx">$</span><span class="p">(</span><span class="s">&quot;</span><span class="err">#</span><span class="s">entities&quot;</span><span class="p">,</span> <span class="s">&quot;</span><span class="err">#</span><span class="s">header&quot;</span><span class="p">).</span><span class="nx">toggle</span><span class="p">()</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-126">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-126">&#182;</a>                          </div>                          <p>Hide entities menu</p>                      </td>                      <td class="code">                          <div class="highlight"><pre>        <span class="nv">hideEntitiesMenu: </span><span class="nf">(e) -&gt;</span>
            <span class="nx">$</span><span class="p">(</span><span class="s">&#39;#entityTitle&#39;</span><span class="p">,</span> <span class="s">&#39;#header&#39;</span><span class="p">).</span><span class="nx">removeClass</span> <span class="s">&#39;active&#39;</span>
            <span class="nx">$</span><span class="p">(</span><span class="s">&#39;#entities&#39;</span><span class="p">,</span> <span class="s">&#39;#header&#39;</span><span class="p">).</span><span class="nx">hide</span><span class="p">()</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-127">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-127">&#182;</a>                          </div>                          <p>Show columns button on top right corner of table view</p>                      </td>                      <td class="code">                          <div class="highlight"><pre>        <span class="nv">showColumnsBtn: </span><span class="nf">(e) -&gt;</span>
            <span class="nx">$</span><span class="p">(</span><span class="s">&#39;#columnsMenu&#39;</span><span class="p">).</span><span class="nx">show</span><span class="p">()</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-128">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-128">&#182;</a>                          </div>                          <p>Hide columns button</p>                      </td>                      <td class="code">                          <div class="highlight"><pre>        <span class="nv">hideColumnsBtn: </span><span class="nf">(e) -&gt;</span>
            <span class="k">return</span> <span class="k">if</span> <span class="nx">$</span><span class="p">(</span><span class="s">&#39;#columnOptions&#39;</span><span class="p">).</span><span class="nx">css</span><span class="p">(</span><span class="s">&#39;display&#39;</span><span class="p">)</span> <span class="o">is</span> <span class="s">&#39;block&#39;</span>
            <span class="nx">$</span><span class="p">(</span><span class="s">&#39;#columnsMenu&#39;</span><span class="p">).</span><span class="nx">hide</span><span class="p">()</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-129">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-129">&#182;</a>                          </div>                          <p>hover on columns menu</p>                      </td>                      <td class="code">                          <div class="highlight"><pre>        <span class="nv">overColumnsMenu: </span><span class="nf">(e) -&gt;</span>
            <span class="nx">$</span><span class="p">(</span><span class="s">&#39;#columnsMenu&#39;</span><span class="p">).</span><span class="nx">show</span><span class="p">()</span>
            <span class="nx">e</span><span class="p">.</span><span class="nx">stopPropagation</span><span class="p">()</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-130">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-130">&#182;</a>                          </div>                          <p>Open/Close columns menu</p>                      </td>                      <td class="code">                          <div class="highlight"><pre>        <span class="nv">toggleColumnsMenu: </span><span class="nf">(e) -&gt;</span>
            <span class="nx">e</span><span class="p">.</span><span class="nx">stopPropagation</span><span class="p">()</span>
            <span class="nx">$</span><span class="p">(</span><span class="s">&#39;#columnOptions&#39;</span><span class="p">).</span><span class="nx">toggle</span><span class="p">()</span>
            <span class="nx">$</span><span class="p">(</span><span class="s">&#39;#columnsMenu&#39;</span><span class="p">).</span><span class="nx">toggleClass</span> <span class="s">&#39;active&#39;</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-131">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-131">&#182;</a>                          </div>                          <p>Show/hide a column from the table</p>                      </td>                      <td class="code">                          <div class="highlight"><pre>        <span class="nv">toggleColumnVisibility: </span><span class="nf">(e) -&gt;</span>
            <span class="nx">e</span><span class="p">.</span><span class="nx">stopPropagation</span><span class="p">()</span>
            <span class="nv">$e = </span><span class="nx">$</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">currentTarget</span><span class="p">)</span>
            <span class="nv">id = </span><span class="nx">$e</span><span class="p">.</span><span class="nx">attr</span> <span class="s">&#39;id&#39;</span>
            <span class="k">if</span> <span class="nx">$e</span><span class="p">.</span><span class="nx">hasClass</span> <span class="s">&#39;active&#39;</span>
                <span class="nx">_</span><span class="p">.</span><span class="nx">each</span> <span class="nb">window</span><span class="p">.</span><span class="nx">Settings</span><span class="p">.</span><span class="nx">Schema</span><span class="p">.</span><span class="nx">get</span><span class="p">(),</span> <span class="p">(</span><span class="nx">f</span><span class="p">)</span> <span class="o">=&gt;</span>
                    <span class="k">if</span> <span class="nx">f</span><span class="p">.</span><span class="nx">id</span> <span class="o">is</span> <span class="nx">id</span> <span class="k">then</span> <span class="nv">f.index = </span><span class="kc">false</span>
                <span class="nx">$e</span><span class="p">.</span><span class="nx">removeClass</span> <span class="s">&#39;active&#39;</span>
                <span class="nx">@saveColumnSelection</span><span class="p">()</span>
                <span class="k">return</span> <span class="nx">@addAll</span> <span class="nb">window</span><span class="p">.</span><span class="nx">collection</span>
            <span class="nx">_</span><span class="p">.</span><span class="nx">each</span> <span class="nb">window</span><span class="p">.</span><span class="nx">Settings</span><span class="p">.</span><span class="nx">Schema</span><span class="p">.</span><span class="nx">get</span><span class="p">(),</span> <span class="p">(</span><span class="nx">f</span><span class="p">)</span> <span class="o">=&gt;</span>
                <span class="k">if</span> <span class="nx">f</span><span class="p">.</span><span class="nx">id</span> <span class="o">is</span> <span class="nx">id</span> <span class="k">then</span> <span class="nv">f.index = </span><span class="kc">true</span>
            <span class="nx">$e</span><span class="p">.</span><span class="nx">addClass</span> <span class="s">&#39;active&#39;</span>
            <span class="nx">@saveColumnSelection</span><span class="p">()</span>
            <span class="nx">@addAll</span> <span class="nb">window</span><span class="p">.</span><span class="nx">collection</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-132">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-132">&#182;</a>                          </div>                          <p>Set the title for the window</p>                      </td>                      <td class="code">                          <div class="highlight"><pre>        <span class="nv">setWindowTitle: </span><span class="nf">(t) -&gt;</span>
            <span class="nv">title = </span><span class="nb">window</span><span class="p">.</span><span class="nx">Settings</span><span class="o">?</span><span class="p">.</span><span class="nx">title</span>
            <span class="nx">title</span> <span class="o">+=</span> <span class="s">&quot; - </span><span class="si">#{</span><span class="nx">t</span><span class="si">}</span><span class="s">&quot;</span> <span class="k">if</span> <span class="nx">t</span>
            <span class="nx">$</span><span class="p">(</span><span class="s">&#39;head title&#39;</span><span class="p">).</span><span class="nx">html</span> <span class="nx">title</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-133">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-133">&#182;</a>                          </div>                          <p>Set resizable handler for facet index</p>                      </td>                      <td class="code">                          <div class="highlight"><pre>        <span class="nv">setIndexResizable: </span><span class="p">()</span> <span class="o">=&gt;</span>
            <span class="nx">$</span><span class="p">(</span><span class="s">&#39;#index&#39;</span><span class="p">).</span><span class="nx">resizable</span>
                <span class="nv">handles: </span><span class="s">&#39;e&#39;</span>
                <span class="nv">resize: </span><span class="nx">@resizeIndex</span>
                <span class="nv">stop: </span><span class="nx">@saveFacetWidth</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-134">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-134">&#182;</a>                          </div>                          <p>Resize facet index</p>                      </td>                      <td class="code">                          <div class="highlight"><pre>        <span class="nv">resizeIndex: </span><span class="p">(</span><span class="nx">event</span><span class="p">,</span> <span class="nx">ui</span><span class="p">)</span> <span class="o">=&gt;</span>
            <span class="nv">width = </span><span class="nx">$</span><span class="p">(</span><span class="s">&#39;#index&#39;</span><span class="p">).</span><span class="nx">width</span><span class="p">()</span>
            <span class="nx">$</span><span class="p">(</span><span class="s">&#39;#content&#39;</span><span class="p">).</span><span class="nx">css</span> <span class="s">&#39;left&#39;</span><span class="p">,</span> <span class="nx">width</span> <span class="o">+</span> <span class="mi">21</span>
            <span class="nx">$</span><span class="p">(</span><span class="s">&#39;#footer&#39;</span><span class="p">).</span><span class="nx">css</span> <span class="s">&#39;left&#39;</span><span class="p">,</span> <span class="nx">width</span> <span class="o">+</span> <span class="mi">21</span>
            <span class="nx">$</span><span class="p">(</span><span class="s">&#39;#innerIndex&#39;</span><span class="p">).</span><span class="nx">width</span> <span class="nx">$</span><span class="p">(</span><span class="s">&#39;#index&#39;</span><span class="p">).</span><span class="nx">width</span><span class="p">()</span> <span class="o">-</span> <span class="mi">10</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-135">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-135">&#182;</a>                          </div>                          <p>Save column selection on local storage</p>                      </td>                      <td class="code">                          <div class="highlight"><pre>        <span class="nv">saveColumnSelection: </span><span class="p">()</span> <span class="o">=&gt;</span>
            <span class="nv">entity = </span><span class="nb">window</span><span class="p">.</span><span class="nx">Settings</span><span class="p">.</span><span class="nx">entity</span>
            <span class="nv">ls = </span><span class="nb">window</span><span class="p">.</span><span class="nx">localStorage</span><span class="p">[</span><span class="nx">entity</span><span class="p">]</span>
            <span class="nv">ls = </span><span class="k">if</span> <span class="nx">ls</span> <span class="k">then</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">parse</span> <span class="nx">ls</span> <span class="k">else</span> <span class="p">{}</span>
            <span class="nv">indexes = </span><span class="p">[]</span>
            <span class="nx">_</span><span class="p">.</span><span class="nx">each</span> <span class="nb">window</span><span class="p">.</span><span class="nx">Settings</span><span class="p">.</span><span class="nx">Schema</span><span class="p">.</span><span class="nx">getIndexes</span><span class="p">(),</span> <span class="nf">(s) -&gt;</span>
                <span class="nx">indexes</span><span class="p">.</span><span class="nx">push</span> <span class="nx">s</span><span class="p">.</span><span class="nx">id</span>
            <span class="nv">ls.columns = </span><span class="p">{}</span> <span class="nx">unless</span> <span class="nx">ls</span><span class="p">.</span><span class="nx">columns</span>
            <span class="nv">ls.columns = </span><span class="nx">indexes</span>
            <span class="nb">window</span><span class="p">.</span><span class="nx">localStorage</span><span class="p">[</span><span class="nx">entity</span><span class="p">]</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span> <span class="nx">ls</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-136">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-136">&#182;</a>                          </div>                          <p>Set column selection from localStorage</p>                      </td>                      <td class="code">                          <div class="highlight"><pre>        <span class="nv">setColumnSelection: </span><span class="p">()</span> <span class="o">=&gt;</span>
            <span class="nv">entity = </span><span class="nb">window</span><span class="p">.</span><span class="nx">Settings</span><span class="p">.</span><span class="nx">entity</span>
            <span class="nv">ls = </span><span class="nb">window</span><span class="p">.</span><span class="nx">localStorage</span><span class="p">[</span><span class="nx">entity</span><span class="p">]</span>
            <span class="k">return</span> <span class="nx">unless</span> <span class="nx">ls</span>
            <span class="nv">ls = </span><span class="nx">JSON</span><span class="p">.</span><span class="nx">parse</span> <span class="nx">ls</span>
            <span class="nv">columns = </span><span class="nx">ls</span><span class="p">.</span><span class="nx">columns</span>
            <span class="k">return</span> <span class="nx">unless</span> <span class="nx">ls</span><span class="p">.</span><span class="nx">columns</span>
            <span class="nx">_</span><span class="p">.</span><span class="nx">each</span> <span class="nb">window</span><span class="p">.</span><span class="nx">Settings</span><span class="p">.</span><span class="nx">Schema</span><span class="p">.</span><span class="nx">getIndexes</span><span class="p">(),</span> <span class="nf">(i) -&gt;</span>
                <span class="nv">i.index = </span><span class="kc">no</span>
            <span class="nx">_</span><span class="p">.</span><span class="nx">each</span> <span class="nx">columns</span><span class="p">,</span> <span class="nf">(c) -&gt;</span>
                <span class="nb">window</span><span class="p">.</span><span class="nx">Settings</span><span class="p">.</span><span class="nx">Schema</span><span class="p">.</span><span class="nx">getField</span> <span class="nx">c</span><span class="p">,</span> <span class="nf">(f) -&gt;</span>
                    <span class="nv">f.index = </span><span class="kc">yes</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-137">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-137">&#182;</a>                          </div>                          <p>Save width of facet index</p>                      </td>                      <td class="code">                          <div class="highlight"><pre>        <span class="nv">saveFacetWidth: </span><span class="p">(</span><span class="nx">event</span><span class="p">,</span> <span class="nx">ui</span><span class="p">)</span> <span class="o">=&gt;</span>
            <span class="nv">entity = </span><span class="nb">window</span><span class="p">.</span><span class="nx">Settings</span><span class="p">.</span><span class="nx">entity</span>
            <span class="nv">ls = </span><span class="nb">window</span><span class="p">.</span><span class="nx">localStorage</span><span class="p">[</span><span class="nx">entity</span><span class="p">]</span>
            <span class="nv">ls = </span><span class="k">if</span> <span class="nx">ls</span> <span class="k">then</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">parse</span> <span class="nx">ls</span> <span class="k">else</span> <span class="p">{}</span>
            <span class="nv">w = </span><span class="nx">$</span><span class="p">(</span><span class="s">&#39;#index&#39;</span><span class="p">).</span><span class="nx">width</span><span class="p">()</span>
            <span class="nv">ls.css = </span><span class="p">{}</span> <span class="nx">unless</span> <span class="nx">ls</span><span class="p">.</span><span class="nx">css</span>
            <span class="nx">ls</span><span class="p">.</span><span class="nx">css</span><span class="p">[</span><span class="s">&#39;facet_width&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nx">w</span>
            <span class="nb">window</span><span class="p">.</span><span class="nx">localStorage</span><span class="p">[</span><span class="nx">entity</span><span class="p">]</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span> <span class="nx">ls</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-138">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-138">&#182;</a>                          </div>                          <p>Set Facet index width from localStorage</p>                      </td>                      <td class="code">                          <div class="highlight"><pre>        <span class="nv">setFacetWidth: </span><span class="p">()</span> <span class="o">=&gt;</span>
            <span class="nv">entity = </span><span class="nb">window</span><span class="p">.</span><span class="nx">Settings</span><span class="p">.</span><span class="nx">entity</span>
            <span class="k">return</span> <span class="nx">unless</span> <span class="nb">window</span><span class="p">.</span><span class="nx">localStorage</span><span class="p">[</span><span class="nx">entity</span><span class="p">]</span>
            <span class="nv">ls = </span><span class="nx">JSON</span><span class="p">.</span><span class="nx">parse</span> <span class="nb">window</span><span class="p">.</span><span class="nx">localStorage</span><span class="p">[</span><span class="nx">entity</span><span class="p">]</span>
            <span class="nv">w = </span><span class="nb">parseFloat</span> <span class="nx">ls</span><span class="p">.</span><span class="nx">css</span><span class="o">?</span><span class="p">.</span><span class="nx">facet_width</span>
            <span class="nx">$</span><span class="p">(</span><span class="s">&#39;#index&#39;</span><span class="p">).</span><span class="nx">width</span><span class="p">(</span><span class="nx">w</span><span class="p">)</span> <span class="k">if</span> <span class="nx">w</span>
            <span class="nx">@resizeIndex</span><span class="p">()</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-139">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-139">&#182;</a>                          </div>                          <p>Get an etiquette object with its ID</p>                      </td>                      <td class="code">                          <div class="highlight"><pre>        <span class="nv">getEtiquetteById: </span><span class="p">(</span><span class="nx">id</span><span class="p">)</span> <span class="o">=&gt;</span>
            <span class="nv">etq = </span><span class="kc">null</span>
            <span class="nx">_</span><span class="p">.</span><span class="nx">each</span> <span class="nb">window</span><span class="p">.</span><span class="nx">Settings</span><span class="p">.</span><span class="nx">etiquettes</span><span class="p">,</span> <span class="nf">(e) -&gt;</span>
                <span class="k">return</span> <span class="nv">etq = </span><span class="nx">e</span> <span class="k">if</span> <span class="nx">e</span><span class="p">.</span><span class="nx">id</span> <span class="o">is</span> <span class="nx">id</span>
            <span class="nx">etq</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-140">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-140">&#182;</a>                          </div>                          <p>Get a mini etiquette for the pic in the table view</p>                      </td>                      <td class="code">                          <div class="highlight"><pre>        <span class="nv">getMiniEtiquette: </span><span class="p">(</span><span class="nx">etiquettes</span><span class="p">)</span> <span class="o">=&gt;</span>
            <span class="nv">etq = </span><span class="kc">null</span>
            <span class="nx">_</span><span class="p">.</span><span class="nx">each</span> <span class="nx">etiquettes</span><span class="p">,</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="o">=&gt;</span>
                <span class="nv">e = </span><span class="nx">@getEtiquetteById</span> <span class="nx">e</span>
                <span class="nv">etq = </span><span class="nx">e</span> <span class="nx">unless</span> <span class="nx">etq</span> <span class="o">or</span> <span class="o">!</span><span class="nx">e</span><span class="o">?</span><span class="p">.</span><span class="nx">mini</span>
            <span class="nx">etq</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-141">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-141">&#182;</a>                          </div>                          <p>Determine which etiquettes should an item have</p>                      </td>                      <td class="code">                          <div class="highlight"><pre>        <span class="nv">getItemEtiquettes: </span><span class="p">(</span><span class="nx">model</span><span class="p">)</span> <span class="o">=&gt;</span>
            <span class="k">return</span> <span class="nx">unless</span> <span class="nb">window</span><span class="p">.</span><span class="nx">Settings</span><span class="p">.</span><span class="nx">Schema</span><span class="p">.</span><span class="nx">getTuples</span><span class="p">().</span><span class="nx">length</span>
            <span class="nv">facet = </span><span class="nb">window</span><span class="p">.</span><span class="nx">App</span><span class="p">.</span><span class="nx">filterSelection</span><span class="p">.</span><span class="nx">get</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
            <span class="nv">tuple = </span><span class="nb">window</span><span class="p">.</span><span class="nx">Settings</span><span class="p">.</span><span class="nx">Schema</span><span class="p">.</span><span class="nx">getTuples</span><span class="p">()[</span><span class="mi">0</span><span class="p">].</span><span class="nx">id</span>
            <span class="p">[</span><span class="nx">team</span><span class="p">,</span> <span class="nx">role</span><span class="p">]</span> <span class="o">=</span> <span class="nx">tuple</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s">&#39;:&#39;</span><span class="p">)</span> <span class="c1">#team</span>
            <span class="nv">etiquettes = </span><span class="p">[]</span>
            <span class="nx">_</span><span class="p">.</span><span class="nx">each</span> <span class="nx">model</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">tuple</span><span class="p">),</span> <span class="p">(</span><span class="nx">t</span><span class="p">)</span> <span class="o">=&gt;</span>
                <span class="p">[</span> <span class="nx">mteam</span><span class="p">,</span> <span class="nx">mrole</span> <span class="p">]</span> <span class="o">=</span> <span class="nx">t</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s">&#39;:&#39;</span><span class="p">)</span>
                <span class="nx">_</span><span class="p">.</span><span class="nx">each</span> <span class="nx">mrole</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s">&#39;,&#39;</span><span class="p">),</span> <span class="p">(</span><span class="nx">r</span><span class="p">)</span> <span class="o">=&gt;</span>
                    <span class="k">return</span> <span class="k">if</span> <span class="nx">etiquettes</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="nx">$</span><span class="p">.</span><span class="nx">trim</span><span class="p">(</span><span class="nx">r</span><span class="p">))</span> <span class="o">isnt</span> <span class="o">-</span><span class="mi">1</span>
                    <span class="nx">etiquettes</span><span class="p">.</span><span class="nx">push</span> <span class="nx">$</span><span class="p">.</span><span class="nx">trim</span> <span class="nx">r</span>
            <span class="nv">etiquettes = </span><span class="nx">@sortEtiquettes</span> <span class="nx">etiquettes</span>
            <span class="nx">etiquettes</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-142">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-142">&#182;</a>                          </div>                          <p>Sort etiquettes from etiquettes.json order</p>                      </td>                      <td class="code">                          <div class="highlight"><pre>        <span class="nv">sortEtiquettes: </span><span class="p">(</span><span class="nx">etiquettes</span><span class="p">)</span> <span class="o">=&gt;</span>
            <span class="nv">ordered = </span><span class="p">[]</span>
            <span class="nx">_</span><span class="p">.</span><span class="nx">each</span> <span class="nb">window</span><span class="p">.</span><span class="nx">etiquettes</span><span class="p">,</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="o">=&gt;</span>
                <span class="nx">ordered</span><span class="p">.</span><span class="nx">push</span> <span class="nx">e</span><span class="p">.</span><span class="nx">id</span> <span class="k">if</span> <span class="nx">etiquettes</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">id</span><span class="p">)</span> <span class="o">isnt</span> <span class="o">-</span><span class="mi">1</span>
            <span class="nx">_</span><span class="p">.</span><span class="nx">each</span> <span class="nx">etiquettes</span><span class="p">,</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="o">=&gt;</span>
                <span class="nx">ordered</span><span class="p">.</span><span class="nx">push</span> <span class="nx">e</span> <span class="k">if</span> <span class="nx">ordered</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="o">is</span> <span class="o">-</span><span class="mi">1</span>
            <span class="nx">ordered</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-143">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-143">&#182;</a>                          </div>                          <p>Save open/closed state of facets on localStorage</p>                      </td>                      <td class="code">                          <div class="highlight"><pre>        <span class="nv">saveFacetOpenState: </span><span class="p">()</span> <span class="o">=&gt;</span>
            <span class="nv">entity = </span><span class="nb">window</span><span class="p">.</span><span class="nx">Settings</span><span class="p">.</span><span class="nx">entity</span>
            <span class="nv">ls = </span><span class="nb">window</span><span class="p">.</span><span class="nx">localStorage</span><span class="p">[</span><span class="nx">entity</span><span class="p">]</span>
            <span class="nv">ls = </span><span class="k">if</span> <span class="nx">ls</span> <span class="k">then</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">parse</span> <span class="nx">ls</span> <span class="k">else</span> <span class="p">{}</span>
            <span class="nv">ls.facetOpenState = </span><span class="nx">@facetOpenState</span><span class="p">.</span><span class="nx">get</span><span class="p">()</span>
            <span class="nb">window</span><span class="p">.</span><span class="nx">localStorage</span><span class="p">[</span><span class="nx">entity</span><span class="p">]</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span> <span class="nx">ls</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-144">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-144">&#182;</a>                          </div>                          <p>Set facet open/closed state of facets on localStorage</p>                      </td>                      <td class="code">                          <div class="highlight"><pre>        <span class="nv">setFacetOpenState: </span><span class="p">()</span> <span class="o">=&gt;</span>
            <span class="nv">entity = </span><span class="nb">window</span><span class="p">.</span><span class="nx">Settings</span><span class="p">.</span><span class="nx">entity</span>
            <span class="k">return</span> <span class="nx">@initFacetOpenState</span><span class="p">()</span> <span class="nx">unless</span> <span class="nb">window</span><span class="p">.</span><span class="nx">localStorage</span><span class="p">[</span><span class="nx">entity</span><span class="p">]</span>
            <span class="nv">ls = </span><span class="nx">JSON</span><span class="p">.</span><span class="nx">parse</span> <span class="nb">window</span><span class="p">.</span><span class="nx">localStorage</span><span class="p">[</span><span class="nx">entity</span><span class="p">]</span>
            <span class="nv">fs = </span><span class="nx">ls</span><span class="p">.</span><span class="nx">facetOpenState</span>
            <span class="k">return</span> <span class="nx">@initFacetOpenState</span><span class="p">()</span> <span class="nx">unless</span> <span class="nx">fs</span>
            <span class="vi">@facetOpenState.arr = </span><span class="nx">fs</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-145">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-145">&#182;</a>                          </div>                          <p>Initialize facet open/close state array</p>                      </td>                      <td class="code">                          <div class="highlight"><pre>        <span class="nv">initFacetOpenState: </span><span class="p">()</span> <span class="o">=&gt;</span>
            <span class="nb">window</span><span class="p">.</span><span class="nx">facets</span><span class="p">.</span><span class="nx">each</span> <span class="p">(</span><span class="nx">f</span><span class="p">)</span> <span class="o">=&gt;</span>
                <span class="nx">@facetOpenState</span><span class="p">.</span><span class="nx">push</span> <span class="nv">cat: </span><span class="nx">f</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s">&#39;name&#39;</span><span class="p">),</span> <span class="nv">field: </span><span class="s">&#39;facet&#39;</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-146">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-146">&#182;</a>                          </div>                          <p>Catch a click anywhere in the app</p>                      </td>                      <td class="code">                          <div class="highlight"><pre>        <span class="nv">documentClick: </span><span class="p">()</span> <span class="o">=&gt;</span>
            <span class="nx">@hideEntitiesMenu</span><span class="p">()</span>
            <span class="nx">$</span><span class="p">(</span><span class="s">&#39;#columnsMenu&#39;</span><span class="p">).</span><span class="nx">hide</span><span class="p">().</span><span class="nx">removeClass</span> <span class="s">&#39;active&#39;</span>
            <span class="nx">$</span><span class="p">(</span><span class="s">&#39;#columnOptions&#39;</span><span class="p">).</span><span class="nx">hide</span><span class="p">()</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-147">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-147">&#182;</a>                          </div>                          <p>Get the thumbnail label used in thumbnail views</p>                      </td>                      <td class="code">                          <div class="highlight"><pre>        <span class="nv">getThumbnailLabel: </span><span class="p">(</span><span class="nx">m</span><span class="p">)</span> <span class="o">=&gt;</span>
            <span class="nv">thumbnails = </span><span class="nb">window</span><span class="p">.</span><span class="nx">Settings</span><span class="p">.</span><span class="nx">Schema</span><span class="p">.</span><span class="nx">getThumbnails</span><span class="p">()</span>
            <span class="nv">label = </span><span class="p">[]</span>
            <span class="nx">_</span><span class="p">.</span><span class="nx">each</span> <span class="nx">thumbnails</span><span class="p">,</span> <span class="p">(</span><span class="nx">f</span><span class="p">)</span> <span class="o">=&gt;</span>
                <span class="nx">label</span><span class="p">.</span><span class="nx">push</span> <span class="nx">m</span><span class="p">[</span><span class="nx">f</span><span class="p">.</span><span class="nx">id</span><span class="p">]</span>
            <span class="nx">label</span><span class="p">.</span><span class="nx">join</span> <span class="s">&#39; &#39;</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-148">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-148">&#182;</a>                          </div>                          <p>Gets the key name for the img fields, useful for templates.</p>                      </td>                      <td class="code">                          <div class="highlight"><pre>        <span class="nv">getPicKey: </span><span class="p">()</span> <span class="o">=&gt;</span>
            <span class="nv">pictures = </span><span class="nb">window</span><span class="p">.</span><span class="nx">Settings</span><span class="p">.</span><span class="nx">Schema</span><span class="p">.</span><span class="nx">getPictures</span><span class="p">()</span>
            <span class="k">return</span> <span class="nx">pictures</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s">&#39;id&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="nx">pictures</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-149">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-149">&#182;</a>                          </div>                          <p>Checks if id is a valid tuple field</p>                      </td>                      <td class="code">                          <div class="highlight"><pre>        <span class="nv">isTuple: </span><span class="p">(</span><span class="nx">id</span><span class="p">)</span> <span class="o">=&gt;</span>
            <span class="nv">tuples = </span><span class="nb">window</span><span class="p">.</span><span class="nx">Settings</span><span class="p">.</span><span class="nx">Schema</span><span class="p">.</span><span class="nx">getTuples</span><span class="p">()</span>
            <span class="nv">allTuples = </span><span class="p">[]</span>
            <span class="nx">_</span><span class="p">.</span><span class="nx">each</span> <span class="nx">tuples</span><span class="p">,</span> <span class="p">(</span><span class="nx">t</span><span class="p">)</span> <span class="o">=&gt;</span>
                <span class="nx">allTuples</span><span class="p">.</span><span class="nx">push</span> <span class="nx">t</span><span class="p">.</span><span class="nx">id</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s">&#39;:&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
                <span class="nx">allTuples</span><span class="p">.</span><span class="nx">push</span> <span class="nx">t</span><span class="p">.</span><span class="nx">id</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s">&#39;:&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">return</span> <span class="kc">no</span> <span class="k">if</span> <span class="nx">allTuples</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="nx">id</span><span class="p">)</span> <span class="o">is</span> <span class="o">-</span><span class="mi">1</span>
            <span class="k">return</span> <span class="kc">yes</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-150">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-150">&#182;</a>                          </div>                          <p>Check if browsing from an iPad/Android device</p>                      </td>                      <td class="code">                          <div class="highlight"><pre>        <span class="nv">isTablet: </span><span class="p">()</span> <span class="o">=&gt;</span>
            <span class="k">return</span> <span class="nx">navigator</span><span class="p">.</span><span class="nx">userAgent</span><span class="p">.</span><span class="nx">match</span><span class="p">(</span><span class="sr">/iPad|Android/i</span><span class="p">)</span> <span class="o">isnt</span> <span class="kc">null</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-151">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-151">&#182;</a>                          </div>                          <p>Lets create our app!</p>                      </td>                      <td class="code">                          <div class="highlight"><pre>    <span class="vi">@App = </span><span class="k">new</span> <span class="nx">AppView</span>

</pre></div>                      </td>                  </tr>                                </tbody>          </table>      </div>  </body>  </html>