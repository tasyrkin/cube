<!DOCTYPE html>  <html>  <head>      <title>routes.coffee</title>      <meta http-equiv="content-type" content="text/html; charset=UTF-8">      <link rel="stylesheet" media="all" href="zocco.css" />  </head>  <body>      <div id="container">          <div id="background"></div>                        <div id="jumpWrapper">                  <div id="jumpPage">                      <label>Files...</label>                                                                  <a class="source" href="app.html">                          app.coffee                      </a>                                                                  <a class="source" href="collection.html">                          collection.coffee                      </a>                                                                  <a class="source" href="facets.html">                          facets.coffee                      </a>                                                                  <a class="source" href="index.html">                          index.coffee                      </a>                                                                  <a class="source" href="facetArray.html">                          facetArray.coffee                      </a>                                                                  <a class="source" href="schema.html">                          schema.coffee                      </a>                                                                  <a class="source" href="facet.html">                          facet.coffee                      </a>                                                                  <a class="source" href="item.html">                          item.coffee                      </a>                                                                  <a class="source" href="print.html">                          print.coffee                      </a>                                                                  <a class="source" href="routes.html">                          routes.coffee                      </a>                                                                  <a class="source" href="facet.html">                          facet.coffee                      </a>                                                                  <a class="source" href="item.html">                          item.coffee                      </a>                                                                  <a class="source" href="profile.html">                          profile.coffee                      </a>                                                                  <a class="source" href="cube.html">                          cube.coffee                      </a>                                                                  <a class="source" href="code.html">                          code.coffee                      </a>                                                                  <a class="source" href="code.html">                          code.coffee                      </a>                                                                  <a class="source" href="code.html">                          code.coffee                      </a>                                                                  <a class="source" href="code.html">                          code.coffee                      </a>                                                                  <a class="source" href="code.html">                          code.coffee                      </a>                                                                  <a class="source" href="server.config.html">                          server.config.coffee                      </a>                                                                  <a class="source" href="server.routes.html">                          server.routes.coffee                      </a>                                                                  <a class="source" href="server.settings.html">                          server.settings.coffee                      </a>                                                                  <a class="source" href="entityController.html">                          entityController.coffee                      </a>                                                                  <a class="source" href="extensionController.html">                          extensionController.coffee                      </a>                                                                  <a class="source" href="facetManager.html">                          facetManager.coffee                      </a>                                                                  <a class="source" href="itemController.html">                          itemController.coffee                      </a>                                                                  <a class="source" href="printController.html">                          printController.coffee                      </a>                                                                  <a class="source" href="schema.html">                          schema.coffee                      </a>                                                                  <a class="source" href="solrManager.html">                          solrManager.coffee                      </a>                                                                  <a class="source" href="genSchema.html">                          genSchema.coffee                      </a>                                                                  <a class="source" href="importer-fortunes.html">                          importer-fortunes.coffee                      </a>                                                                  <a class="source" href="importer-hosts.html">                          importer-hosts.coffee                      </a>                                                                  <a class="source" href="importer-projects.html">                          importer-projects.coffee                      </a>                                        </div>              </div>                    <table cellpadding="0" cellspacing="0">              <thead>                  <tr>                      <th class="docs">                          <h1>                              routes.coffee                          </h1>                      </th>                      <th class="code">                      </th>                  </tr>              </thead>              <tbody>                                                      <tr id="section-1">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-1">&#182;</a>                          </div>                          <h3 id="backboneroutes">Backbone Routes</h3>                      </td>                      <td class="code">                          <div class="highlight"><pre><span class="nx">$</span> <span class="o">-&gt;</span>

    <span class="k">class</span> <span class="nb">window</span><span class="p">.</span><span class="nx">Routes</span> <span class="k">extends</span> <span class="nx">Backbone</span><span class="p">.</span><span class="nx">Router</span>

        <span class="nv">routes:</span>
            <span class="s">&quot;qs/:qs&quot;</span>    <span class="o">:</span> <span class="s">&quot;getRoute&quot;</span>
            <span class="s">&quot;&quot;</span>          <span class="o">:</span> <span class="s">&quot;root&quot;</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-2">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-2">&#182;</a>                          </div>                          <h3 id="routetoadefinedstate">Route to a defined state</h3>

<p>Route to the appropriate state based on the Querystring parameters.</p>                      </td>                      <td class="code">                          <div class="highlight"><pre>        <span class="nv">getRoute: </span><span class="p">(</span><span class="nx">qs</span><span class="p">,</span> <span class="nx">params</span><span class="p">)</span> <span class="o">=&gt;</span>

            <span class="nx">@setSort</span> <span class="nx">params</span><span class="p">.</span><span class="nx">sort</span> <span class="k">if</span> <span class="nx">params</span><span class="p">.</span><span class="nx">sort</span>
            <span class="nx">@setRows</span> <span class="nx">params</span><span class="p">.</span><span class="nx">rows</span> <span class="k">if</span> <span class="nx">params</span><span class="p">.</span><span class="nx">rows</span>
            <span class="nx">@setPage</span> <span class="nx">params</span><span class="p">.</span><span class="nx">page</span> <span class="k">if</span> <span class="nx">params</span><span class="p">.</span><span class="nx">page</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-3">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-3">&#182;</a>                          </div>                          <p>This is a fix. Sometimes the parameters come as a string,
instead of as an array, defined by '|' as the splitting char.
This makes shure its an array.</p>                      </td>                      <td class="code">                          <div class="highlight"><pre>            <span class="nv">params.fs = </span><span class="nx">@parseToArr</span> <span class="nx">params</span><span class="p">.</span><span class="nx">fs</span> <span class="k">if</span> <span class="nx">params</span><span class="p">.</span><span class="nx">fs</span>
            <span class="nv">params.id = </span><span class="nx">@parseToArr</span> <span class="nx">params</span><span class="p">.</span><span class="nx">id</span> <span class="k">if</span> <span class="nx">params</span><span class="p">.</span><span class="nx">id</span><span class="o">?</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="s">&#39;|&#39;</span><span class="p">)</span> <span class="o">isnt</span> <span class="o">-</span><span class="mi">1</span>

            <span class="k">if</span> <span class="nx">params</span><span class="p">.</span><span class="nx">id</span> <span class="o">is</span> <span class="s">&quot;new&quot;</span> <span class="k">then</span> <span class="nx">@setPage</span> <span class="mi">0</span>
            <span class="k">if</span> <span class="k">typeof</span> <span class="nx">params</span><span class="p">.</span><span class="nx">id</span> <span class="o">is</span> <span class="s">&quot;string&quot;</span> <span class="o">and</span> <span class="o">!</span><span class="nx">params</span><span class="p">.</span><span class="nx">page</span>
                <span class="k">return</span> <span class="nx">@getPageOfId</span> <span class="nx">params</span><span class="p">.</span><span class="nx">id</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">(</span><span class="nx">page</span><span class="p">)</span> <span class="o">=&gt;</span>
                    <span class="nx">@setPage</span> <span class="nx">page</span>
                    <span class="k">return</span> <span class="nx">@onRoute</span> <span class="nx">params</span>
            <span class="nx">@onRoute</span> <span class="nx">params</span>

        <span class="nv">onRoute: </span><span class="p">(</span><span class="nx">params</span><span class="p">)</span> <span class="o">=&gt;</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-4">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-4">&#182;</a>                          </div>                          <p>Get view mode: list or thumbnail.</p>                      </td>                      <td class="code">                          <div class="highlight"><pre>            <span class="nb">window</span><span class="p">.</span><span class="nv">Settings.view = </span><span class="nx">params</span><span class="p">.</span><span class="nx">view</span> <span class="o">||</span> <span class="s">&#39;list&#39;</span>
            <span class="k">if</span> <span class="nb">window</span><span class="p">.</span><span class="nx">Settings</span><span class="p">.</span><span class="nx">view</span> <span class="o">isnt</span> <span class="s">&#39;list&#39;</span>
                <span class="nx">$</span><span class="p">(</span><span class="s">&#39;span#view&#39;</span><span class="p">).</span><span class="nx">removeClass</span> <span class="s">&#39;list&#39;</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-5">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-5">&#182;</a>                          </div>                          <p>If there is a profileView present, destroy it. It will generate
the correct profile view later.</p>                      </td>                      <td class="code">                          <div class="highlight"><pre>            <span class="nb">window</span><span class="p">.</span><span class="nx">profileView</span><span class="o">?</span><span class="p">.</span><span class="nx">close</span><span class="p">()</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-6">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-6">&#182;</a>                          </div>                          <p>Clear search field</p>                      </td>                      <td class="code">                          <div class="highlight"><pre>            <span class="nx">$</span><span class="p">(</span><span class="s">&#39;#inputSearch&#39;</span><span class="p">).</span><span class="nx">val</span> <span class="s">&#39;&#39;</span>

            <span class="nx">@setFacet</span> <span class="nx">params</span><span class="p">.</span><span class="nx">fs</span> <span class="o">||</span> <span class="p">[],</span> <span class="nx">params</span><span class="p">.</span><span class="nx">s</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span>
                <span class="nx">@setId</span> <span class="nx">params</span><span class="p">.</span><span class="nx">id</span> <span class="k">if</span> <span class="nx">params</span><span class="p">.</span><span class="nx">id</span>
                <span class="nb">window</span><span class="p">.</span><span class="nx">App</span><span class="p">.</span><span class="nx">navigate</span> <span class="nx">replace</span><span class="o">:</span><span class="kc">yes</span>
                <span class="nx">@trigger</span> <span class="s">&#39;route&#39;</span>

        <span class="nv">parseToArr: </span><span class="nf">(source) -&gt;</span>
            <span class="k">return</span> <span class="nx">source</span> <span class="nx">unless</span> <span class="k">typeof</span> <span class="nx">source</span> <span class="o">is</span> <span class="s">&quot;string&quot;</span>
            <span class="nv">s = </span><span class="p">[]</span>
            <span class="nx">_</span><span class="p">.</span><span class="nx">each</span> <span class="nx">source</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s">&#39;|&#39;</span><span class="p">),</span> <span class="nf">(v) -&gt;</span>
                <span class="nx">s</span><span class="p">.</span><span class="nx">push</span> <span class="nx">v</span> <span class="k">if</span> <span class="nx">v</span>
            <span class="k">return</span> <span class="nx">s</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-7">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-7">&#182;</a>                          </div>                          <h3 id="routetoinitialstate">Route to initial state</h3>                      </td>                      <td class="code">                          <div class="highlight"><pre>        <span class="nv">root: </span><span class="p">()</span> <span class="o">=&gt;</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-8">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-8">&#182;</a>                          </div>                          <p>Destroy profile view if existent</p>                      </td>                      <td class="code">                          <div class="highlight"><pre>            <span class="nb">window</span><span class="p">.</span><span class="nx">profileView</span><span class="o">?</span><span class="p">.</span><span class="nx">close</span><span class="p">()</span>

            <span class="nx">$</span><span class="p">(</span><span class="s">&#39;#pane&#39;</span><span class="p">).</span><span class="nx">hide</span><span class="p">()</span>
            <span class="nx">$</span><span class="p">(</span><span class="s">&#39;#pane&#39;</span><span class="p">).</span><span class="nx">html</span> <span class="s">&#39;&#39;</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-9">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-9">&#182;</a>                          </div>                          <p>Remove all items selections
window.App.clearSelection()</p>                      </td>                      <td class="code">                          <div class="highlight"><pre></pre></div>                      </td>                  </tr>                                                      <tr id="section-10">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-10">&#182;</a>                          </div>                          <p>Reset facet filters</p>                      </td>                      <td class="code">                          <div class="highlight"><pre>            <span class="nb">window</span><span class="p">.</span><span class="nx">App</span><span class="p">.</span><span class="nx">resetAllFilters</span><span class="p">()</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-11">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-11">&#182;</a>                          </div>                          <h3 id="setid">Set ID</h3>

<ul>
<li>If ID is 'New' show empty profile view to add a new item.</li>
<li>If ID is a string, there is just 1 item selected. Show its profile.</li>
<li>If ID is an array, there is a multiple selection. Show the
corresponding group view.</li>
</ul>                      </td>                      <td class="code">                          <div class="highlight"><pre>        <span class="nv">setId: </span><span class="p">(</span><span class="nx">id</span><span class="p">)</span> <span class="o">=&gt;</span>

            <span class="k">if</span> <span class="nx">id</span> <span class="o">is</span> <span class="s">&#39;new&#39;</span>
                <span class="nb">window</span><span class="p">.</span><span class="nx">App</span><span class="p">.</span><span class="nx">showProfile</span> <span class="k">new</span> <span class="nb">window</span><span class="p">.</span><span class="nx">Item</span>
                <span class="k">return</span> <span class="nb">window</span><span class="p">.</span><span class="nx">profileView</span><span class="p">.</span><span class="nx">form</span><span class="p">()</span>

            <span class="k">if</span> <span class="k">typeof</span> <span class="nx">id</span> <span class="o">is</span> <span class="k">typeof</span> <span class="s">&#39;string&#39;</span>
                <span class="k">return</span> <span class="nx">unless</span> <span class="nx">@isItemInCol</span> <span class="nx">id</span>
                <span class="k">return</span> <span class="nb">window</span><span class="p">.</span><span class="nx">App</span><span class="p">.</span><span class="nx">selectOne</span> <span class="nx">$</span><span class="p">(</span><span class="s">&quot;</span><span class="err">#</span><span class="si">#{</span><span class="nx">id</span><span class="si">}</span><span class="s">&quot;</span><span class="p">,</span> <span class="s">&#39;#items&#39;</span><span class="p">)</span>

            <span class="k">if</span> <span class="k">typeof</span> <span class="nx">id</span> <span class="o">is</span> <span class="k">typeof</span> <span class="p">[]</span>
                <span class="nx">_</span><span class="p">.</span><span class="nx">each</span> <span class="nx">id</span><span class="p">,</span> <span class="p">(</span><span class="nx">_id</span><span class="p">)</span> <span class="o">=&gt;</span>
                    <span class="k">return</span> <span class="nx">unless</span> <span class="nx">@isItemInCol</span> <span class="nx">_id</span>
                    <span class="k">if</span> <span class="nx">$</span><span class="p">(</span><span class="s">&quot;</span><span class="err">#</span><span class="si">#{</span><span class="nx">_id</span><span class="si">}</span><span class="s">&quot;</span><span class="p">,</span> <span class="s">&#39;#items&#39;</span><span class="p">).</span><span class="nx">length</span>
                        <span class="nb">window</span><span class="p">.</span><span class="nx">App</span><span class="p">.</span><span class="nx">addToSelection</span> <span class="nx">$</span><span class="p">(</span><span class="s">&quot;</span><span class="err">#</span><span class="si">#{</span><span class="nx">_id</span><span class="si">}</span><span class="s">&quot;</span><span class="p">,</span> <span class="s">&#39;#items&#39;</span><span class="p">)</span>
                <span class="nb">window</span><span class="p">.</span><span class="nx">App</span><span class="p">.</span><span class="nx">showGroupView</span><span class="p">()</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-12">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-12">&#182;</a>                          </div>                          <h3 id="setfiltersstate">Set Filters state</h3>

<ol>
<li>Get all filters from the querystring parameters</li>
<li>Select filters that are available</li>
<li>Expand facet categories that have selections</li>
<li>Filter the collection</li>
</ol>                      </td>                      <td class="code">                          <div class="highlight"><pre>        <span class="nv">setFacet: </span><span class="p">(</span><span class="nx">fs</span><span class="p">,</span> <span class="nx">s</span><span class="p">,</span> <span class="nx">cb</span><span class="p">)</span> <span class="o">=&gt;</span>
            <span class="nv">_fs = </span><span class="p">[]</span>
            <span class="nv">sep = </span><span class="nb">window</span><span class="p">.</span><span class="nx">Settings</span><span class="p">.</span><span class="nx">separator</span>
            <span class="nx">_</span><span class="p">.</span><span class="nx">each</span> <span class="nx">fs</span><span class="p">,</span> <span class="p">(</span><span class="nx">facet</span><span class="p">)</span> <span class="o">=&gt;</span>
                <span class="k">if</span> <span class="o">!</span><span class="nx">@isFacetInFacets</span> <span class="nx">facet</span>
                    <span class="nv">facet = </span><span class="nx">@traverseUpwards</span> <span class="nx">facet</span>
                <span class="k">return</span> <span class="nx">unless</span> <span class="nx">facet</span>
                <span class="nv">cat = </span><span class="nx">facet</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s">&#39;:&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
                <span class="nv">field = </span><span class="nx">facet</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s">&#39;:&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
                <span class="nx">_fs</span><span class="p">.</span><span class="nx">push</span> <span class="nv">cat: </span><span class="nx">cat</span><span class="p">,</span> <span class="nv">field: </span><span class="nx">field</span>
            <span class="nb">window</span><span class="p">.</span><span class="nx">App</span><span class="p">.</span><span class="nx">setFacetState</span> <span class="nx">_fs</span>
            <span class="nv">itemsUrl = </span><span class="nb">window</span><span class="p">.</span><span class="nx">App</span><span class="p">.</span><span class="nx">getFilterQS</span><span class="p">(</span><span class="nx">_fs</span><span class="p">)</span>

            <span class="nb">window</span><span class="p">.</span><span class="nx">facets</span><span class="p">.</span><span class="nx">fetch</span>
                <span class="nv">data: </span><span class="nx">itemsUrl</span>
                <span class="nv">success: </span><span class="p">()</span> <span class="o">=&gt;</span>
                    <span class="nx">@setSearch</span> <span class="nx">s</span>
                    <span class="nb">window</span><span class="p">.</span><span class="nx">App</span><span class="p">.</span><span class="nx">hideError</span><span class="p">()</span>
                    <span class="nb">window</span><span class="p">.</span><span class="nx">App</span><span class="p">.</span><span class="nx">fetchItems</span>
                        <span class="nv">data: </span><span class="nx">itemsUrl</span>
                        <span class="nv">success: </span><span class="p">()</span> <span class="o">=&gt;</span>
                            <span class="nb">window</span><span class="p">.</span><span class="nx">App</span><span class="p">.</span><span class="nx">genPageIndex</span><span class="p">()</span>
                            <span class="nb">window</span><span class="p">.</span><span class="nx">App</span><span class="p">.</span><span class="nx">setFacetState</span> <span class="nx">_fs</span>
                            <span class="k">if</span> <span class="nx">_fs</span><span class="p">.</span><span class="nx">length</span>
                                <span class="nx">$</span><span class="p">(</span><span class="s">&#39;span#reset&#39;</span><span class="p">).</span><span class="nx">show</span><span class="p">()</span>
                            <span class="nx">cb</span><span class="p">()</span> <span class="k">if</span> <span class="nx">cb</span>
                <span class="nv">error: </span><span class="p">()</span> <span class="o">=&gt;</span>
                    <span class="nb">window</span><span class="p">.</span><span class="nx">App</span><span class="p">.</span><span class="nx">showError</span><span class="p">()</span>

        <span class="nv">traverseUpwards: </span><span class="p">(</span><span class="nx">f</span><span class="p">)</span> <span class="o">=&gt;</span>
            <span class="nv">sep = </span><span class="nb">window</span><span class="p">.</span><span class="nx">Settings</span><span class="p">.</span><span class="nx">separator</span>
            <span class="nv">field = </span><span class="nx">f</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s">&#39;:&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">].</span><span class="nx">split</span><span class="p">(</span><span class="nx">sep</span><span class="p">)</span>
            <span class="nv">field = </span><span class="nx">field</span><span class="p">.</span><span class="nx">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nx">field</span><span class="p">.</span><span class="nx">length</span><span class="o">-</span><span class="mi">1</span><span class="p">).</span><span class="nx">join</span><span class="p">(</span><span class="nx">sep</span><span class="p">)</span>
            <span class="k">return</span> <span class="nx">f</span> <span class="nx">unless</span> <span class="nx">field</span>
            <span class="nv">f = </span><span class="nx">f</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s">&#39;:&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s">&quot;:&quot;</span> <span class="o">+</span> <span class="nx">field</span>
            <span class="k">return</span> <span class="nx">@traverseUpwards</span><span class="p">(</span><span class="nx">f</span><span class="p">)</span> <span class="nx">unless</span> <span class="nx">@isFacetInFacets</span> <span class="nx">f</span>
            <span class="k">return</span> <span class="nx">f</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-13">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-13">&#182;</a>                          </div>                          <h3 id="setsearch">Set search</h3>

<p>Set the search text on the search input and filter the collection</p>                      </td>                      <td class="code">                          <div class="highlight"><pre>        <span class="nv">setSearch: </span><span class="p">(</span><span class="nx">s</span><span class="p">)</span> <span class="o">=&gt;</span>
            <span class="k">return</span> <span class="nx">unless</span> <span class="nx">s</span>
            <span class="nv">s = </span><span class="nx">s</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">()</span>
            <span class="nb">window</span><span class="p">.</span><span class="nv">collection.search = </span><span class="nx">s</span>
            <span class="nx">$</span><span class="p">(</span><span class="s">&#39;#inputSearch&#39;</span><span class="p">).</span><span class="nx">val</span> <span class="nx">s</span>

        <span class="nv">setSort: </span><span class="p">(</span><span class="nx">s</span><span class="p">)</span> <span class="o">=&gt;</span>
            <span class="nb">window</span><span class="p">.</span><span class="nv">collection.sort = </span><span class="nx">s</span> <span class="o">or</span> <span class="nb">window</span><span class="p">.</span><span class="nx">Settings</span><span class="p">.</span><span class="nx">sort</span>

        <span class="nv">setRows: </span><span class="p">(</span><span class="nx">r</span><span class="p">)</span> <span class="o">=&gt;</span>
            <span class="nb">window</span><span class="p">.</span><span class="nv">collection.rows = </span><span class="nx">r</span> <span class="o">or</span> <span class="nb">window</span><span class="p">.</span><span class="nx">Settings</span><span class="p">.</span><span class="nx">rows</span>

        <span class="nv">setPage: </span><span class="p">(</span><span class="nx">p</span><span class="p">)</span> <span class="o">=&gt;</span>
            <span class="nb">window</span><span class="p">.</span><span class="nv">collection.page = </span><span class="nx">p</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-14">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-14">&#182;</a>                          </div>                          <p>Check if the item is still in the items collection</p>                      </td>                      <td class="code">                          <div class="highlight"><pre>        <span class="nv">isItemInCol: </span><span class="p">(</span><span class="nx">id</span><span class="p">)</span> <span class="o">=&gt;</span>
            <span class="k">return</span> <span class="kc">yes</span> <span class="k">if</span> <span class="nb">window</span><span class="p">.</span><span class="nx">collection</span><span class="p">.</span><span class="nx">get</span> <span class="nx">id</span>
            <span class="nb">window</span><span class="p">.</span><span class="nx">App</span><span class="p">.</span><span class="nx">navigate</span> <span class="nv">replace: </span><span class="kc">yes</span>
            <span class="k">return</span> <span class="kc">no</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-15">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-15">&#182;</a>                          </div>                          <p>Check if the facet field is still in the facets collection</p>                      </td>                      <td class="code">                          <div class="highlight"><pre>        <span class="nv">isFacetInFacets: </span><span class="p">(</span><span class="nx">f</span><span class="p">)</span> <span class="o">=&gt;</span>
            <span class="nv">cat = </span><span class="nx">f</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s">&#39;:&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="nv">field = </span><span class="nx">f</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s">&#39;:&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">if</span> <span class="nx">$</span><span class="p">(</span><span class="s">&quot;li[data-title=&#39;</span><span class="si">#{</span><span class="nx">field</span><span class="si">}</span><span class="s">&#39;]&quot;</span><span class="p">,</span> <span class="s">&quot;ul</span><span class="err">#</span><span class="s">facet li ul\#</span><span class="si">#{</span><span class="nx">cat</span><span class="si">}</span><span class="s">&quot;</span><span class="p">).</span><span class="nx">length</span>
                <span class="k">return</span> <span class="kc">yes</span>
            <span class="k">if</span> <span class="nx">$</span><span class="p">(</span><span class="s">&quot;span[data-type=&#39;</span><span class="si">#{</span><span class="nx">cat</span><span class="si">}</span><span class="s">&#39;][data-title=&#39;</span><span class="si">#{</span><span class="nx">field</span><span class="si">}</span><span class="s">&#39;]&quot;</span><span class="p">).</span><span class="nx">length</span>
                <span class="k">return</span> <span class="kc">yes</span>
            <span class="k">return</span> <span class="kc">no</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-16">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-16">&#182;</a>                          </div>                          <p>Find the page where a member with ID is located at.</p>                      </td>                      <td class="code">                          <div class="highlight"><pre>        <span class="nv">getPageOfId: </span><span class="p">(</span><span class="nx">id</span><span class="p">,</span> <span class="nx">page</span><span class="p">,</span> <span class="nx">cb</span><span class="p">)</span> <span class="o">=&gt;</span>
            <span class="nv">rows = </span><span class="nb">parseFloat</span> <span class="nb">window</span><span class="p">.</span><span class="nx">collection</span><span class="p">.</span><span class="nx">rows</span>
            <span class="nx">$</span><span class="p">.</span><span class="nx">get</span> <span class="nb">window</span><span class="p">.</span><span class="nx">App</span><span class="p">.</span><span class="nx">commonURL</span><span class="p">(</span><span class="nx">page</span><span class="p">,</span> <span class="mi">1000</span><span class="p">),</span> <span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="o">=&gt;</span>
                <span class="nv">index = </span><span class="mi">0</span>
                <span class="k">return</span> <span class="nx">cb</span> <span class="mi">0</span> <span class="nx">unless</span> <span class="nx">result</span><span class="p">.</span><span class="nx">response</span><span class="o">?</span><span class="p">.</span><span class="nx">docs</span><span class="p">.</span><span class="nx">length</span>
                <span class="nx">_</span><span class="p">.</span><span class="nx">each</span> <span class="nx">result</span><span class="p">.</span><span class="nx">response</span><span class="p">.</span><span class="nx">docs</span><span class="p">,</span> <span class="p">(</span><span class="nx">doc</span><span class="p">,</span> <span class="nx">i</span><span class="p">)</span> <span class="o">=&gt;</span>
                    <span class="nv">index = </span><span class="nx">i</span> <span class="k">if</span> <span class="nx">id</span> <span class="o">is</span> <span class="nx">doc</span><span class="p">.</span><span class="nx">id</span>
                <span class="k">return</span> <span class="nx">cb</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">floor</span><span class="p">(</span><span class="nx">index</span><span class="o">/</span><span class="nx">rows</span><span class="p">)</span> <span class="k">if</span> <span class="nx">index</span> <span class="o">&gt;=</span> <span class="mi">0</span>
                <span class="k">return</span> <span class="nx">@getPageOfId</span> <span class="nx">id</span><span class="p">,</span> <span class="nx">page</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="nx">cb</span>

</pre></div>                      </td>                  </tr>                                </tbody>          </table>      </div>  </body>  </html>