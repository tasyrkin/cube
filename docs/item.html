<!DOCTYPE html>  <html>  <head>      <title>item.coffee</title>      <meta http-equiv="content-type" content="text/html; charset=UTF-8">      <link rel="stylesheet" media="all" href="zocco.css" />  </head>  <body>      <div id="container">          <div id="background"></div>                        <div id="jumpWrapper">                  <div id="jumpPage">                      <label>Files...</label>                                                                  <a class="source" href="app.html">                          app.coffee                      </a>                                                                  <a class="source" href="collection.html">                          collection.coffee                      </a>                                                                  <a class="source" href="facets.html">                          facets.coffee                      </a>                                                                  <a class="source" href="index.html">                          index.coffee                      </a>                                                                  <a class="source" href="facetArray.html">                          facetArray.coffee                      </a>                                                                  <a class="source" href="schema.html">                          schema.coffee                      </a>                                                                  <a class="source" href="facet.html">                          facet.coffee                      </a>                                                                  <a class="source" href="item.html">                          item.coffee                      </a>                                                                  <a class="source" href="print.html">                          print.coffee                      </a>                                                                  <a class="source" href="routes.html">                          routes.coffee                      </a>                                                                  <a class="source" href="facet.html">                          facet.coffee                      </a>                                                                  <a class="source" href="item.html">                          item.coffee                      </a>                                                                  <a class="source" href="profile.html">                          profile.coffee                      </a>                                                                  <a class="source" href="cube.html">                          cube.coffee                      </a>                                                                  <a class="source" href="code.html">                          code.coffee                      </a>                                                                  <a class="source" href="code.html">                          code.coffee                      </a>                                                                  <a class="source" href="code.html">                          code.coffee                      </a>                                                                  <a class="source" href="code.html">                          code.coffee                      </a>                                                                  <a class="source" href="code.html">                          code.coffee                      </a>                                                                  <a class="source" href="server.config.html">                          server.config.coffee                      </a>                                                                  <a class="source" href="server.routes.html">                          server.routes.coffee                      </a>                                                                  <a class="source" href="server.settings.html">                          server.settings.coffee                      </a>                                                                  <a class="source" href="entityController.html">                          entityController.coffee                      </a>                                                                  <a class="source" href="extensionController.html">                          extensionController.coffee                      </a>                                                                  <a class="source" href="facetManager.html">                          facetManager.coffee                      </a>                                                                  <a class="source" href="itemController.html">                          itemController.coffee                      </a>                                                                  <a class="source" href="printController.html">                          printController.coffee                      </a>                                                                  <a class="source" href="schema.html">                          schema.coffee                      </a>                                                                  <a class="source" href="solrManager.html">                          solrManager.coffee                      </a>                                                                  <a class="source" href="genSchema.html">                          genSchema.coffee                      </a>                                                                  <a class="source" href="importer-fortunes.html">                          importer-fortunes.coffee                      </a>                                                                  <a class="source" href="importer-hosts.html">                          importer-hosts.coffee                      </a>                                                                  <a class="source" href="importer-projects.html">                          importer-projects.coffee                      </a>                                        </div>              </div>                    <table cellpadding="0" cellspacing="0">              <thead>                  <tr>                      <th class="docs">                          <h1>                              item.coffee                          </h1>                      </th>                      <th class="code">                      </th>                  </tr>              </thead>              <tbody>                                                      <tr id="section-1">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-1">&#182;</a>                          </div>                          <h3 id="itemview">Item View</h3>                      </td>                      <td class="code">                          <div class="highlight"><pre></pre></div>                      </td>                  </tr>                                                      <tr id="section-2">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-2">&#182;</a>                          </div>                          <p>BaseItemView defines the basic view for an item. This will be
extended to a thumbnail class or a list view class.</p>                      </td>                      <td class="code">                          <div class="highlight"><pre><span class="nx">$</span> <span class="o">-&gt;</span>

    <span class="k">class</span> <span class="nb">window</span><span class="p">.</span><span class="nx">BaseItemView</span> <span class="k">extends</span> <span class="nx">Backbone</span><span class="p">.</span><span class="nx">View</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-3">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-3">&#182;</a>                          </div>                          <p>On click, show a profile view (right panel) for this item.</p>                      </td>                      <td class="code">                          <div class="highlight"><pre>        <span class="nv">events:</span>

            <span class="s">&quot;click&quot;</span> <span class="o">:</span> <span class="s">&quot;showProfile&quot;</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-4">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-4">&#182;</a>                          </div>                          <h3 id="initializestheitemview">Initializes the item view</h3>

<ol>
<li>Attach id to HTML element to identify clicked elements easier.</li>
<li>Bind model destruction to this view's destruction event.</li>
<li>Give the model information about the view in which its being showed</li>
<li>If its on the selected members list, select it.</li>
<li>Redundantly checks if this item is being displayed in the profile
view and selects it if it is.</li>
</ol>                      </td>                      <td class="code">                          <div class="highlight"><pre>        <span class="nv">initialize: </span><span class="p">()</span> <span class="o">=&gt;</span>

            <span class="nx">@$el</span><span class="p">.</span><span class="nx">attr</span> <span class="s">&#39;id&#39;</span><span class="p">,</span> <span class="nx">@model</span><span class="p">.</span><span class="nx">id</span>

            <span class="nx">@model</span><span class="p">.</span><span class="nx">bind</span> <span class="s">&#39;destroy&#39;</span><span class="p">,</span>  <span class="nx">@remove</span><span class="p">,</span>  <span class="nx">@</span>
            <span class="vi">@model.view = </span><span class="nx">@</span>

            <span class="k">if</span> <span class="nb">window</span><span class="p">.</span><span class="nx">profileView</span><span class="o">?</span><span class="p">.</span><span class="nx">model</span><span class="p">.</span><span class="nx">id</span> <span class="o">is</span> <span class="nx">@model</span><span class="p">.</span><span class="nx">id</span>
                <span class="nb">window</span><span class="p">.</span><span class="nx">App</span><span class="p">.</span><span class="nx">selectOne</span> <span class="nx">@$el</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-5">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-5">&#182;</a>                          </div>                          <h3 id="renderitem">Render item</h3>

<p>Render an item view. parseSubfields() returns multivalue fields in
a propper readable way.</p>                      </td>                      <td class="code">                          <div class="highlight"><pre>        <span class="nv">render: </span><span class="p">()</span> <span class="o">=&gt;</span>

            <span class="nx">@$el</span><span class="p">.</span><span class="nx">html</span> <span class="nx">@template</span> <span class="nv">m: </span><span class="nx">@model</span>
            <span class="nx">@</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-6">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-6">&#182;</a>                          </div>                          <h3 id="showprofileview">Show Profile view</h3>

<ul>
<li>If pressing Ctrl, Alt or Shift, use multiple selection.</li>
<li>If not, deactivate all other items and activate this item only.</li>
<li>Update URL to point to new state</li>
</ul>                      </td>                      <td class="code">                          <div class="highlight"><pre>        <span class="nv">showProfile: </span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="o">=&gt;</span>

            <span class="nv">$e = </span><span class="nx">$</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">currentTarget</span><span class="p">)</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-7">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-7">&#182;</a>                          </div>                          <p>By pressing Ctrl or Alt keys, uses multiple selection.</p>                      </td>                      <td class="code">                          <div class="highlight"><pre>            <span class="k">return</span> <span class="nx">@ctrlSelect</span> <span class="nx">$e</span> <span class="k">if</span> <span class="nx">e</span><span class="p">.</span><span class="nx">ctrlKey</span> <span class="o">or</span> <span class="nx">e</span><span class="p">.</span><span class="nx">altKey</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-8">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-8">&#182;</a>                          </div>                          <p>Also by pressing Shift key and clicking.</p>                      </td>                      <td class="code">                          <div class="highlight"><pre>            <span class="k">return</span> <span class="nx">@shiftSelect</span> <span class="nx">$e</span> <span class="k">if</span> <span class="nx">e</span><span class="p">.</span><span class="nx">shiftKey</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-9">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-9">&#182;</a>                          </div>                          <p>Deactivate all other active items and close their profileViews.</p>                      </td>                      <td class="code">                          <div class="highlight"><pre>            <span class="k">if</span> <span class="nx">$e</span><span class="p">.</span><span class="nx">hasClass</span><span class="p">(</span><span class="s">&#39;active&#39;</span><span class="p">)</span> <span class="o">and</span> <span class="nb">window</span><span class="p">.</span><span class="nx">profileView</span>

                <span class="nx">@removeFromSelection</span> <span class="nx">$e</span>

                <span class="k">return</span> <span class="nb">window</span><span class="p">.</span><span class="nx">profileView</span><span class="o">?</span><span class="p">.</span><span class="nx">close</span><span class="p">()</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-10">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-10">&#182;</a>                          </div>                          <p>Mark as selected and show profile view</p>                      </td>                      <td class="code">                          <div class="highlight"><pre>            <span class="nb">window</span><span class="p">.</span><span class="nx">App</span><span class="p">.</span><span class="nx">selectOne</span> <span class="nx">$e</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-11">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-11">&#182;</a>                          </div>                          <p>Change URL to point to the new state</p>                      </td>                      <td class="code">                          <div class="highlight"><pre>            <span class="nb">window</span><span class="p">.</span><span class="nx">App</span><span class="p">.</span><span class="nx">navigate</span><span class="p">()</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-12">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-12">&#182;</a>                          </div>                          <h3 id="multipleselection">Multiple Selection</h3>                      </td>                      <td class="code">                          <div class="highlight"><pre></pre></div>                      </td>                  </tr>                                                      <tr id="section-13">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-13">&#182;</a>                          </div>                          <h3 id="selectwithshift">Select with Shift</h3>

<ul>
<li>Selects All items between the first clicked item and the current
clicked item.</li>
</ul>                      </td>                      <td class="code">                          <div class="highlight"><pre>        <span class="nv">shiftSelect: </span><span class="p">(</span><span class="nx">$e</span><span class="p">)</span> <span class="o">=&gt;</span>

            <span class="nv">all = </span><span class="nx">$</span><span class="p">(</span><span class="s">&#39;ul li, tr.selectable&#39;</span><span class="p">,</span> <span class="s">&#39;#items&#39;</span><span class="p">)</span>

            <span class="k">if</span> <span class="o">!</span><span class="nb">window</span><span class="p">.</span><span class="nx">firstActiveItem</span>
                <span class="nb">window</span><span class="p">.</span><span class="nv">firstActiveItem = </span><span class="nx">$e</span><span class="p">.</span><span class="nx">attr</span> <span class="s">&#39;id&#39;</span>

            <span class="nv">first = </span><span class="nx">all</span><span class="p">.</span><span class="nx">index</span> <span class="nx">$</span><span class="p">(</span><span class="s">&quot;</span><span class="err">#</span><span class="si">#{</span><span class="nb">window</span><span class="p">.</span><span class="nx">firstActiveItem</span><span class="si">}</span><span class="s">&quot;</span><span class="p">,</span> <span class="s">&#39;#items&#39;</span><span class="p">)</span>
            <span class="nv">first = </span><span class="nx">all</span><span class="p">.</span><span class="nx">index</span> <span class="nx">$</span><span class="p">(</span><span class="nx">$</span><span class="p">(</span><span class="s">&#39;.active&#39;</span><span class="p">,</span> <span class="s">&#39;#items&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span> <span class="k">if</span> <span class="nx">first</span> <span class="o">is</span> <span class="o">-</span><span class="mi">1</span>
            <span class="nv">first = </span><span class="mi">0</span> <span class="k">if</span> <span class="nx">first</span> <span class="o">is</span> <span class="o">-</span><span class="mi">1</span>
            <span class="nv">last = </span><span class="nx">all</span><span class="p">.</span><span class="nx">index</span> <span class="nx">$e</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

            <span class="nx">$</span><span class="p">(</span><span class="s">&#39;.active&#39;</span><span class="p">,</span> <span class="s">&#39;#items&#39;</span><span class="p">).</span><span class="nx">removeClass</span><span class="p">(</span><span class="s">&#39;active&#39;</span><span class="p">)</span>

            <span class="nb">window</span><span class="p">.</span><span class="nv">App.itemSelection = </span><span class="k">new</span> <span class="nb">window</span><span class="p">.</span><span class="nx">Collection</span>

            <span class="k">for</span> <span class="nx">i</span> <span class="k">in</span> <span class="p">[</span><span class="nx">first</span><span class="p">..</span><span class="nx">last</span><span class="p">]</span>
                <span class="nb">window</span><span class="p">.</span><span class="nx">App</span><span class="p">.</span><span class="nx">addToSelection</span> <span class="nx">$</span><span class="p">(</span><span class="nx">all</span><span class="p">[</span><span class="nx">i</span><span class="p">])</span>

            <span class="nb">window</span><span class="p">.</span><span class="nx">App</span><span class="p">.</span><span class="nx">showGroupView</span><span class="p">()</span>

            <span class="nb">window</span><span class="p">.</span><span class="nx">App</span><span class="p">.</span><span class="nx">navigate</span><span class="p">()</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-14">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-14">&#182;</a>                          </div>                          <h3 id="selectsdeselectswithctrloralt">Selects/Deselects with Ctrl or Alt.</h3>

<ul>
<li>If not in the selection, add to selection, otherwise remove it.</li>
</ul>                      </td>                      <td class="code">                          <div class="highlight"><pre>        <span class="nv">ctrlSelect: </span><span class="p">(</span><span class="nx">$e</span><span class="p">)</span> <span class="o">=&gt;</span>

            <span class="k">return</span> <span class="nx">@removeFromSelection</span> <span class="nx">$e</span> <span class="k">if</span> <span class="nx">$e</span><span class="p">.</span><span class="nx">hasClass</span> <span class="s">&#39;active&#39;</span>

            <span class="nb">window</span><span class="p">.</span><span class="nx">App</span><span class="p">.</span><span class="nx">addToSelection</span> <span class="nx">$e</span>

            <span class="nb">window</span><span class="p">.</span><span class="nx">App</span><span class="p">.</span><span class="nx">showGroupView</span><span class="p">()</span>

            <span class="nb">window</span><span class="p">.</span><span class="nx">App</span><span class="p">.</span><span class="nx">navigate</span><span class="p">()</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-15">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-15">&#182;</a>                          </div>                          <h3 id="deselect">De-select</h3>

<p>Remove one item from the selected items and update group view</p>                      </td>                      <td class="code">                          <div class="highlight"><pre>        <span class="nv">removeFromSelection: </span><span class="p">(</span><span class="nx">$e</span><span class="p">)</span> <span class="o">=&gt;</span>

            <span class="nv">id = </span><span class="nx">$e</span><span class="p">.</span><span class="nx">attr</span> <span class="s">&#39;id&#39;</span>

            <span class="k">return</span> <span class="nx">unless</span> <span class="nb">window</span><span class="p">.</span><span class="nx">App</span><span class="p">.</span><span class="nx">itemSelection</span><span class="p">.</span><span class="nx">get</span> <span class="nx">id</span>

            <span class="nb">window</span><span class="p">.</span><span class="nx">App</span><span class="p">.</span><span class="nx">itemSelection</span><span class="p">.</span><span class="nx">remove</span> <span class="nx">id</span>

            <span class="nx">$e</span><span class="p">.</span><span class="nx">removeClass</span> <span class="s">&#39;active&#39;</span>

            <span class="k">if</span> <span class="nb">window</span><span class="p">.</span><span class="nx">App</span><span class="p">.</span><span class="nx">itemSelection</span><span class="p">.</span><span class="nx">length</span>

                <span class="nb">window</span><span class="p">.</span><span class="nx">App</span><span class="p">.</span><span class="nx">navigate</span><span class="p">()</span>

                <span class="k">return</span> <span class="nb">window</span><span class="p">.</span><span class="nx">App</span><span class="p">.</span><span class="nx">showGroupView</span><span class="p">()</span>

            <span class="nb">window</span><span class="p">.</span><span class="nx">groupView</span><span class="o">?</span><span class="p">.</span><span class="nx">close</span><span class="p">()</span> <span class="k">if</span> <span class="nb">window</span><span class="p">.</span><span class="nx">App</span><span class="p">.</span><span class="nx">itemSelection</span><span class="p">.</span><span class="nx">length</span> <span class="o">is</span> <span class="mi">0</span>

            <span class="nb">window</span><span class="p">.</span><span class="nx">profileView</span><span class="o">?</span><span class="p">.</span><span class="nx">close</span><span class="p">()</span>

            <span class="nb">window</span><span class="p">.</span><span class="nx">App</span><span class="p">.</span><span class="nx">navigate</span><span class="p">()</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-16">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-16">&#182;</a>                          </div>                          <h3 id="destroyitemview">Destroy item view</h3>

<p>Propperly unbind and remove item view from DOM.</p>                      </td>                      <td class="code">                          <div class="highlight"><pre>        <span class="nv">destroy: </span><span class="p">()</span> <span class="o">=&gt;</span>

            <span class="nx">@unbind</span><span class="p">()</span>

            <span class="nx">@model</span><span class="p">.</span><span class="nx">unbind</span> <span class="s">&#39;destroy&#39;</span><span class="p">,</span>  <span class="nx">@rem</span><span class="p">,</span>  <span class="nx">@</span>

            <span class="vi">@model.view = </span><span class="kc">null</span>

            <span class="nx">@remove</span><span class="p">()</span>


        <span class="nv">release: </span><span class="p">()</span> <span class="o">=&gt;</span>

            <span class="nx">@unbind</span><span class="p">()</span>

            <span class="nx">@model</span><span class="p">.</span><span class="nx">unbind</span> <span class="s">&#39;destroy&#39;</span><span class="p">,</span>  <span class="nx">@rem</span><span class="p">,</span>  <span class="nx">@</span>

            <span class="vi">@model.view = </span><span class="kc">null</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-17">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-17">&#182;</a>                          </div>                          <h3 id="thumbnailview">Thumbnail View</h3>

<p>Extend base item view and define a thumbnail type template</p>                      </td>                      <td class="code">                          <div class="highlight"><pre>    <span class="k">class</span> <span class="nb">window</span><span class="p">.</span><span class="nx">ItemThumbnailView</span> <span class="k">extends</span> <span class="nb">window</span><span class="p">.</span><span class="nx">BaseItemView</span>


        <span class="nv">tagName: </span><span class="s">&#39;li&#39;</span><span class="p">,</span>


        <span class="nv">template: </span><span class="nx">_</span><span class="p">.</span><span class="nx">template</span> <span class="nx">$</span><span class="p">(</span><span class="s">&#39;#item-template&#39;</span><span class="p">).</span><span class="nx">html</span><span class="p">()</span>


        <span class="nv">initialize: </span><span class="p">()</span> <span class="o">=&gt;</span>

            <span class="k">super</span>

            <span class="nx">@$el</span><span class="p">.</span><span class="nx">addClass</span> <span class="s">&#39;thumbnail&#39;</span></pre></div>                      </td>                  </tr>                                                      <tr id="section-18">                      <td class="docs">                          <div class="pilwrap">                              <a class="pilcrow" href="#section-18">&#182;</a>                          </div>                          <h3 id="listview">List View</h3>

<p>Extend base item view and define a list type template</p>                      </td>                      <td class="code">                          <div class="highlight"><pre>    <span class="k">class</span> <span class="nb">window</span><span class="p">.</span><span class="nx">ItemListView</span> <span class="k">extends</span> <span class="nb">window</span><span class="p">.</span><span class="nx">BaseItemView</span>


        <span class="nv">tagName: </span><span class="s">&#39;tr&#39;</span><span class="p">,</span>


        <span class="nv">template: </span><span class="nx">_</span><span class="p">.</span><span class="nx">template</span> <span class="nx">$</span><span class="p">(</span><span class="s">&#39;#item-table-template&#39;</span><span class="p">).</span><span class="nx">html</span><span class="p">()</span>


        <span class="nv">initialize: </span><span class="p">()</span> <span class="o">=&gt;</span>

            <span class="k">super</span>

            <span class="nx">@$el</span><span class="p">.</span><span class="nx">addClass</span> <span class="s">&#39;selectable&#39;</span>

</pre></div>                      </td>                  </tr>                                </tbody>          </table>      </div>  </body>  </html>